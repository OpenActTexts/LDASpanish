<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Simulación y Remuestreo | Loss Data Analytics</title>
  <meta name="description" content="Chapter 6 Simulación y Remuestreo | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Simulación y Remuestreo | Loss Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 6 Simulación y Remuestreo | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="github-repo" content="https://github.com/openacttexts/Loss-Data-Analytics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Simulación y Remuestreo | Loss Data Analytics" />
  
  <meta name="twitter:description" content="Chapter 6 Simulación y Remuestreo | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  

<meta name="author" content="An open text authored by the Actuarial Community" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="C-AggLossModels.html"/>
<link rel="next" href="C-PremiumFoundations.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<!-- Mathjax -->
<script type='text/x-mathjax-config'>
		MathJax.Hub.Config({
			extensions: ['tex2jax.js'],
			jax: ['input/TeX', 'output/HTML-CSS'],
			tex2jax: {
				inlineMath: [ ['$','$'], ['\\(','\\)'] ],
				displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
				processEscapes: true
			},
			'HTML-CSS': { availableFonts: ['TeX'] }
		});
</script>

<!-- The following code is for the quizzes -->
<script src="https://surveyjs.azureedge.net/1.0.50/survey.jquery.js"></script>
<link href="https://surveyjs.azureedge.net/1.0.50/survey.css" type="text/css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.6.4/showdown.min.js"></script>  

<script>
function markdownConverterEWF() {  
//Create showdown markdown converter
var converter = new showdown.Converter();
converter.setOption('ghCompatibleHeaderId', true);
survey
    .onTextMarkdown
    .add(function (survey, options) {
        //convert the mardown text to html
        var str = converter.makeHtml(options.text);
        //remove root paragraphs <p></p>
        str = str.substring(3);
        str = str.substring(0, str.length - 4);
        //set html
        options.html = str;
         MathJax.Hub.Queue(['Typeset',MathJax.Hub, 'options']);
    });  
};
// Quiz Header info
const jsonHeader = { 
    showProgressBar: "bottom",
    showTimerPanel: "none",
    maxTimeToFinishPage: 10000,
    maxTimeToFinish: 25000,
    firstPageIsStarted: true,
    startSurveyText: "Start Quiz" //,
//    title: "Does This Make Sense?"
}
// One and Two question quizzes
function jsonSummary1EWF(json) {  
let jsonEnd1 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
};  
return jsonEnd1;
};


function jsonSummary2EWF(json) {  
let jsonEnd2 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
};  
return jsonEnd2;
};

// Three, four, and five question quizzes
function jsonSummary3EWF(json) {  
let jsonEnd3 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][3]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][3]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][3]["questions"][0]["correctAnswer"]
};  
return jsonEnd3;
};

function jsonSummary4EWF(json) {  
jsonEnd4 = jsonSummary3EWF(json);
jsonEnd4.completedHtml = jsonEnd4.completedHtml +  
"<br>"+
json["pages"][4]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][4]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][4]["questions"][0]["correctAnswer"]
;  
return jsonEnd4;
};

function jsonSummary5EWF(json) {  
jsonEnd5 = jsonSummary4EWF(json);
jsonEnd5.completedHtml = jsonEnd5.completedHtml +  
"<br>"+
json["pages"][5]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][5]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][5]["questions"][0]["correctAnswer"]
;  
return jsonEnd5;
};

function jsonSummary6EWF(json) {  
jsonEnd6 = jsonSummary5EWF(json);
jsonEnd6.completedHtml = jsonEnd6.completedHtml +  
"<br>"+
json["pages"][6]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][6]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][6]["questions"][0]["correctAnswer"]
;  
return jsonEnd6;
};

function jsonSummary7EWF(json) {  
jsonEnd7 = jsonSummary6EWF(json);
jsonEnd7.completedHtml = jsonEnd7.completedHtml +  
"<br>"+
json["pages"][7]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][7]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][7]["questions"][0]["correctAnswer"]
;  
return jsonEnd7;
};

function jsonSummary8EWF(json) {  
jsonEnd8 = jsonSummary7EWF(json);
jsonEnd8.completedHtml = jsonEnd8.completedHtml +  
"<br>"+
json["pages"][8]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][8]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][8]["questions"][0]["correctAnswer"]
;  
return jsonEnd8;
};

function jsonSummary9EWF(json) {  
jsonEnd9 = jsonSummary8EWF(json);
jsonEnd9.completedHtml = jsonEnd9.completedHtml +  
"<br>"+
json["pages"][9]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][9]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][9]["questions"][0]["correctAnswer"]
;  
return jsonEnd9;
};


function jsonSummary10EWF(json) {  
jsonEnd10 = jsonSummary9EWF(json);
jsonEnd10.completedHtml = jsonEnd10.completedHtml +  
"<br>"+
json["pages"][10]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][10]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][10]["questions"][0]["correctAnswer"]
;  
return jsonEnd10;
};


function jsonSummary11EWF(json) {  
jsonEnd11 = jsonSummary10EWF(json);
jsonEnd11.completedHtml = jsonEnd11.completedHtml +  
"<br>"+
json["pages"][11]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][11]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][11]["questions"][0]["correctAnswer"]
;  
return jsonEnd11;
};



</script>  
<!-- This completes the code for the quizzes -->


<!-- Various toggle functions used throughout --> 
<script language="javascript">
function toggle(id1,id2) {
	var ele = document.getElementById(id1); var text = document.getElementById(id2);
	if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Mostrar Solución";}
		else {ele.style.display = "block"; text.innerHTML = "Ocultar Solución";}}
function togglecode(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Mostrar Código R";}
      else {ele.style.display = "block"; text.innerHTML = "Ocultar Código R";}}
function toggleEX(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Mostrar Ejemplo";}
      else {ele.style.display = "block"; text.innerHTML = "Ocultar Ejemplo";}}
function toggleTheory(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Mostrar Teoría";}
      else {ele.style.display = "block"; text.innerHTML = "Ocultar Teoría";}}
function toggleQuiz(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Mostrar Solución de Prueba";}
      else {ele.style.display = "block"; text.innerHTML = "Ocultar Solución de Prueba";}}      
</script>

<!-- A few functions for revealing definitions -->
<script language="javascript">
<!--   $( function() {
    $("#tabs").tabs();
  } ); -->

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

<script language="javascript">
function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DF6W196L8Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DF6W196L8Q');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Loss Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colaboradores"><i class="fa fa-check"></i>Colaboradores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#revisores"><i class="fa fa-check"></i>Revisores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#traducción-al-español"><i class="fa fa-check"></i>Traducción al español</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#para-nuestros-lectores"><i class="fa fa-check"></i>Para nuestros lectores</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="C-Intro.html"><a href="C-Intro.html"><i class="fa fa-check"></i><b>1</b> Introducción a la Analítica de Datos de Pérdida</a>
<ul>
<li class="chapter" data-level="1.1" data-path="C-Intro.html"><a href="C-Intro.html#S:Intro"><i class="fa fa-check"></i><b>1.1</b> Relevancia de la Analítica para las Actividades de Seguros</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="C-Intro.html"><a href="C-Intro.html#naturaleza-y-relevancia-del-seguro"><i class="fa fa-check"></i><b>1.1.1</b> Naturaleza y relevancia del seguro</a></li>
<li class="chapter" data-level="1.1.2" data-path="C-Intro.html"><a href="C-Intro.html#qué-es-la-analítica-de-datos-según-su-nombre-en-inglés-analytics"><i class="fa fa-check"></i><b>1.1.2</b> ¿Qué es la Analítica de datos (según su nombre en inglés, Analytics)?</a></li>
<li class="chapter" data-level="1.1.3" data-path="C-Intro.html"><a href="C-Intro.html#S:InsProcesses"><i class="fa fa-check"></i><b>1.1.3</b> Procesos en los seguros</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="C-Intro.html"><a href="C-Intro.html#S:PredModApps"><i class="fa fa-check"></i><b>1.2</b> Operaciones de la Compañía de Seguros</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="C-Intro.html"><a href="C-Intro.html#inicio-del-seguro"><i class="fa fa-check"></i><b>1.2.1</b> Inicio del seguro</a></li>
<li class="chapter" data-level="1.2.2" data-path="C-Intro.html"><a href="C-Intro.html#renovación-del-seguro"><i class="fa fa-check"></i><b>1.2.2</b> Renovación del seguro</a></li>
<li class="chapter" data-level="1.2.3" data-path="C-Intro.html"><a href="C-Intro.html#gestión-de-productos-y-siniestros"><i class="fa fa-check"></i><b>1.2.3</b> Gestión de productos y siniestros</a></li>
<li class="chapter" data-level="1.2.4" data-path="C-Intro.html"><a href="C-Intro.html#S:Reserving"><i class="fa fa-check"></i><b>1.2.4</b> Provisiones</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="C-Intro.html"><a href="C-Intro.html#S:LGPIF"><i class="fa fa-check"></i><b>1.3</b> Caso de Estudio: Fondo de Propiedad de Wisconsin</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="C-Intro.html"><a href="C-Intro.html#S:OutComes"><i class="fa fa-check"></i><b>1.3.1</b> Variables de siniestralidad del fondo: frecuencia y severidad</a></li>
<li class="chapter" data-level="1.3.2" data-path="C-Intro.html"><a href="C-Intro.html#S:FundVariables"><i class="fa fa-check"></i><b>1.3.2</b> Variables de clasificación del fondo</a></li>
<li class="chapter" data-level="1.3.3" data-path="C-Intro.html"><a href="C-Intro.html#operativa-del-fondo"><i class="fa fa-check"></i><b>1.3.3</b> Operativa del fondo</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="C-Intro.html"><a href="C-Intro.html#Intro-further-reading-and-resources"><i class="fa fa-check"></i><b>1.4</b> Más Recursos y Colaboradores</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html"><i class="fa fa-check"></i><b>2</b> Modelización de la Frecuencia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:frequency-distributions"><i class="fa fa-check"></i><b>2.1</b> Distribuciones de Frecuencias</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:how-frequency-augments-severity-information"><i class="fa fa-check"></i><b>2.1.1</b> Cómo la frecuencia incrementa la información sobre la cuantía</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:basic-frequency-distributions"><i class="fa fa-check"></i><b>2.2</b> Distribuciones de Frecuencias Elementales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:foundations"><i class="fa fa-check"></i><b>2.2.1</b> Fundamentos</a></li>
<li class="chapter" data-level="2.2.2" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:generating-functions"><i class="fa fa-check"></i><b>2.2.2</b> Funciones Generadoras de Momentos y de Probabilidad</a></li>
<li class="chapter" data-level="2.2.3" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:important-frequency-distributions"><i class="fa fa-check"></i><b>2.2.3</b> Distribuciones de Frecuencias Importantes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:the-a-b-0-class"><i class="fa fa-check"></i><b>2.3</b> La Clase (a, b, 0)</a></li>
<li class="chapter" data-level="2.4" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:estimating-frequency-distributions"><i class="fa fa-check"></i><b>2.4</b> Estimación de las Distribuciones de Frecuencias</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:parameter-estimation"><i class="fa fa-check"></i><b>2.4.1</b> Estimación de los parámetros</a></li>
<li class="chapter" data-level="2.4.2" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:frequency-distributions-mle"><i class="fa fa-check"></i><b>2.4.2</b> MLE de las distribuciones de frecuencias</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:other-frequency-distributions"><i class="fa fa-check"></i><b>2.5</b> Otras Distribuciones de Frecuencias</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:zero-truncation-or-modification"><i class="fa fa-check"></i><b>2.5.1</b> Modificación o Truncamiento en Cero</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:mixture-distributions"><i class="fa fa-check"></i><b>2.6</b> Distribuciones Mixtas</a></li>
<li class="chapter" data-level="2.7" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:goodness-of-fit"><i class="fa fa-check"></i><b>2.7</b> Bondad del Ajuste</a></li>
<li class="chapter" data-level="2.8" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:exercises"><i class="fa fa-check"></i><b>2.8</b> Ejercicios</a></li>
<li class="chapter" data-level="2.9" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#Freq-further-reading-and-resources"><i class="fa fa-check"></i><b>2.9</b> Recursos Adicionales y Autores</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="C-Frequency-Modeling.html"><a href="C-Frequency-Modeling.html#S:rcode"><i class="fa fa-check"></i><b>2.9.1</b> TS 2.A. Código R para Gráficos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="C-Severity.html"><a href="C-Severity.html"><i class="fa fa-check"></i><b>3</b> Modelización de la Severidad de las Pérdidas</a>
<ul>
<li class="chapter" data-level="3.1" data-path="C-Severity.html"><a href="C-Severity.html#S:BasicQuantities"><i class="fa fa-check"></i><b>3.1</b> Cantidades Distribucionales Básicas</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="C-Severity.html"><a href="C-Severity.html#S:Chap3Moments"><i class="fa fa-check"></i><b>3.1.1</b> Momentos</a></li>
<li class="chapter" data-level="3.1.2" data-path="C-Severity.html"><a href="C-Severity.html#cuantiles"><i class="fa fa-check"></i><b>3.1.2</b> Cuantiles</a></li>
<li class="chapter" data-level="3.1.3" data-path="C-Severity.html"><a href="C-Severity.html#función-generatriz-de-momentos"><i class="fa fa-check"></i><b>3.1.3</b> Función generatriz de momentos</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="C-Severity.html"><a href="C-Severity.html#S:ContinuousDistn"><i class="fa fa-check"></i><b>3.2</b> Distribuciones Continuas para Modelizar la Severidad de las Pérdidas</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="C-Severity.html"><a href="C-Severity.html#S:Loss:Gamma"><i class="fa fa-check"></i><b>3.2.1</b> Distribución gamma</a></li>
<li class="chapter" data-level="3.2.2" data-path="C-Severity.html"><a href="C-Severity.html#distribución-pareto"><i class="fa fa-check"></i><b>3.2.2</b> Distribución Pareto</a></li>
<li class="chapter" data-level="3.2.3" data-path="C-Severity.html"><a href="C-Severity.html#S:LS:Weibull"><i class="fa fa-check"></i><b>3.2.3</b> Distribución Weibull</a></li>
<li class="chapter" data-level="3.2.4" data-path="C-Severity.html"><a href="C-Severity.html#distribución-beta-generalizada-de-segundo-tipo"><i class="fa fa-check"></i><b>3.2.4</b> Distribución Beta Generalizada de segundo tipo</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="C-Severity.html"><a href="C-Severity.html#MethodsCreation"><i class="fa fa-check"></i><b>3.3</b> Métodos para Crear Distribuciones Nuevas</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="C-Severity.html"><a href="C-Severity.html#funciones-de-variables-aleatorias-y-sus-distribuciones"><i class="fa fa-check"></i><b>3.3.1</b> Funciones de variables aleatorias y sus distribuciones</a></li>
<li class="chapter" data-level="3.3.2" data-path="C-Severity.html"><a href="C-Severity.html#multiplicación-por-una-constante"><i class="fa fa-check"></i><b>3.3.2</b> Multiplicación por una constante</a></li>
<li class="chapter" data-level="3.3.3" data-path="C-Severity.html"><a href="C-Severity.html#elevación-a-una-potencia"><i class="fa fa-check"></i><b>3.3.3</b> Elevación a una potencia</a></li>
<li class="chapter" data-level="3.3.4" data-path="C-Severity.html"><a href="C-Severity.html#exponenciación"><i class="fa fa-check"></i><b>3.3.4</b> Exponenciación</a></li>
<li class="chapter" data-level="3.3.5" data-path="C-Severity.html"><a href="C-Severity.html#mixturas-finitas"><i class="fa fa-check"></i><b>3.3.5</b> Mixturas finitas</a></li>
<li class="chapter" data-level="3.3.6" data-path="C-Severity.html"><a href="C-Severity.html#mixturas-continuas"><i class="fa fa-check"></i><b>3.3.6</b> Mixturas continuas</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="C-Severity.html"><a href="C-Severity.html#S:CoverageModifications"><i class="fa fa-check"></i><b>3.4</b> Modificaciones de Cobertura</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="C-Severity.html"><a href="C-Severity.html#S:PolicyDeduct"><i class="fa fa-check"></i><b>3.4.1</b> Franquicias</a></li>
<li class="chapter" data-level="3.4.2" data-path="C-Severity.html"><a href="C-Severity.html#S:PolicyLimits"><i class="fa fa-check"></i><b>3.4.2</b> Límites de la póliza</a></li>
<li class="chapter" data-level="3.4.3" data-path="C-Severity.html"><a href="C-Severity.html#coseguro-e-inflación"><i class="fa fa-check"></i><b>3.4.3</b> Coseguro e inflación</a></li>
<li class="chapter" data-level="3.4.4" data-path="C-Severity.html"><a href="C-Severity.html#S:Chap3Reinsurance"><i class="fa fa-check"></i><b>3.4.4</b> Reaseguro</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="C-Severity.html"><a href="C-Severity.html#S:MaxLikeEstimation"><i class="fa fa-check"></i><b>3.5</b> Estimación por Máxima Verosimilitud</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="C-Severity.html"><a href="C-Severity.html#estimadores-de-máxima-verosimilitud-para-datos-completos"><i class="fa fa-check"></i><b>3.5.1</b> Estimadores de máxima verosimilitud para datos completos</a></li>
<li class="chapter" data-level="3.5.2" data-path="C-Severity.html"><a href="C-Severity.html#S:Loss:MLEModified"><i class="fa fa-check"></i><b>3.5.2</b> Estimadores por máxima verosimilitud usando datos modificados</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="C-Severity.html"><a href="C-Severity.html#LM-further-reading-and-resources"><i class="fa fa-check"></i><b>3.6</b> Recursos y Contribuciones Adicionales</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html"><i class="fa fa-check"></i><b>4</b> Selección del Modelo y Estimación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:MS:NonParInf"><i class="fa fa-check"></i><b>4.1</b> Inferencia No Paramétrica</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#estimación-no-paramétrica"><i class="fa fa-check"></i><b>4.1.1</b> Estimación No Paramétrica</a></li>
<li class="chapter" data-level="4.1.2" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:MS:ToolsModelSelection"><i class="fa fa-check"></i><b>4.1.2</b> Herramientas para la Selección de Modelos y Diagnósticos</a></li>
<li class="chapter" data-level="4.1.3" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#valores-iniciales"><i class="fa fa-check"></i><b>4.1.3</b> Valores Iniciales</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:MS:ModelSelection"><i class="fa fa-check"></i><b>4.2</b> Selección del Modelo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#selección-del-modelo-iterativa"><i class="fa fa-check"></i><b>4.2.1</b> Selección del Modelo Iterativa</a></li>
<li class="chapter" data-level="4.2.2" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#selección-de-modelo-basada-en-un-conjunto-de-datos-de-entrenamiento"><i class="fa fa-check"></i><b>4.2.2</b> Selección de Modelo basada en un Conjunto de Datos de Entrenamiento</a></li>
<li class="chapter" data-level="4.2.3" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#selección-de-modelo-basada-en-un-conjunto-de-datos-de-prueba"><i class="fa fa-check"></i><b>4.2.3</b> Selección de Modelo basada en un Conjunto de Datos de Prueba</a></li>
<li class="chapter" data-level="4.2.4" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#selección-del-modelo-basada-en-validación-cruzada"><i class="fa fa-check"></i><b>4.2.4</b> Selección del Modelo basada en Validación Cruzada</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:MS:ModifiedData"><i class="fa fa-check"></i><b>4.3</b> Estimación utilizando Datos Modificados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#estimación-paramétrica-usando-datos-modificados"><i class="fa fa-check"></i><b>4.3.1</b> Estimación Paramétrica usando Datos Modificados</a></li>
<li class="chapter" data-level="4.3.2" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#estimación-no-paramétrica-utilizando-datos-modificados"><i class="fa fa-check"></i><b>4.3.2</b> Estimación no Paramétrica Utilizando Datos Modificados</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:MS:BayesInference"><i class="fa fa-check"></i><b>4.4</b> Inferencia Bayesiana</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:IntroBayes"><i class="fa fa-check"></i><b>4.4.1</b> Introducción a la Inferencia Bayesiana</a></li>
<li class="chapter" data-level="4.4.2" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#modelo-bayesiano"><i class="fa fa-check"></i><b>4.4.2</b> Modelo Bayesiano</a></li>
<li class="chapter" data-level="4.4.3" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#inferencia-bayesiana"><i class="fa fa-check"></i><b>4.4.3</b> Inferencia Bayesiana</a></li>
<li class="chapter" data-level="4.4.4" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#S:ConjugateDistributions"><i class="fa fa-check"></i><b>4.4.4</b> Distribuciones Conjugadas</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="C-ModelSelection.html"><a href="C-ModelSelection.html#MS:further-reading-and-resources"><i class="fa fa-check"></i><b>4.5</b> Más Recursos y Colaboradores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html"><i class="fa fa-check"></i><b>5</b> Modelos de Pérdidas Agregadas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#introducción"><i class="fa fa-check"></i><b>5.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#modelo-de-riesgo-individual"><i class="fa fa-check"></i><b>5.2</b> Modelo de Riesgo Individual</a></li>
<li class="chapter" data-level="5.3" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#modelo-de-riesgo-colectivo"><i class="fa fa-check"></i><b>5.3</b> Modelo de Riesgo Colectivo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#momentos-y-distribución"><i class="fa fa-check"></i><b>5.3.1</b> Momentos y distribución</a></li>
<li class="chapter" data-level="5.3.2" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#seguro-stop-loss"><i class="fa fa-check"></i><b>5.3.2</b> Seguro Stop-loss</a></li>
<li class="chapter" data-level="5.3.3" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#resultados-analíticos"><i class="fa fa-check"></i><b>5.3.3</b> Resultados analíticos</a></li>
<li class="chapter" data-level="5.3.4" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#distribución-tweedie"><i class="fa fa-check"></i><b>5.3.4</b> Distribución Tweedie</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#cálculo-de-la-distribución-de-pérdidas-agregadas"><i class="fa fa-check"></i><b>5.4</b> Cálculo de la Distribución de Pérdidas Agregadas</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#método-recursivo"><i class="fa fa-check"></i><b>5.4.1</b> Método recursivo</a></li>
<li class="chapter" data-level="5.4.2" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#simulación"><i class="fa fa-check"></i><b>5.4.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#efectos-de-la-modificación-de-las-coberturas"><i class="fa fa-check"></i><b>5.5</b> Efectos de la Modificación de las Coberturas</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#impacto-de-la-exposición-en-la-frecuencia"><i class="fa fa-check"></i><b>5.5.1</b> Impacto de la exposición en la frecuencia</a></li>
<li class="chapter" data-level="5.5.2" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#S:MS:DedImpactClmFreq"><i class="fa fa-check"></i><b>5.5.2</b> Impacto de los deducibles en la frecuencia de siniestros</a></li>
<li class="chapter" data-level="5.5.3" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#impacto-de-las-modificaciones-de-la-póliza-en-la-siniestralidad-agregada"><i class="fa fa-check"></i><b>5.5.3</b> Impacto de las modificaciones de la póliza en la siniestralidad agregada</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="C-AggLossModels.html"><a href="C-AggLossModels.html#AL-further-reading-and-resources"><i class="fa fa-check"></i><b>5.6</b> Otros Recursos y Colaboradores</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="C-Simulation.html"><a href="C-Simulation.html"><i class="fa fa-check"></i><b>6</b> Simulación y Remuestreo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="C-Simulation.html"><a href="C-Simulation.html#S:SimulationFundamentals"><i class="fa fa-check"></i><b>6.1</b> Fundamentos de la Simulación</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="C-Simulation.html"><a href="C-Simulation.html#generación-de-observaciones-uniformes-independientes"><i class="fa fa-check"></i><b>6.1.1</b> Generación de observaciones uniformes independientes</a></li>
<li class="chapter" data-level="6.1.2" data-path="C-Simulation.html"><a href="C-Simulation.html#S:InverseTransform"><i class="fa fa-check"></i><b>6.1.2</b> Método de la transformada inversa</a></li>
<li class="chapter" data-level="6.1.3" data-path="C-Simulation.html"><a href="C-Simulation.html#precisión-de-la-simulación"><i class="fa fa-check"></i><b>6.1.3</b> Precisión de la simulación</a></li>
<li class="chapter" data-level="6.1.4" data-path="C-Simulation.html"><a href="C-Simulation.html#S:SimulationStatInference"><i class="fa fa-check"></i><b>6.1.4</b> Simulación e inferencia estadística</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="C-Simulation.html"><a href="C-Simulation.html#S:Bootstrap"><i class="fa fa-check"></i><b>6.2</b> Bootstrapping y Remuestreo</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="C-Simulation.html"><a href="C-Simulation.html#fundamentos-del-bootstrap"><i class="fa fa-check"></i><b>6.2.1</b> Fundamentos del Bootstrap</a></li>
<li class="chapter" data-level="6.2.2" data-path="C-Simulation.html"><a href="C-Simulation.html#precisión-del-bootstrap-sesgo-desviación-estándar-y-mse-error-cuadrático-medio-en-sus-siglas-en-inglés"><i class="fa fa-check"></i><b>6.2.2</b> Precisión del bootstrap: Sesgo, desviación estándar, y MSE (error cuadrático medio, en sus siglas en inglés)</a></li>
<li class="chapter" data-level="6.2.3" data-path="C-Simulation.html"><a href="C-Simulation.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>6.2.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.2.4" data-path="C-Simulation.html"><a href="C-Simulation.html#S:ParametricBootStrap"><i class="fa fa-check"></i><b>6.2.4</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="C-Simulation.html"><a href="C-Simulation.html#S:CrossValidation"><i class="fa fa-check"></i><b>6.3</b> Validación Cruzada</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="C-Simulation.html"><a href="C-Simulation.html#validación-cruzada-k-fold"><i class="fa fa-check"></i><b>6.3.1</b> Validación cruzada k-fold</a></li>
<li class="chapter" data-level="6.3.2" data-path="C-Simulation.html"><a href="C-Simulation.html#validación-cruzada-dejando-uno-fuera"><i class="fa fa-check"></i><b>6.3.2</b> Validación cruzada dejando uno fuera</a></li>
<li class="chapter" data-level="6.3.3" data-path="C-Simulation.html"><a href="C-Simulation.html#validación-cruzada-y-bootstrap"><i class="fa fa-check"></i><b>6.3.3</b> Validación cruzada y Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="C-Simulation.html"><a href="C-Simulation.html#S:ImportanceSampling"><i class="fa fa-check"></i><b>6.4</b> Importance Sampling</a></li>
<li class="chapter" data-level="6.5" data-path="C-Simulation.html"><a href="C-Simulation.html#S:MCMC"><i class="fa fa-check"></i><b>6.5</b> Monte Carlo Markov Chain (MCMC)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="C-Simulation.html"><a href="C-Simulation.html#hastings-metropolis"><i class="fa fa-check"></i><b>6.5.1</b> Hastings Metropolis</a></li>
<li class="chapter" data-level="6.5.2" data-path="C-Simulation.html"><a href="C-Simulation.html#muestreo-de-gibbs"><i class="fa fa-check"></i><b>6.5.2</b> Muestreo de Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="C-Simulation.html"><a href="C-Simulation.html#Simulation:further-reading-and-resources"><i class="fa fa-check"></i><b>6.6</b> Recursos Adicionales y Colaboradores</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="C-Simulation.html"><a href="C-Simulation.html#ts-6.a.-bootstrap-applications-in-predictive-modeling"><i class="fa fa-check"></i><b>6.6.1</b> TS 6.A. Bootstrap Applications in Predictive Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html"><i class="fa fa-check"></i><b>7</b> Fundamentos de la Prima</a>
<ul>
<li class="chapter" data-level="7.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:IntroductionRatemaking"><i class="fa fa-check"></i><b>7.1</b> Introducción a la Tarificación</a></li>
<li class="chapter" data-level="7.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:AggRateMaking"><i class="fa fa-check"></i><b>7.2</b> Métodos de Tarificación Conjunta</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:PurePremium"><i class="fa fa-check"></i><b>7.2.1</b> Método de la Prima Pura</a></li>
<li class="chapter" data-level="7.2.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:LossRatio"><i class="fa fa-check"></i><b>7.2.2</b> Método de la Ratio de Siniestralidad</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:PricingPrinciples"><i class="fa fa-check"></i><b>7.3</b> Principios de Tarificación</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#principios-de-tarificación"><i class="fa fa-check"></i><b>7.3.1</b> Principios de Tarificación</a></li>
<li class="chapter" data-level="7.3.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#propiedades-de-los-principios-de-tarificación"><i class="fa fa-check"></i><b>7.3.2</b> Propiedades de los Principios de Tarificación</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:HeterogeneousRisks"><i class="fa fa-check"></i><b>7.4</b> Riesgos Heterogéneos</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:ExposureToRisk"><i class="fa fa-check"></i><b>7.4.1</b> Exposición al Riesgo</a></li>
<li class="chapter" data-level="7.4.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:RatingFactors"><i class="fa fa-check"></i><b>7.4.2</b> Factores de Tarificación</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:TrendDevelopment"><i class="fa fa-check"></i><b>7.5</b> Desarrollo y Tendencia</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#exposiciones-y-primas"><i class="fa fa-check"></i><b>7.5.1</b> Exposiciones y Primas</a></li>
<li class="chapter" data-level="7.5.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#siniestros-reclamaciones-y-pagos"><i class="fa fa-check"></i><b>7.5.2</b> Siniestros, Reclamaciones y Pagos</a></li>
<li class="chapter" data-level="7.5.3" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:CompareMethods"><i class="fa fa-check"></i><b>7.5.3</b> Comparación de los Métodos de Prima Pura y Ratio de Siniestralidad</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#S:GiniStatistic"><i class="fa fa-check"></i><b>7.6</b> Selección de Prima</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#curva-de-lorenz-clásica"><i class="fa fa-check"></i><b>7.6.1</b> Curva de Lorenz Clásica</a></li>
<li class="chapter" data-level="7.6.2" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#curva-de-rendimiento-y-estadístico-de-gini"><i class="fa fa-check"></i><b>7.6.2</b> Curva de Rendimiento y Estadístico de Gini</a></li>
<li class="chapter" data-level="7.6.3" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#validación-cruzada"><i class="fa fa-check"></i><b>7.6.3</b> Validación Cruzada</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#otros-recursos-y-colaboradores"><i class="fa fa-check"></i><b>7.7</b> Otros Recursos y Colaboradores</a>
<ul>
<li class="chapter" data-level="" data-path="C-PremiumFoundations.html"><a href="C-PremiumFoundations.html#ts-7.a.-regulación-de-la-tarificación"><i class="fa fa-check"></i>TS 7.A. Regulación de la Tarificación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="C-RiskClass.html"><a href="C-RiskClass.html"><i class="fa fa-check"></i><b>8</b> Clasificación de Riesgos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="C-RiskClass.html"><a href="C-RiskClass.html#S:RC:Introduction"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="C-RiskClass.html"><a href="C-RiskClass.html#S:RC:PoissonRegression"><i class="fa fa-check"></i><b>8.2</b> Modelo de Regresión de Poisson</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="C-RiskClass.html"><a href="C-RiskClass.html#S:RC:Need.Poi.reg"><i class="fa fa-check"></i><b>8.2.1</b> Necesidad de la Regresión de Poisson</a></li>
<li class="chapter" data-level="8.2.2" data-path="C-RiskClass.html"><a href="C-RiskClass.html#regresión-de-poisson"><i class="fa fa-check"></i><b>8.2.2</b> Regresión de Poisson</a></li>
<li class="chapter" data-level="8.2.3" data-path="C-RiskClass.html"><a href="C-RiskClass.html#incorporación-de-la-exposición"><i class="fa fa-check"></i><b>8.2.3</b> Incorporación de la exposición</a></li>
<li class="chapter" data-level="8.2.4" data-path="C-RiskClass.html"><a href="C-RiskClass.html#ejercicios-3"><i class="fa fa-check"></i><b>8.2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="C-RiskClass.html"><a href="C-RiskClass.html#S:CatVarMultiTarriff"><i class="fa fa-check"></i><b>8.3</b> Variables Categóricas y Tarifa Multiplicativa</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="C-RiskClass.html"><a href="C-RiskClass.html#factores-de-tarificación-y-tarifa"><i class="fa fa-check"></i><b>8.3.1</b> Factores de Tarificación y Tarifa</a></li>
<li class="chapter" data-level="8.3.2" data-path="C-RiskClass.html"><a href="C-RiskClass.html#modelo-de-tarifa-multiplicativa"><i class="fa fa-check"></i><b>8.3.2</b> Modelo de Tarifa Multiplicativa</a></li>
<li class="chapter" data-level="8.3.3" data-path="C-RiskClass.html"><a href="C-RiskClass.html#regresión-de-poisson-para-la-tarifa-multiplicativa"><i class="fa fa-check"></i><b>8.3.3</b> Regresión de Poisson para la Tarifa Multiplicativa</a></li>
<li class="chapter" data-level="8.3.4" data-path="C-RiskClass.html"><a href="C-RiskClass.html#ejemplos-numéricos"><i class="fa fa-check"></i><b>8.3.4</b> Ejemplos numéricos</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="C-RiskClass.html"><a href="C-RiskClass.html#RC:further-reading-and-resources"><i class="fa fa-check"></i><b>8.4</b> Más Recursos y Colaboradores</a>
<ul>
<li class="chapter" data-level="" data-path="C-RiskClass.html"><a href="C-RiskClass.html#ts-8.a-estimación-de-modelos-de-regresión-de-poisson"><i class="fa fa-check"></i>TS 8.A – Estimación de Modelos de Regresión de Poisson</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="C-Credibility.html"><a href="C-Credibility.html"><i class="fa fa-check"></i><b>9</b> Tarificación Basada en la Experiencia Mediante Teoría de la Credibilidad</a>
<ul>
<li class="chapter" data-level="9.1" data-path="C-Credibility.html"><a href="C-Credibility.html#introducción-a-las-aplicaciones-de-la-teoría-de-la-credibilidad"><i class="fa fa-check"></i><b>9.1</b> Introducción a las Aplicaciones de la Teoría de la Credibilidad</a></li>
<li class="chapter" data-level="9.2" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-de-fluctuación-limitada"><i class="fa fa-check"></i><b>9.2</b> Credibilidad de Fluctuación Limitada</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="C-Credibility.html"><a href="C-Credibility.html#S:frequency"><i class="fa fa-check"></i><b>9.2.1</b> Credibilidad Completa para la Frecuencia de Siniestralidad</a></li>
<li class="chapter" data-level="9.2.2" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-completa-para-la-siniestralidad-agregada-y-la-prima-pura"><i class="fa fa-check"></i><b>9.2.2</b> Credibilidad Completa para la Siniestralidad Agregada y la Prima Pura</a></li>
<li class="chapter" data-level="9.2.3" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-completa-para-la-severidad"><i class="fa fa-check"></i><b>9.2.3</b> Credibilidad Completa para la Severidad</a></li>
<li class="chapter" data-level="9.2.4" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-parcial"><i class="fa fa-check"></i><b>9.2.4</b> Credibilidad parcial</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-de-bühlmann"><i class="fa fa-check"></i><b>9.3</b> Credibilidad de Bühlmann</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="C-Credibility.html"><a href="C-Credibility.html#S:EPV-VHM-Z"><i class="fa fa-check"></i><b>9.3.1</b> Credibilidad Z, <em>EPV</em>, y <em>VHM</em></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="C-Credibility.html"><a href="C-Credibility.html#credibilidad-de-bühlmann-straub"><i class="fa fa-check"></i><b>9.4</b> Credibilidad de Bühlmann-Straub</a></li>
<li class="chapter" data-level="9.7" data-path="C-Credibility.html"><a href="C-Credibility.html#Cred-further-reading-and-resources"><i class="fa fa-check"></i><b>9.7</b> Otros Recursos y Colaboradores</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="C-PortMgt.html"><a href="C-PortMgt.html"><i class="fa fa-check"></i><b>10</b> Gestión de Carteras de Seguros incluyendo Reaseguro</a>
<ul>
<li class="chapter" data-level="10.1" data-path="C-PortMgt.html"><a href="C-PortMgt.html#introducción-a-las-carteras-de-seguros"><i class="fa fa-check"></i><b>10.1</b> Introducción a las Carteras de Seguros</a></li>
<li class="chapter" data-level="10.2" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:Tails"><i class="fa fa-check"></i><b>10.2</b> Colas de las Distribuciones</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="C-PortMgt.html"><a href="C-PortMgt.html#clasificación-basada-en-los-momentos"><i class="fa fa-check"></i><b>10.2.1</b> Clasificación Basada en los Momentos</a></li>
<li class="chapter" data-level="10.2.2" data-path="C-PortMgt.html"><a href="C-PortMgt.html#comparación-basada-en-el-comportamiento-de-colas-con-límites"><i class="fa fa-check"></i><b>10.2.2</b> Comparación basada en el comportamiento de colas con límites</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:RiskMeasure"><i class="fa fa-check"></i><b>10.3</b> Medidas de Riesgo</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="C-PortMgt.html"><a href="C-PortMgt.html#medidas-de-riesgo-coherentes"><i class="fa fa-check"></i><b>10.3.1</b> Medidas de Riesgo Coherentes</a></li>
<li class="chapter" data-level="10.3.2" data-path="C-PortMgt.html"><a href="C-PortMgt.html#valor-en-riesgo"><i class="fa fa-check"></i><b>10.3.2</b> Valor en Riesgo</a></li>
<li class="chapter" data-level="10.3.3" data-path="C-PortMgt.html"><a href="C-PortMgt.html#cola-del-valor-en-riesgo"><i class="fa fa-check"></i><b>10.3.3</b> Cola del Valor en Riesgo</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:Reinsurance"><i class="fa fa-check"></i><b>10.4</b> Reaseguro</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:ProportionalRe"><i class="fa fa-check"></i><b>10.4.1</b> Reaseguro Proporcional</a></li>
<li class="chapter" data-level="10.4.2" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:NonProportionalRe"><i class="fa fa-check"></i><b>10.4.2</b> Reaseguro No-Proporcional</a></li>
<li class="chapter" data-level="10.4.3" data-path="C-PortMgt.html"><a href="C-PortMgt.html#S:AdditionalRe"><i class="fa fa-check"></i><b>10.4.3</b> Acuerdos de Reaseguro Adicionales</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="C-PortMgt.html"><a href="C-PortMgt.html#recursos-y-colaboradores-adicionales"><i class="fa fa-check"></i><b>10.5</b> Recursos y Colaboradores adicionales</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="C-LossReserves.html"><a href="C-LossReserves.html"><i class="fa fa-check"></i><b>11</b> Provisiones</a>
<ul>
<li class="chapter" data-level="11.1" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:motivation"><i class="fa fa-check"></i><b>11.1</b> Motivación</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:claim-types"><i class="fa fa-check"></i><b>11.1.1</b> Siniestros cerrados, IBNR, y RBNS</a></li>
<li class="chapter" data-level="11.1.2" data-path="C-LossReserves.html"><a href="C-LossReserves.html#por-qué-reservar"><i class="fa fa-check"></i><b>11.1.2</b> ¿Por qué reservar?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:Data"><i class="fa fa-check"></i><b>11.2</b> Datos de provisiones</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="C-LossReserves.html"><a href="C-LossReserves.html#de-micro-a-macro"><i class="fa fa-check"></i><b>11.2.1</b> De Micro a Macro</a></li>
<li class="chapter" data-level="11.2.2" data-path="C-LossReserves.html"><a href="C-LossReserves.html#triángulos-de-desarrollo"><i class="fa fa-check"></i><b>11.2.2</b> Triángulos de desarrollo</a></li>
<li class="chapter" data-level="11.2.3" data-path="C-LossReserves.html"><a href="C-LossReserves.html#notación-de-provisiones"><i class="fa fa-check"></i><b>11.2.3</b> Notación de provisiones</a></li>
<li class="chapter" data-level="11.2.4" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:Rcode"><i class="fa fa-check"></i><b>11.2.4</b> Código R para resumir datos de provisión de pérdidas</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:Chain-ladder"><i class="fa fa-check"></i><b>11.3</b> Chain-Ladder</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:DeterministicCL"><i class="fa fa-check"></i><b>11.3.1</b> Chain-Ladder Determinista</a></li>
<li class="chapter" data-level="11.3.2" data-path="C-LossReserves.html"><a href="C-LossReserves.html#modelo-chain-ladder-de-distribución-libre-de-mack"><i class="fa fa-check"></i><b>11.3.2</b> Modelo Chain-ladder de distribución libre de Mack</a></li>
<li class="chapter" data-level="11.3.3" data-path="C-LossReserves.html"><a href="C-LossReserves.html#código-r-para-las-predicciones-chain-ladder"><i class="fa fa-check"></i><b>11.3.3</b> Código R para las predicciones Chain-Ladder</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="C-LossReserves.html"><a href="C-LossReserves.html#S:GLMs"><i class="fa fa-check"></i><b>11.4</b> GLMs y Bootstrap para provisiones</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="C-LossReserves.html"><a href="C-LossReserves.html#especificación-del-modelo"><i class="fa fa-check"></i><b>11.4.1</b> Especificación del modelo</a></li>
<li class="chapter" data-level="11.4.2" data-path="C-LossReserves.html"><a href="C-LossReserves.html#estimación-y-predicción-del-modelo"><i class="fa fa-check"></i><b>11.4.2</b> Estimación y predicción del modelo</a></li>
<li class="chapter" data-level="11.4.3" data-path="C-LossReserves.html"><a href="C-LossReserves.html#bootstrap"><i class="fa fa-check"></i><b>11.4.3</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="C-LossReserves.html"><a href="C-LossReserves.html#LossRe:further-reading-and-resources"><i class="fa fa-check"></i><b>11.5</b> Recursos adicionales y contribuciones</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html"><i class="fa fa-check"></i><b>12</b> Tarificación a posteriori usando Bonus-Malus</a>
<ul>
<li class="chapter" data-level="12.1" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#S:ERBM:Intro"><i class="fa fa-check"></i><b>12.1</b> Introducción</a></li>
<li class="chapter" data-level="12.2" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#S:ERBM:NCD"><i class="fa fa-check"></i><b>12.2</b> Sistema NCD en Varios Países</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#sistema-ncd-en-malasia"><i class="fa fa-check"></i><b>12.2.1</b> Sistema NCD en Malasia</a></li>
<li class="chapter" data-level="12.2.2" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#sistema-ncd-en-otros-países"><i class="fa fa-check"></i><b>12.2.2</b> Sistema NCD en Otros Países</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#S:ERBM:BMS"><i class="fa fa-check"></i><b>12.3</b> BMS y Modelo de Cadenas de Markov</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#probabilidad-de-transición"><i class="fa fa-check"></i><b>12.3.1</b> Probabilidad de Transición</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#S:ERBM:StatDist"><i class="fa fa-check"></i><b>12.4</b> BMS y Distribución Estacionaria</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#distribución-estacionaria"><i class="fa fa-check"></i><b>12.4.1</b> Distribución Estacionaria</a></li>
<li class="chapter" data-level="12.4.2" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#programa-r-para-distribuciones-estacionarias"><i class="fa fa-check"></i><b>12.4.2</b> Programa R para Distribuciones Estacionarias</a></li>
<li class="chapter" data-level="12.4.3" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#evolución-de-la-prima"><i class="fa fa-check"></i><b>12.4.3</b> Evolución de la Prima</a></li>
<li class="chapter" data-level="12.4.4" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#programa-r-para-la-evolución-de-las-primas"><i class="fa fa-check"></i><b>12.4.4</b> Programa R para la evolución de las Primas</a></li>
<li class="chapter" data-level="12.4.5" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#ratio-de-convergencia"><i class="fa fa-check"></i><b>12.4.5</b> Ratio de Convergencia</a></li>
<li class="chapter" data-level="12.4.6" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#programa-r-para-el-ratio-de-convergencia"><i class="fa fa-check"></i><b>12.4.6</b> Programa R para el Ratio de Convergencia</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#S:PremRtg"><i class="fa fa-check"></i><b>12.5</b> BMS y Tarificación de Primas</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#tarificación-de-primas"><i class="fa fa-check"></i><b>12.5.1</b> Tarificación de Primas</a></li>
<li class="chapter" data-level="12.5.2" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#modelos-de-frecuencia-regresiones-de-poisson-y-binomial-negativa"><i class="fa fa-check"></i><b>12.5.2</b> Modelos de Frecuencia – Regresiones de Poisson y Binomial Negativa</a></li>
<li class="chapter" data-level="12.5.3" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#tarificación-de-primas-con-datos-bonus-malus"><i class="fa fa-check"></i><b>12.5.3</b> Tarificación de Primas con datos Bonus-Malus</a></li>
<li class="chapter" data-level="12.5.4" data-path="C-BonusMalus.html"><a href="C-BonusMalus.html#tarificación-sin-datos-bonus-malus"><i class="fa fa-check"></i><b>12.5.4</b> Tarificación sin datos Bonus-Malus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="C-DataSystems.html"><a href="C-DataSystems.html"><i class="fa fa-check"></i><b>13</b> Datos y Sistemas</a>
<ul>
<li class="chapter" data-level="13.1" data-path="C-DataSystems.html"><a href="C-DataSystems.html#datos"><i class="fa fa-check"></i><b>13.1</b> Datos</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="C-DataSystems.html"><a href="C-DataSystems.html#tipos-y-fuentes-de-datos"><i class="fa fa-check"></i><b>13.1.1</b> Tipos y Fuentes de Datos</a></li>
<li class="chapter" data-level="13.1.2" data-path="C-DataSystems.html"><a href="C-DataSystems.html#estructuras-de-datos-y-almacenamiento"><i class="fa fa-check"></i><b>13.1.2</b> Estructuras de Datos y Almacenamiento</a></li>
<li class="chapter" data-level="13.1.3" data-path="C-DataSystems.html"><a href="C-DataSystems.html#calidad-de-los-datos"><i class="fa fa-check"></i><b>13.1.3</b> Calidad de los Datos</a></li>
<li class="chapter" data-level="13.1.4" data-path="C-DataSystems.html"><a href="C-DataSystems.html#limpieza-de-los-datos"><i class="fa fa-check"></i><b>13.1.4</b> Limpieza de los Datos</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="C-DataSystems.html"><a href="C-DataSystems.html#análisis-preliminar-de-los-datos"><i class="fa fa-check"></i><b>13.2</b> Análisis Preliminar de los Datos</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="C-DataSystems.html"><a href="C-DataSystems.html#S:process"><i class="fa fa-check"></i><b>13.2.1</b> Proceso de Análisis de Datos</a></li>
<li class="chapter" data-level="13.2.2" data-path="C-DataSystems.html"><a href="C-DataSystems.html#exploratorio-versus-confirmatorio"><i class="fa fa-check"></i><b>13.2.2</b> Exploratorio versus Confirmatorio</a></li>
<li class="chapter" data-level="13.2.3" data-path="C-DataSystems.html"><a href="C-DataSystems.html#supervisado-versus-no-supervisado"><i class="fa fa-check"></i><b>13.2.3</b> Supervisado versus No Supervisado</a></li>
<li class="chapter" data-level="13.2.4" data-path="C-DataSystems.html"><a href="C-DataSystems.html#paramétricos-versus-no-paramétricos"><i class="fa fa-check"></i><b>13.2.4</b> Paramétricos versus No Paramétricos</a></li>
<li class="chapter" data-level="13.2.5" data-path="C-DataSystems.html"><a href="C-DataSystems.html#S:expred"><i class="fa fa-check"></i><b>13.2.5</b> Explicación versus Predicción</a></li>
<li class="chapter" data-level="13.2.6" data-path="C-DataSystems.html"><a href="C-DataSystems.html#modelación-de-datos-versus-modelación-algorítmica"><i class="fa fa-check"></i><b>13.2.6</b> Modelación de Datos versus Modelación Algorítmica</a></li>
<li class="chapter" data-level="13.2.7" data-path="C-DataSystems.html"><a href="C-DataSystems.html#análisis-de-grandes-volúmenes-de-datos-big-data"><i class="fa fa-check"></i><b>13.2.7</b> Análisis de Grandes Volúmenes de Datos (Big Data)</a></li>
<li class="chapter" data-level="13.2.8" data-path="C-DataSystems.html"><a href="C-DataSystems.html#análisis-reproducibles"><i class="fa fa-check"></i><b>13.2.8</b> Análisis Reproducibles</a></li>
<li class="chapter" data-level="13.2.9" data-path="C-DataSystems.html"><a href="C-DataSystems.html#problemas-éticos"><i class="fa fa-check"></i><b>13.2.9</b> Problemas Éticos</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="C-DataSystems.html"><a href="C-DataSystems.html#técnicas-de-análisis-de-datos"><i class="fa fa-check"></i><b>13.3</b> Técnicas de Análisis de Datos</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="C-DataSystems.html"><a href="C-DataSystems.html#técnicas-exploratorias"><i class="fa fa-check"></i><b>13.3.1</b> Técnicas exploratorias</a></li>
<li class="chapter" data-level="13.3.2" data-path="C-DataSystems.html"><a href="C-DataSystems.html#técnicas-confirmatorias"><i class="fa fa-check"></i><b>13.3.2</b> Técnicas confirmatorias</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="C-DataSystems.html"><a href="C-DataSystems.html#algunas-funciones-de-r"><i class="fa fa-check"></i><b>13.4</b> Algunas funciones de R</a></li>
<li class="chapter" data-level="13.5" data-path="C-DataSystems.html"><a href="C-DataSystems.html#resumen"><i class="fa fa-check"></i><b>13.5</b> Resumen</a></li>
<li class="chapter" data-level="13.6" data-path="C-DataSystems.html"><a href="C-DataSystems.html#DS:further-reading-and-resources"><i class="fa fa-check"></i><b>13.6</b> Otros recursos y colaboradores</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html"><i class="fa fa-check"></i><b>14</b> Modelización de la Dependencia</a>
<ul>
<li class="chapter" data-level="14.1" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:VarTypes"><i class="fa fa-check"></i><b>14.1</b> Tipos de Variables</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:QuaVar"><i class="fa fa-check"></i><b>14.1.1</b> Variables Cualitativas</a></li>
<li class="chapter" data-level="14.1.2" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:QuanVar"><i class="fa fa-check"></i><b>14.1.2</b> Variables Cuantitativas</a></li>
<li class="chapter" data-level="14.1.3" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#variables-multivariantes"><i class="fa fa-check"></i><b>14.1.3</b> Variables Multivariantes</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:Measures"><i class="fa fa-check"></i><b>14.2</b> Medidas clásicas de asociaciones escalares</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#medidas-de-asociación-para-variables-ordinales"><i class="fa fa-check"></i><b>14.2.1</b> Medidas de Asociación para Variables Ordinales</a></li>
<li class="chapter" data-level="14.2.2" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#medidas-basadas-en-rangos"><i class="fa fa-check"></i><b>14.2.2</b> Medidas Basadas en Rangos</a></li>
<li class="chapter" data-level="14.2.3" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#variables-nominales"><i class="fa fa-check"></i><b>14.2.3</b> Variables Nominales</a></li>
<li class="chapter" data-level="14.2.4" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#variables-ordinales"><i class="fa fa-check"></i><b>14.2.4</b> Variables Ordinales</a></li>
<li class="chapter" data-level="14.2.5" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#variables-de-intervalo"><i class="fa fa-check"></i><b>14.2.5</b> Variables de Intervalo</a></li>
<li class="chapter" data-level="14.2.6" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#variables-discretas-y-continuas"><i class="fa fa-check"></i><b>14.2.6</b> Variables discretas y continuas</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:Copula"><i class="fa fa-check"></i><b>14.3</b> Introducción a Copulas</a></li>
<li class="chapter" data-level="14.4" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:CopAppl"><i class="fa fa-check"></i><b>14.4</b> Aplicación usando Cópulas</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#descripción-de-los-datos"><i class="fa fa-check"></i><b>14.4.1</b> Descripción de los Datos</a></li>
<li class="chapter" data-level="14.4.2" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#modelos-marginales"><i class="fa fa-check"></i><b>14.4.2</b> Modelos Marginales</a></li>
<li class="chapter" data-level="14.4.3" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#modelización-conjunta-con-función-de-cópula"><i class="fa fa-check"></i><b>14.4.3</b> Modelización Conjunta con Función de Cópula</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:CopTyp"><i class="fa fa-check"></i><b>14.5</b> Tipos de Cópulas</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#cópulas-elípticas"><i class="fa fa-check"></i><b>14.5.1</b> Cópulas Elípticas</a></li>
<li class="chapter" data-level="14.5.2" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>14.5.2</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="14.5.3" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#propiedades-de-las-cópulas"><i class="fa fa-check"></i><b>14.5.3</b> Propiedades de las Cópulas</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#S:CopImp"><i class="fa fa-check"></i><b>14.6</b> ¿Por qué es importante la modelización de la dependencia?</a></li>
<li class="chapter" data-level="14.7" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#Dep:further-reading-and-resources"><i class="fa fa-check"></i><b>14.7</b> Más Recursos y Contribuciones</a>
<ul>
<li class="chapter" data-level="" data-path="C-DependenceModel.html"><a href="C-DependenceModel.html#ts-14.a.-otras-medidas-clásicas-de-asociaciones-escalares"><i class="fa fa-check"></i>TS 14.A. Otras Medidas Clásicas de Asociaciones Escalares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="C-AppA.html"><a href="C-AppA.html"><i class="fa fa-check"></i><b>15</b> Apéndice A: Revisión de la Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="15.1" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:BASIC"><i class="fa fa-check"></i><b>15.1</b> Conceptos Básicos</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="C-AppA.html"><a href="C-AppA.html#muestreo-aleatorio"><i class="fa fa-check"></i><b>15.1.1</b> Muestreo Aleatorio</a></li>
<li class="chapter" data-level="15.1.2" data-path="C-AppA.html"><a href="C-AppA.html#distribución-muestral"><i class="fa fa-check"></i><b>15.1.2</b> Distribución Muestral</a></li>
<li class="chapter" data-level="15.1.3" data-path="C-AppA.html"><a href="C-AppA.html#teorema-central-del-límite"><i class="fa fa-check"></i><b>15.1.3</b> Teorema Central del Límite</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:PE"><i class="fa fa-check"></i><b>15.2</b> Estimación Puntual y Propiedades</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="C-AppA.html"><a href="C-AppA.html#método-de-estimación-de-momentos"><i class="fa fa-check"></i><b>15.2.1</b> Método de Estimación de Momentos</a></li>
<li class="chapter" data-level="15.2.2" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:MLE"><i class="fa fa-check"></i><b>15.2.2</b> Estimación por Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:IE"><i class="fa fa-check"></i><b>15.3</b> Estimación de Intervalo</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:IE:ED"><i class="fa fa-check"></i><b>15.3.1</b> Distribución Exacta para la Media de Muestra Normal</a></li>
<li class="chapter" data-level="15.3.2" data-path="C-AppA.html"><a href="C-AppA.html#propiedades-de-muestra-grande-del-estimador-mle"><i class="fa fa-check"></i><b>15.3.2</b> Propiedades de Muestra Grande del Estimador MLE</a></li>
<li class="chapter" data-level="15.3.3" data-path="C-AppA.html"><a href="C-AppA.html#intervalo-de-confianza"><i class="fa fa-check"></i><b>15.3.3</b> Intervalo de confianza</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:HT"><i class="fa fa-check"></i><b>15.4</b> Pruebas de Hipótesis</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="C-AppA.html"><a href="C-AppA.html#conceptos-básicos"><i class="fa fa-check"></i><b>15.4.1</b> Conceptos Básicos</a></li>
<li class="chapter" data-level="15.4.2" data-path="C-AppA.html"><a href="C-AppA.html#contraste-t-student-basado-en-el-estimador-mle"><i class="fa fa-check"></i><b>15.4.2</b> Contraste <span class="math inline">\(t\)</span>-Student Basado en el Estimador MLE</a></li>
<li class="chapter" data-level="15.4.3" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:HT:LRT"><i class="fa fa-check"></i><b>15.4.3</b> Prueba de la Razón de Verosimilitud</a></li>
<li class="chapter" data-level="15.4.4" data-path="C-AppA.html"><a href="C-AppA.html#S:AppA:HT:IC"><i class="fa fa-check"></i><b>15.4.4</b> Criterios de Información</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="C-AppB.html"><a href="C-AppB.html"><i class="fa fa-check"></i><b>16</b> Apéndice B: Esperanzas Iteradas</a>
<ul>
<li class="chapter" data-level="16.1" data-path="C-AppB.html"><a href="C-AppB.html#S:AppB:CD"><i class="fa fa-check"></i><b>16.1</b> Distribución Condicionada y Esperanza Condicional</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="C-AppB.html"><a href="C-AppB.html#distribución-condicional"><i class="fa fa-check"></i><b>16.1.1</b> Distribución Condicional</a></li>
<li class="chapter" data-level="16.1.2" data-path="C-AppB.html"><a href="C-AppB.html#caso-continuo"><i class="fa fa-check"></i><b>16.1.2</b> Caso Continuo</a></li>
<li class="chapter" data-level="16.1.3" data-path="C-AppB.html"><a href="C-AppB.html#esperanza-condicional-y-varianza-condicional"><i class="fa fa-check"></i><b>16.1.3</b> Esperanza Condicional y Varianza Condicional</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="C-AppB.html"><a href="C-AppB.html#S:AppB:IE"><i class="fa fa-check"></i><b>16.2</b> Esperanzas Iteradas y Varianza Total</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="C-AppB.html"><a href="C-AppB.html#ley-de-las-esperanzas-iteradas"><i class="fa fa-check"></i><b>16.2.1</b> Ley de las Esperanzas Iteradas</a></li>
<li class="chapter" data-level="16.2.2" data-path="C-AppB.html"><a href="C-AppB.html#ley-de-la-varianza-total"><i class="fa fa-check"></i><b>16.2.2</b> Ley de la Varianza Total</a></li>
<li class="chapter" data-level="16.2.3" data-path="C-AppB.html"><a href="C-AppB.html#aplicación"><i class="fa fa-check"></i><b>16.2.3</b> Aplicación</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="C-AppB.html"><a href="C-AppB.html#S:AppConjugateDistributions"><i class="fa fa-check"></i><b>16.3</b> Distribuciones Conjugadas</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="C-AppB.html"><a href="C-AppB.html#familia-exponencial-lineal"><i class="fa fa-check"></i><b>16.3.1</b> Familia Exponencial Lineal</a></li>
<li class="chapter" data-level="16.3.2" data-path="C-AppB.html"><a href="C-AppB.html#distribuciones-conjugadas"><i class="fa fa-check"></i><b>16.3.2</b> Distribuciones Conjugadas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="C-AppC.html"><a href="C-AppC.html"><i class="fa fa-check"></i><b>17</b> Apéndice C: Teoría de la Máxima Verosimilitud</a>
<ul>
<li class="chapter" data-level="17.1" data-path="C-AppC.html"><a href="C-AppC.html#S:AppC:LF"><i class="fa fa-check"></i><b>17.1</b> Función de Verosimilitud</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="C-AppC.html"><a href="C-AppC.html#la-función-de-verosimilitud-y-de-log-verosimilitud"><i class="fa fa-check"></i><b>17.1.1</b> La Función de Verosimilitud y de Log-verosimilitud</a></li>
<li class="chapter" data-level="17.1.2" data-path="C-AppC.html"><a href="C-AppC.html#propiedades-de-las-funciones-de-verosimilitud"><i class="fa fa-check"></i><b>17.1.2</b> Propiedades de las Funciones de Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="C-AppC.html"><a href="C-AppC.html#S:AppC:MLE"><i class="fa fa-check"></i><b>17.2</b> Estimadores de Máxima Verosimilitud</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="C-AppC.html"><a href="C-AppC.html#definición-y-derivación-del-estimador-mle"><i class="fa fa-check"></i><b>17.2.1</b> Definición y Derivación del Estimador MLE</a></li>
<li class="chapter" data-level="17.2.2" data-path="C-AppC.html"><a href="C-AppC.html#propiedades-asintóticas-del-estimador-mle"><i class="fa fa-check"></i><b>17.2.2</b> Propiedades Asintóticas del Estimador MLE</a></li>
<li class="chapter" data-level="17.2.3" data-path="C-AppC.html"><a href="C-AppC.html#uso-de-la-estimación-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>17.2.3</b> Uso de la Estimación de Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="C-AppC.html"><a href="C-AppC.html#S:AppC:SI"><i class="fa fa-check"></i><b>17.3</b> Inferencia Estadística Basada en la Estimación de Báxima Verosimilitud</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="C-AppC.html"><a href="C-AppC.html#contraste-de-hipótesis"><i class="fa fa-check"></i><b>17.3.1</b> Contraste de Hipótesis</a></li>
<li class="chapter" data-level="17.3.2" data-path="C-AppC.html"><a href="C-AppC.html#S:AppC:MLEModelVal"><i class="fa fa-check"></i><b>17.3.2</b> Validación del Modelo y MLE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html"><i class="fa fa-check"></i><b>18</b> Apéndice D: Resumen de Distribuciones</a>
<ul>
<li class="chapter" data-level="18.1" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-discretas"><i class="fa fa-check"></i><b>18.1</b> Distribuciones Discretas</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#la-clase-ab0"><i class="fa fa-check"></i><b>18.1.1</b> La clase (a,b,0)</a></li>
<li class="chapter" data-level="18.1.2" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#la-clase-ab1"><i class="fa fa-check"></i><b>18.1.2</b> La clase (a,b,1)</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-continuas"><i class="fa fa-check"></i><b>18.2</b> Distribuciones Continuas</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-un-parámetro"><i class="fa fa-check"></i><b>18.2.1</b> Distribuciones Un Parámetro</a></li>
<li class="chapter" data-level="18.2.2" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-dos-parámetros"><i class="fa fa-check"></i><b>18.2.2</b> Distribuciones Dos Parámetros</a></li>
<li class="chapter" data-level="18.2.3" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-tres-parámetros"><i class="fa fa-check"></i><b>18.2.3</b> Distribuciones Tres Parámetros</a></li>
<li class="chapter" data-level="18.2.4" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribución-cuatro-parámetros"><i class="fa fa-check"></i><b>18.2.4</b> Distribución Cuatro Parámetros</a></li>
<li class="chapter" data-level="18.2.5" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#otras-distribuciones"><i class="fa fa-check"></i><b>18.2.5</b> Otras Distribuciones</a></li>
<li class="chapter" data-level="18.2.6" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#distribuciones-con-soporte-finito"><i class="fa fa-check"></i><b>18.2.6</b> Distribuciones con Soporte Finito</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="C-SummaryDistributions.html"><a href="C-SummaryDistributions.html#valor-esperado-limitado"><i class="fa fa-check"></i><b>18.3</b> Valor Esperado Limitado</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/OpenActTexts/Loss-Data-Analytics" target="blank">Loss Data Analytics on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Loss Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="C:Simulation" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Simulación y Remuestreo</h1>
<p><em>Vista previa del capítulo.</em> La simulación es un método computacionalmente intenso usado para resolver problemas difíciles. En lugar de crear procesos físicos y experimentar con ellos para entender sus características operacionales, un estudio de simulación se basa en una representación computacional – considera varias condiciones hipotéticas como inputs y resume los resultados. Aunque se trata de una simulación, un gran número de condiciones hipotéticas pueden ser rápidamente examinadas con un bajo coste. La sección <a href="C-Simulation.html#S:SimulationFundamentals">6.1</a> introduce la simulación, una herramienta computacional maravillosa que es especialmente útil en entornos complejos multivariantes.</p>
<p>También podemos usar la simulación para realizar extracciones de una distribución empírica – proceso que se llama remuestreo. El remuestreo permite valorar la incertidumbre de las estimaciones en modelos complejos. La sección <a href="C-Simulation.html#S:Bootstrap">6.2</a> introduce el remuestreo en el contexto del bootstrapping para determinar la precisión de los estimadores.</p>
<p>Las secciones siguientes introducen otros temas del remuestreo. La Sección <a href="C-Simulation.html#S:CrossValidation">6.3</a> sobre la validación cruzada muestra como usarla para la selección y validación de modelos. La sección <a href="C-Simulation.html#S:ImportanceSampling">6.4</a> sobre la importancia del muestreo describe el remuestreo en áreas específicas de interés, como en aplicaciones actuariales con colas largas. La sección <a href="C-Simulation.html#S:MCMC">6.5</a> sobre el método de Monte Carlo basado en cadenas de Markov (MCMC, en sus siglas en inglés) introduce la simulación y el motor del remuestreo que apunta en buena medida el análisis Bayesiano moderno.</p>
<div id="S:SimulationFundamentals" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Fundamentos de la Simulación</h2>
<hr />
<p>En esta sección, se muestra como:</p>
<ul>
<li>Generar realizaciones aproximadamente independientes distribuidas uniformemente</li>
<li>Transformar las realizaciones distribuidas uniformemente en observaciones de la distribución de probabilidad de interés</li>
<li>Calcular cantidades de interés y determinar la precisión de las cantidades calculadas</li>
</ul>
<hr />
<!-- ## Fundamentos de simulación -->
<div id="generación-de-observaciones-uniformes-independientes" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Generación de observaciones uniformes independientes</h3>
<p>Las simulaciones que consideramos son generadas por ordenadores. La principal ventaja de este enfoque es que pueden ser replicadas, permitiéndonos realizar comprobaciones y mejorar nuestro trabajo. Naturalmente, esto también significa que no son realmente aleatorias. Sin embargo, se han desarrollado algoritmos para que los resultados se comporten como aleatorios a efectos prácticos. En concreto, pasan test de independencia sofisticados y pueden ser diseñados de modo que provengan de una única distribución – nuestro supuesto iid, idénticamente e independientemente distribuidas, según sus siglas en inglés.</p>
<p>Para tener una idea de lo que estos algoritmos hacen, consideramos un método de importancia histórica.</p>
<p><strong>Generador Lineal Congruencial.</strong> Para generar una secuencia de números aleatorios, comenzamos con <span class="math inline">\(B_0\)</span>, un valor inicial que es conocido como <em>semilla</em>. Este valor se actualiza utilizando la relación recursiva
<span class="math display">\[B_{n+1} = a B_n + c  \text{ modulo }m, ~~ n=0, 1, 2, \ldots .\]</span>
Este algoritmo se denomina generador lineal congruencial . El caso <span class="math inline">\(c=0\)</span> se denomina generador congruencial <em>multiplicativo</em>; es particularmente útil para cálculos realmente rápidos.</p>
<p>Como valores ilustrativos de <span class="math inline">\(a\)</span> y <span class="math inline">\(m\)</span>, Microsoft’s Visual Basic usa
<span class="math inline">\(m=2^{24}\)</span>, <span class="math inline">\(a=1,140,671,485\)</span>, y <span class="math inline">\(c = 12,820,163\)</span> (ver
<a href="https://en.wikipedia.org/wiki/Linear_congruential_generator" class="uri">https://en.wikipedia.org/wiki/Linear_congruential_generator</a>). Este es el generador subyacente en la generación de números aleatorios en el programa Microsoft Excel.</p>
<p>La secuencia usada por el analista se define como <span class="math inline">\(U_n=B_n/m.\)</span> El analista puede interpretar la secuencia
{<span class="math inline">\(U_{i}\)</span>} como (aproximadamente) idénticamente e independientemente uniformemente distribuida en el intervalo (0,1). Para ilustrar el algoritmo, se considera lo siguiente.</p>
<p><strong>Ejemplo 6.1.1. Secuencia ilustrativa.</strong></p>
<p>Se asume <span class="math inline">\(m=15\)</span>, <span class="math inline">\(a=3\)</span>, <span class="math inline">\(c=2\)</span> y <span class="math inline">\(B_0=1\)</span>. Entonces se tiene:</p>
<table>
<thead>
<tr class="header">
<th align="center">paso <span class="math inline">\(n\)</span></th>
<th align="left"><span class="math inline">\(B_n\)</span></th>
<th align="center"><span class="math inline">\(U_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="left"><span class="math inline">\(B_0=1\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="left"><span class="math inline">\(B_1 =\mod(3 \times 1 +2) = 5\)</span></td>
<td align="center"><span class="math inline">\(U_1 = \frac{5}{15}\)</span></td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="left"><span class="math inline">\(B_2 =\mod(3 \times 5 +2) = 2\)</span></td>
<td align="center"><span class="math inline">\(U_2 = \frac{2}{15}\)</span></td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="left"><span class="math inline">\(B_3 =\mod(3 \times 2 +2) = 8\)</span></td>
<td align="center"><span class="math inline">\(U_3 = \frac{8}{15}\)</span></td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="left"><span class="math inline">\(B_4 =\mod(3 \times 8 +2) = 11\)</span></td>
<td align="center"><span class="math inline">\(U_4 = \frac{11}{15}\)</span></td>
</tr>
</tbody>
</table>
<p>A veces, a los resultados aleatorios generados por ordenadores se les conoce como números pseudo-aleatorios, para reflejar el hecho de que son generados por una máquina y pueden ser replicados. Es decir, a pesar de que {<span class="math inline">\(U_{i}\)</span>} parece ser
i.i.d, puede ser reproducido usando el mismo valor de semilla (y el mismo algoritmo).</p>
<p><strong>Ejemplo 6.1.2. Generación de números aleatorios uniformes en <code>R</code>.</strong></p>
<p>El siguiente código muestra como generar tres números uniformes (0,1) en <code>R</code> usando el comando <code>runif</code>. La función <code>set.seed()</code> establece el valor inicial de la semilla. En muchos paquetes informáticos, la semilla inicial se establece usando el reloj del sistema, si no se especifica otra cosa.</p>
<div id="tres-variables-aleatorias-uniformes" class="section level5 unnumbered">
<h5>Tres variables aleatorias uniformes</h5>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="C-Simulation.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb29-2"><a href="C-Simulation.html#cb29-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb29-3"><a href="C-Simulation.html#cb29-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(U, <span class="at">digits=</span><span class="dv">5</span>, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">col.names =</span> <span class="st">&quot;Uniforme&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Uniforme</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.92424</td>
</tr>
<tr class="even">
<td align="center">0.53718</td>
</tr>
<tr class="odd">
<td align="center">0.46920</td>
</tr>
</tbody>
</table>
<hr />
<p>El generador lineal congruencial es simplemente un método para generar valores pseudo-aleatorios. Es fácil entender y es (todavía) ampliamente usado. El generador lineal congruencial tiene limitaciones, incluyendo el hecho de que es posible detectar patrones a largo plazo en el tiempo en las secuencias que genera (es necesario recordar que se puede interpretar <em>independencia</em> como una falta total de patrón funcional). No sorprende que se hayan desarrollado técnicas avanzadas para hacer frente a algunos de estos inconvenientes.</p>
</div>
</div>
<div id="S:InverseTransform" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Método de la transformada inversa</h3>
<p>Se parte de una secuencia de números aleatorios uniformes, y a continuación se transforma en la distribución de interés, sea <span class="math inline">\(F\)</span>. Una técnica destacada es el método de la transformada inversa, definido como</p>
<p><span class="math display">\[
X_i=F^{-1}\left( U_i \right) .
\]</span>
Aquí, se recuerda que en la Sección 4.1.1 se ha introducido la función de distribución inversa, <span class="math inline">\(F^{-1}\)</span>, también referenciada como función cuantil. En concreto, se define como</p>
<p><span class="math display">\[
F^{-1}(y) = \inf_x ~ \{ F(x) \ge y \} .
\]</span>
Se recuerda que <span class="math inline">\(\inf\)</span> representa <em>ínfimo</em> o el máxima cota inferior. Es en esencia el valor más pequeño de <em>x</em> que satisface la desigualdad <span class="math inline">\(\{F(x) \ge y\}\)</span>. El resultado es que la secuencia {<span class="math inline">\(X_{i}\)</span>} es aproximadamente <em>iid</em> con función de distribución <span class="math inline">\(F\)</span>.</p>
<p>El resultado de la transformada inversa puede obtenerse cuando la variable aleatoria es continua, discreta o una combinación híbrida de ambas. Ahora se presenta una serie de ejemplos para ilustrar el alcance de sus aplicaciones.</p>
<p><strong>Ejemplo 6.1.3. Generar valores aleatorios exponenciales.</strong></p>
<p>Se desea generar observaciones según una distribución exponencial con parámetro de escala <span class="math inline">\(\theta\)</span> de manera que <span class="math inline">\(F(x) = 1 - e^{-x/\theta}\)</span>. Para calcular la transformada inversa, se siguen los siguientes pasos:</p>
<p><span class="math display">\[
\begin{aligned}
 y = F(x) &amp;\iff  y = 1-e^{-x/\theta} \\
  &amp;\iff-\theta \ln(1-y) = x = F^{-1}(y) .
\end{aligned}
\]</span>
Por tanto, si <span class="math inline">\(U\)</span> tiene una distribución uniforme (0,1), entonces <span class="math inline">\(X = -\theta \ln(1-U)\)</span> tiene una distribución exponencial con parámetro <span class="math inline">\(\theta\)</span>.</p>
<p>El siguiente código de <code>R</code> muestra como se puede comenzar con los mismos tres números aleatorios uniformes del <em>Ejemplo 6.1.2</em> y transformarlos en variables aleatorias exponenciales independientes con media 10. Alternativamente, se puede usar directamente la función <code>rexp</code> de <code>R</code> para generar valores aleatorios según una distribución exponencial. El algoritmo que se construye en esta rutina es diferente por eso incluso con el mismo valor inicial de semilla, las realizaciones individuales pueden ser diferentes.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="C-Simulation.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb30-2"><a href="C-Simulation.html#cb30-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb30-3"><a href="C-Simulation.html#cb30-3" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb30-4"><a href="C-Simulation.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb30-5"><a href="C-Simulation.html#cb30-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<div id="tres-variables-aleatorias-uniformes-1" class="section level5 unnumbered">
<h5>Tres variables aleatorias uniformes</h5>
<table>
<thead>
<tr class="header">
<th align="right">Uniforme</th>
<th align="right">Exponencial 1</th>
<th align="right">Exponencial 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.92424</td>
<td align="right">25.80219</td>
<td align="right">3.25222</td>
</tr>
<tr class="even">
<td align="right">0.53718</td>
<td align="right">7.70409</td>
<td align="right">8.47652</td>
</tr>
<tr class="odd">
<td align="right">0.46920</td>
<td align="right">6.33362</td>
<td align="right">5.40176</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Ejemplo 6.1.4. Generar valores aleatorios Pareto.</strong></p>
<p>Se desea generar observaciones según una distribución de Pareto con parámetros <span class="math inline">\(\alpha\)</span> y
<span class="math inline">\(\theta\)</span> de modo que <span class="math inline">\(F(x) = 1 - \left(\frac{\theta}{x+\theta} \right)^{\alpha}\)</span>. Para calcular la transformada inversa, se pueden seguir los siguientes pasos:</p>
<p><span class="math display">\[
\begin{aligned}
 y = F(x) &amp;\Leftrightarrow 1-y = \left(\frac{\theta}{x+\theta} \right)^{\alpha} \\
  &amp;\Leftrightarrow \left(1-y\right)^{-1/\alpha} = \frac{x+\theta}{\theta} = \frac{x}{\theta} +1 \\
    &amp;\Leftrightarrow \theta \left((1-y)^{-1/\alpha} - 1\right) = x = F^{-1}(y) .\end{aligned}
\]</span></p>
<p>Por tanto, <span class="math inline">\(X = \theta \left((1-U)^{-1/\alpha} - 1\right)\)</span> tiene una distribución de Pareto con parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\theta\)</span>.</p>
<hr />
<strong>Justificación de la transformada inversa.</strong> ¿Por qué la variable aleatoria <span class="math inline">\(X = F^{-1}(U)\)</span> tiene función de distribución <span class="math inline">\(F\)</span>?
<h5 style="text-align: center;">
<a id="displayTheory.1" href="javascript:toggleTheory('ShowTheory.1','displayTheory.1');"><i><strong>Mostrar un fragmento de teoría</strong></i></a>
</h5>
<div id="ShowTheory.1" style="display: none">
<hr />
<p>Esto es fácil de establecer en el caso continuo. Dado que <span class="math inline">\(U\)</span> es una variable aleatoria uniforme en (0,1), se sabe que <span class="math inline">\(\Pr(U \le y) = y\)</span>, para <span class="math inline">\(0 \le y \le 1\)</span>. Entonces,</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(X \le x) &amp;= \Pr(F^{-1}(U) \le x) \\
 &amp;= \Pr(F(F^{-1}(U)) \le F(x)) \\
&amp;= \Pr(U \le F(x)) = F(x)
\end{aligned}
\]</span>
Tal y como es requerido. El paso clave es que <span class="math inline">\(F(F^{-1}(u)) = u\)</span> para cada <span class="math inline">\(u\)</span>, es claramente cierto cuando <span class="math inline">\(F\)</span> es estrictamente creciente.</p>
<hr />
</div>
<p>Ahora se consideran algunos ejemplos discretos.</p>
<p><strong>Ejemplo 6.1.5. Generar valores aleatorios Bernoulli.</strong></p>
<p>Se desea simular variables aleatorias que siguen una distribución Bernoulli con parámetro <span class="math inline">\(p=0.85\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:BinaryDF"></span>
<img src="LossDataAnalytics_files/figure-html/BinaryDF-1.png" alt="Función de distribución de una variable aleatoria binaria" width="50%" />
<p class="caption">
Figure 6.1: Función de distribución de una variable aleatoria binaria
</p>
</div>
<p>El gráfico de la función de distribución de la Figura <a href="C-Simulation.html#fig:BinaryDF">6.1</a> muestra que la función cuantil puede expresarse como</p>
<p><span class="math display">\[
\begin{aligned}
F^{-1}(y) = \left\{ \begin{array}{cc}
              0 &amp; 0&lt;y \leq 0.85 \\
              1 &amp; 0.85 &lt; y  \leq  1.0 .
            \end{array} \right.
\end{aligned}
\]</span>
Por tanto, con la transformada inversa se puede definir</p>
<p><span class="math display">\[
\begin{aligned}
X = \left\{ \begin{array}{cc}
              0 &amp; 0&lt;U \leq 0.85  \\
              1 &amp;  0.85 &lt; U  \leq  1.0
            \end{array} \right.
\end{aligned}
\]</span>
A modo ilustrativo, se generan tres números aleatorios para obtener</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="C-Simulation.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb31-2"><a href="C-Simulation.html#cb31-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb31-3"><a href="C-Simulation.html#cb31-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(U <span class="sc">&gt;</span> <span class="fl">0.85</span>)</span></code></pre></div>
</div>
<div id="tres-variables-aleatorias" class="section level4 unnumbered">
<h4>Tres variables aleatorias</h4>
<table>
<thead>
<tr class="header">
<th align="right">Uniforme</th>
<th align="right">Binaria X</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.92424</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.53718</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.46920</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo 6.1.6. Generación de valores aleatorios de una distribución discreta.</strong></p>
<p>Se considera el tiempo hasta que tiene lugar el fallo de una máquina en los primeros cinco años. La distribución de los tiempos de fallo viene dada por:</p>
<div id="distribución-discreta" class="section level5 unnumbered">
<h5>Distribución discreta</h5>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(~~~~~~~~~~\)</span></th>
<th align="right"><span class="math inline">\(~~~~~~~~~~\)</span></th>
<th align="right"><span class="math inline">\(~~~~~~~~~~\)</span></th>
<th align="right"><span class="math inline">\(~~~~~~~~~~\)</span></th>
<th align="right"><span class="math inline">\(~~~~~~~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tiempo</td>
<td align="right">1.0</td>
<td align="right">2.0</td>
<td align="right">3.0</td>
<td align="right">4.0</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td align="left">Probabilidad</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">0.1</td>
<td align="right">0.4</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="left">Función de distribución <span class="math inline">\(F(x)\)</span></td>
<td align="right">0.1</td>
<td align="right">0.3</td>
<td align="right">0.4</td>
<td align="right">0.8</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span id="fig:DiscreteDF"></span>
<img src="LossDataAnalytics_files/figure-html/DiscreteDF-1.png" alt="Función de Distribución de una Variable Aleatoria Discreta" width="60%" />
<p class="caption">
Figure 6.2: Función de Distribución de una Variable Aleatoria Discreta
</p>
</div>
<p>Usando el gráfico de la función de distribución en la Figura <a href="C-Simulation.html#fig:DiscreteDF">6.2</a>, con la transformada inversa se define</p>
<p><span class="math display">\[
\small{
\begin{aligned}
X = \left\{ \begin{array}{cc}
              1 &amp;   0&lt;U  \leq 0.1  \\
              2 &amp;  0.1 &lt; U  \leq  0.3\\
              3 &amp;  0.3 &lt; U  \leq  0.4\\
              4 &amp;  0.4 &lt; U  \leq  0.8  \\
              5 &amp;  0.8 &lt; U  \leq  1.0     .
            \end{array} \right.
\end{aligned}
}
\]</span></p>
<hr />
<p>Para variables aleatorias discretas en general puede no existir una ordenación de valores. Por ejemplo, una persona puede tener uno de los cinco posibles tipos de seguros de vida y en ese caso el siguiente algoritmo se puede usar para generar valores aleatorios:</p>
<p><span class="math display">\[
{\small
\begin{aligned}
X = \left\{ \begin{array}{cc}
  \textrm{whole life} &amp;   0&lt;U  \leq 0.1  \\
 \textrm{endowment} &amp;  0.1 &lt; U  \leq  0.3\\
\textrm{term life} &amp;  0.3 &lt; U  \leq  0.4\\
  \textrm{universal life} &amp;  0.4 &lt; U  \leq  0.8  \\
  \textrm{variable life} &amp;  0.8 &lt; U  \leq  1.0 .
            \end{array} \right.
\end{aligned}
}
\]</span></p>
<p>Otro analista puede usar un procedimiento alternativo como este:</p>
<p><span class="math display">\[
{\small
\begin{aligned}
X = \left\{ \begin{array}{cc}
  \textrm{whole life} &amp;   0.9&lt;U&lt;1.0  \\
 \textrm{endowment} &amp;  0.7 \leq U &lt; 0.9\\
\textrm{term life} &amp;  0.6 \leq U &lt; 0.7\\
  \textrm{universal life} &amp;  0.2 \leq U &lt; 0.6  \\
  \textrm{variable life} &amp;  0 \leq U &lt; 0.2 .
            \end{array} \right.
\end{aligned}
}
\]</span></p>
<p>Ambos algoritmos producen (a largo plazo) las mismas probabilidades, e.g., <span class="math inline">\(\Pr(\textrm{whole life})=0.1\)</span>, etcétera. Por eso, ninguno es incorrecto. Es necesario tener en cuenta que hay muchos caminos para llegar a un mismo resultado. De manera similar, se podría emplear un algoritmo alternativo para valores ordenados (como los tiempos de fallo 1, 2, 3, 4, o 5, o más).</p>
<p><strong>Ejemplo 6.1.7. Generar valores aleatorios de una distribución híbrida.</strong></p>
<p>Se considera una variable aleatoria que es 0
con probabilidad 70% y tiene distribución exponencial con parámetro
<span class="math inline">\(\theta= 10,000\)</span> con probabilidad 30%. En una aplicación actuarial, esto podría corresponder a un 70% de probabilidad de no tener un siniestro y un 30% de probabilidades de tenerlo – si un siniestro ocurre, tiene una distribución exponencial. La función de distribución, representada en la Figura <a href="C-Simulation.html#fig:MixedDF">6.3</a>, viene dada por</p>
<p><span class="math display">\[
\begin{aligned}
F(y) = \left\{ \begin{array}{cc}
              0 &amp;  x&lt;0  \\
              1 - 0.3 \exp(-x/10000) &amp; x \ge 0 .
            \end{array} \right.
\end{aligned}
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:MixedDF"></span>
<img src="LossDataAnalytics_files/figure-html/MixedDF-1.png" alt="Función de distribución de una variable aleatoria híbrida" width="60%" />
<p class="caption">
Figure 6.3: Función de distribución de una variable aleatoria híbrida
</p>
</div>
<p>En la Figura <a href="C-Simulation.html#fig:MixedDF">6.3</a>, se puede ver que la transformada inversa para generar variables aleatorias con esta función de distribución es</p>
<p><span class="math display">\[
\begin{aligned}
X = F^{-1}(U) = \left\{ \begin{array}{cc}
              0 &amp;  0&lt; U  \leq  0.7  \\
              -1000 \ln (\frac{1-U}{0.3}) &amp; 0.7 &lt; U &lt; 1 .
            \end{array} \right.
\end{aligned}
\]</span>
Para variables aleatorias discretas e híbridas, la clave es dibujar el gráfico de la función de distribución que permita visualizar valores potenciales de la función inversa.</p>
</div>
</div>
</div>
<div id="precisión-de-la-simulación" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Precisión de la simulación</h3>
<p>De las subsecciones anteriores, se sabe cómo simular valores independientes de una distribución de interés. Con estas realizaciones, se puede construir una distribución empírica y aproximar la distribución subyacente con la precisión necesaria. A medida que se introduzcan más aplicaciones actuariales en este libro, se verá que la simulación puede ser aplicada en una gran variedad de contextos.</p>
<p>Muchas de estas aplicaciones pueden reducirse a un problema de aproximar <span class="math inline">\(\mathrm{E~}h(X)\)</span>, donde <span class="math inline">\(h(\cdot)\)</span> es una función conocida. En base a <span class="math inline">\(R\)</span> simulaciones (réplicas), se obtiene <span class="math inline">\(X_1,\ldots,X_R\)</span>. A partir de esta muestra simulada, se puede calcular la media</p>
<p><span class="math display">\[
\overline{h}_R=\frac{1}{R}\sum_{i=1}^{R} h(X_i)
\]</span>
que se usa como la aproximación simulada (estimación) de <span class="math inline">\(\mathrm{E~}h(X)\)</span>. Para estimar la precisión de esta aproximación se usa la varianza de la simulación</p>
<p><span class="math display">\[
s_{h,R}^2 = \frac{1}{R-1} \sum_{i=1}^{R}\left( h(X_i) -\overline{h}_R
\right) ^2.
\]</span>
A partir del supuesto de independencia, el error estándar de la estimación es <span class="math inline">\(s_{h,R}/\sqrt{R}\)</span>. Esto se puede hacer tan pequeño como se desee incrementando el número de réplicas <span class="math inline">\(R\)</span>.</p>
<p><strong>Ejemplo. 6.1.8. Gestión de carteras.</strong></p>
<p>En la Sección 3.4, se explicó como calcular el valor esperado de pólizas con franquicias. Como ejemplo de algo que no puede hacerse con expresiones cerradas, se consideran ahora dos riesgos. Esta es una variación de un ejemplo más complejo que será presentado como <em>Ejemplo 10.3.6</em>.</p>
<p>Se consideran dos riesgos patrimoniales de una empresa de telecomunicaciones:</p>
<ul>
<li><span class="math inline">\(X_1\)</span> - edificios, modelizado usando una distribución gamma con media 200 y parámetro de escala 100.</li>
<li><span class="math inline">\(X_2\)</span> - vehículos de motor, modelizado con una distribución gamma con media 400 y parámetro de escala 200.</li>
</ul>
<p>El riesgo total se denota como <span class="math inline">\(X = X_1 + X_2.\)</span> Por simplicidad, se asume que los riesgos son independientes.</p>
<p>Para gestionar el riesgo, se busca la protección de un seguro. Se desea gestionar internamente cuantías pequeñas asociadas a edificios y vehículos de motor, hasta <span class="math inline">\(M\)</span>. El riesgo retenido es <span class="math inline">\(Y_{retenido}=\)</span> <span class="math inline">\(\min(X_1 + X_2,M)\)</span>. La porción del asegurador es <span class="math inline">\(Y_{asegurador} = X- Y_{retenido}\)</span>.</p>
<p>Para ser más concretos, se usa <span class="math inline">\(M=\)</span> 400 así como <span class="math inline">\(R=\)</span> 1000000 simulaciones.</p>
<p><strong>a.</strong> Con las especificaciones, se desea determinar la cuantía esperada de siniestros y la desviación estándar asociada de (i) lo retenido, (ii) lo aceptado por el asegurador, y (iii) la cuantía total.</p>
<h5 style="text-align: center;">
<a id="displayCode.PortMgt1.8.1" href="javascript:togglecode('toggleCode.PortMgt1.8.1','displayCode.PortMgt1.8.1');"><i><strong>Se muestra el código R para la definición de los riesgos</strong></i></a>
</h5>
<div id="toggleCode.PortMgt1.8.1" style="display: none">
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="C-Simulation.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de los riesgos</span></span>
<span id="cb32-2"><a href="C-Simulation.html#cb32-2" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="fl">1e6</span>  <span class="co">#número de simulaciones</span></span>
<span id="cb32-3"><a href="C-Simulation.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>) <span class="co">#se fija la semilla para reproducir la secuencia generada</span></span>
<span id="cb32-4"><a href="C-Simulation.html#cb32-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim,alpha1,<span class="at">scale =</span> theta1)  </span>
<span id="cb32-5"><a href="C-Simulation.html#cb32-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim,alpha2,<span class="at">scale =</span> theta2)  </span>
<span id="cb32-6"><a href="C-Simulation.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Riesgos de la cartera</span></span>
<span id="cb32-7"><a href="C-Simulation.html#cb32-7" aria-hidden="true" tabindex="-1"></a>X         <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 </span>
<span id="cb32-8"><a href="C-Simulation.html#cb32-8" aria-hidden="true" tabindex="-1"></a>Yretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X, M)</span>
<span id="cb32-9"><a href="C-Simulation.html#cb32-9" aria-hidden="true" tabindex="-1"></a>Yinsurer  <span class="ot">&lt;-</span> X <span class="sc">-</span> Yretained</span></code></pre></div>
</div>
<p>Aquí está el código para las cuantías de siniestros esperadas.</p>
<h5 style="text-align: center;">
<a id="displayCode.PortMgt1.8.2" href="javascript:togglecode('toggleCode.PortMgt1.8.2','displayCode.PortMgt1.8.2');"><i><strong>Se muestra el código R para calcular las cuantías</strong></i></a>
</h5>
<div id="toggleCode.PortMgt1.8.2" style="display: none">
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="C-Simulation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuantías esperadas de siniestros</span></span>
<span id="cb33-2"><a href="C-Simulation.html#cb33-2" aria-hidden="true" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Yretained),<span class="fu">mean</span>(Yinsurer),<span class="fu">mean</span>(X))))</span>
<span id="cb33-3"><a href="C-Simulation.html#cb33-3" aria-hidden="true" tabindex="-1"></a>sdVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">sd</span>(Yretained),<span class="fu">sd</span>(Yinsurer),<span class="fu">sd</span>(X))))</span>
<span id="cb33-4"><a href="C-Simulation.html#cb33-4" aria-hidden="true" tabindex="-1"></a>outMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ExpVec, sdVec)</span>
<span id="cb33-5"><a href="C-Simulation.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(outMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retenido&quot;</span>, <span class="st">&quot;Asegurador&quot;</span>,<span class="st">&quot;Total&quot;</span>)</span>
<span id="cb33-6"><a href="C-Simulation.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(outMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Media&quot;</span>,<span class="st">&quot;Desviación estándar&quot;</span>)</span>
<span id="cb33-7"><a href="C-Simulation.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(outMat,<span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>                    Retenido Asegurador  Total
Media                 365.17     235.01 600.18
Desviación estándar    69.51     280.86 316.36</code></pre>
</div>
<p>Los resultados de estos cálculos son:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="C-Simulation.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(outMat,<span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>                    Retenido Asegurador  Total
Media                 365.17     235.01 600.18
Desviación estándar    69.51     280.86 316.36</code></pre>
<p><strong>b.</strong> Para siniestros asegurados, la aproximación del error estandar de la simulación es <span class="math inline">\(s_{h,R}/\sqrt{1000000} =\)</span> 280.86 <span class="math inline">\(/\sqrt{1000000} =\)</span> 0.281. Para este ejemplo, la simulación es rápida y un valor grande como 1000000 es una elección fácil. En cualquier caso, para problemas complejos, el tamaño de la simulación puede ser un problema.</p>
<h5 style="text-align: center;">
<a id="displayCode.PortMgt1.8.3" href="javascript:togglecode('toggleCode.PortMgt1.8.3','displayCode.PortMgt1.8.3');"><i><strong>Se muestra el código R para establecer la visualización</strong></i></a>
</h5>
<div id="toggleCode.PortMgt1.8.3" style="display: none">
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="C-Simulation.html#cb37-1" aria-hidden="true" tabindex="-1"></a>Yinsurefct <span class="ot">&lt;-</span> <span class="cf">function</span>(numSim){</span>
<span id="cb37-2"><a href="C-Simulation.html#cb37-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(numSim,alpha1,<span class="at">scale =</span> theta1)  </span>
<span id="cb37-3"><a href="C-Simulation.html#cb37-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(numSim,alpha2,<span class="at">scale =</span> theta2)  </span>
<span id="cb37-4"><a href="C-Simulation.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Riesgos de la cartera</span></span>
<span id="cb37-5"><a href="C-Simulation.html#cb37-5" aria-hidden="true" tabindex="-1"></a>X         <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 </span>
<span id="cb37-6"><a href="C-Simulation.html#cb37-6" aria-hidden="true" tabindex="-1"></a>Yinsurer <span class="ot">&lt;-</span> X <span class="sc">-</span> <span class="fu">pmin</span>(X, M)</span>
<span id="cb37-7"><a href="C-Simulation.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(Yinsurer)</span>
<span id="cb37-8"><a href="C-Simulation.html#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-9"><a href="C-Simulation.html#cb37-9" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb37-10"><a href="C-Simulation.html#cb37-10" aria-hidden="true" tabindex="-1"></a>nPath <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb37-11"><a href="C-Simulation.html#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb37-12"><a href="C-Simulation.html#cb37-12" aria-hidden="true" tabindex="-1"></a>simU <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">Yinsurefct</span>(R<span class="sc">*</span>nPath),R,nPath)</span>
<span id="cb37-13"><a href="C-Simulation.html#cb37-13" aria-hidden="true" tabindex="-1"></a>sumP2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(simU, <span class="dv">2</span>, cumsum)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)</span></code></pre></div>
</div>
<p>La Figura <a href="C-Simulation.html#fig:PortfolioDF">6.4</a> permite visualizar el desarrollo de la aproximación a medida que aumenta el número de simulaciones.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="C-Simulation.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="dv">1</span><span class="sc">:</span>R,sumP2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">400</span>),</span>
<span id="cb38-2"><a href="C-Simulation.html#cb38-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Número de simulaciones (&quot;</span>, <span class="fu">italic</span>(<span class="st">&#39;R&#39;</span>), <span class="st">&quot;)&quot;</span>)), <span class="at">ylab=</span><span class="st">&quot;Siniestros esperados por el asegurador&quot;</span>)</span>
<span id="cb38-3"><a href="C-Simulation.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(Yinsurer),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb38-4"><a href="C-Simulation.html#cb38-4" aria-hidden="true" tabindex="-1"></a>bonds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fl">1.96</span><span class="sc">*</span><span class="fu">sd</span>(Yinsurer)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)),<span class="sc">-</span><span class="fl">1.96</span><span class="sc">*</span><span class="fu">sd</span>(Yinsurer)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)))</span>
<span id="cb38-5"><a href="C-Simulation.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(<span class="dv">1</span><span class="sc">:</span>R,bonds<span class="sc">+</span><span class="fu">mean</span>(Yinsurer),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:PortfolioDF"></span>
<img src="LossDataAnalytics_files/figure-html/PortfolioDF-1.png" alt="Estimación del número de siniestros esperados por el asegurador versus número de simulaciones." width="768" />
<p class="caption">
Figure 6.4: Estimación del número de siniestros esperados por el asegurador versus número de simulaciones.
</p>
</div>
<hr />
<p><strong>Determinación del número de simulaciones</strong></p>
<p>¿Cuántos valores simulados se recomiendan? ¿100? ¿1,000,000? Se puede usar el teorema central del límite para responder a esta cuestión.</p>
<p>Como criterio para la confianza en el resultado, se supone que se desea estar dentro del 1% de la media con 95% de certeza. Es decir, se desea <span class="math inline">\(\Pr \left( |\overline{h}_R - \mathrm{E~}h(X)| \le 0.01 \mathrm{E~}h(X) \right) \le 0.95\)</span>. De acuerdo con el teorema central del límite, la estimación debe tener distribución aproximadamente normal, por lo que se desea que <span class="math inline">\(R\)</span> sea suficientemente grande para satisfacer <span class="math inline">\(0.01 \mathrm{E~}h(X)/\sqrt{\mathrm{Var~}h(X)/R}) \ge 1.96\)</span>. (Se recuerda que 1.96 es el percentil 97.5 de una distribución normal estándar.) Reemplazando <span class="math inline">\(\mathrm{E~}h(X)\)</span> y <span class="math inline">\(\mathrm{Var~}h(X)\)</span> con sus estimaciones, se continúa la simulación hasta</p>
<p><span class="math display">\[
\frac{.01\overline{h}_R}{s_{h,R}/\sqrt{R}}\geq 1.96
\]</span>
o equivalentemente</p>
<p><span class="math display" id="eq:NumSimulations">\[\begin{equation}
R \geq 38,416\frac{s_{h,R}^2}{\overline{h}_R^2}.
\tag{6.1}
\end{equation}\]</span></p>
<p>Este criterio es una aplicación directa de la aproximación a la normal. Nótese que <span class="math inline">\(\overline{h}_R\)</span> y <span class="math inline">\(s_{h,R}\)</span> no son conocidos de antemano, por lo que se tendrán que hacer estimaciones, bien haciendo un pequeño estudio piloto de antemano o interrumpiendo el procedimiento intermitentemente para ver si el criterio se satisface.</p>
<p><strong>Ejemplo. 6.1.8. Gestión de carteras - continuación</strong></p>
<p>En este ejemplo, el número medio de siniestros es 235.011 y la correspondiente desviación estándar es 280.862. Usando la ecuación <a href="C-Simulation.html#eq:NumSimulations">(6.1)</a>, para estar dentro del 10% de la media, se requerirán al menos 54.87 miles de simulaciones. Sin embargo, para estar dentro del 1% se necesitarán al menos 5.49 millones de simulaciones.</p>
<hr />
<p><strong>Ejemplo. 6.1.9. Elección de la aproximación.</strong></p>
<p>Una importante aplicación de la simulación es la aproximación de <span class="math inline">\(\mathrm{E~}h(X)\)</span>. En este ejemplo, se muestra que la elección de la función <span class="math inline">\(h(\cdot)\)</span> y de la distribución de <span class="math inline">\(X\)</span> pueden jugar un papel importante.</p>
<p>Se considera la siguiente pregunta: ¿cuál es <span class="math inline">\(\Pr[X&gt;2]\)</span> cuando <span class="math inline">\(X\)</span> tiene una distribución de Cauchy, con densidad <span class="math inline">\(f(x) =\left(\pi(1+x^2)\right)^{-1}\)</span>, en la recta real? El valor real es</p>
<p><span class="math display">\[
\Pr\left[X&gt;2\right] = \int_2^\infty \frac{dx}{\pi(1+x^2)} .
\]</span>
Se puede usar una función de integración numérica en <code>R</code> (que funciona normalmente bien con integrales impropias)</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="C-Simulation.html#cb39-1" aria-hidden="true" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="at">lower=</span><span class="dv">2</span>,<span class="at">upper=</span><span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<p>que es igual a 0.14758.</p>
<p>Alternativamente, se pueden usar técnicas de simulación para aproximar la cantidad. Usando el cálculo, se puede comprobar que la función cuantil de una distribución de Cauchy es <span class="math inline">\(F^{-1}(y) = \tan \left( \pi(y-0.5) \right)\)</span>. Entonces, con variables uniformes (0,1) simuladas, <span class="math inline">\(U_1, \ldots, U_R\)</span>, se puede construir el estimador</p>
<p><span class="math display">\[
p_1 = \frac{1}{R}\sum_{i=1}^R \mathrm{I}(F^{-1}(U_i)&gt;2) = \frac{1}{R}\sum_{i=1}^R \mathrm{I}(\tan \left( \pi(U_i-0.5) \right)&gt;2) .
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.Approximationchoices.1.9.1" href="javascript:togglecode('toggleCode.Approximationchoices.1.9.1','displayCode.Approximationchoices.1.9.1');"><i><strong>Se muestra el código R</strong></i></a>
</h5>
<div id="toggleCode.Approximationchoices.1.9.1" style="display: none">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="C-Simulation.html#cb40-1" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">tan</span>(pi<span class="sc">*</span>(u<span class="fl">-.5</span>))</span>
<span id="cb40-2"><a href="C-Simulation.html#cb40-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb40-3"><a href="C-Simulation.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb40-4"><a href="C-Simulation.html#cb40-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">Q</span>(<span class="fu">runif</span>(R))</span>
<span id="cb40-5"><a href="C-Simulation.html#cb40-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(X<span class="sc">&gt;</span><span class="dv">2</span>)</span>
<span id="cb40-6"><a href="C-Simulation.html#cb40-6" aria-hidden="true" tabindex="-1"></a>se.p1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(X<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(R)</span>
<span id="cb40-7"><a href="C-Simulation.html#cb40-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<pre><code>[1] 0.147439</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="C-Simulation.html#cb42-1" aria-hidden="true" tabindex="-1"></a>se.p1</span></code></pre></div>
<pre><code>[1] 0.0003545432</code></pre>
</div>
<p>Con un millón de simulaciones, se obtiene una estimación de 0.14744 con error estándar 0.355 (dividido por 1000). Se puede demostrar que la varianza de <span class="math inline">\(p_1\)</span> es de orden <span class="math inline">\(0.127/R\)</span>.</p>
<p>Con otras elecciones de <span class="math inline">\(h(\cdot)\)</span> y <span class="math inline">\(F(\cdot)\)</span>, es en realidad posible reducir la incertidumbre incluso usando el mismo número de simulaciones en <code>R</code>. Para empezar, se puede usar la simetría de la distribución de Cauchy para determinar que <span class="math inline">\(\Pr[X&gt;2]=0.5\cdot\Pr[|X|&gt;2]\)</span>. Con ello, se puede construir un nuevo estimador</p>
<p><span class="math display">\[
p_2 = \frac{1}{2R}\sum_{i=1}^R \mathrm{I}(|F^{-1}(U_i)|&gt;2) .
\]</span></p>
<p>Con un millón de simulaciones, se obtiene una estimación de 0.14748 con error estándar 0.228 (dividido por 1000). Se puede demostrar que la varianza de <span class="math inline">\(p_2\)</span> es de orden <span class="math inline">\(0.052/R\)</span>.</p>
<p>&lt;!—Esto puede visualizarse abajo –&gt;</p>
<p>Pero se puede ir un paso más adelante. La integral impropia puede expresarse como una integral definida por su simple propiedad de simetría (dado que la función es simétrica y la integral en la recta real es igual a <span class="math inline">\(1\)</span>)</p>
<p><span class="math display">\[
\int_2^\infty \frac{dx}{\pi(1+x^2)}=\frac{1}{2}-\int_0^2\frac{dx}{\pi(1+x^2)} .
\]</span>
De esta expresión, una aproximación natural sería</p>
<p><span class="math display">\[
p_3 = \frac{1}{2}-\frac{1}{R}\sum_{i=1}^R h_3(2U_i), ~~~~~~\text{where}~h_3(x)=\frac{2}{\pi(1+x^2)} .
\]</span></p>
<p>Con un millón de simulaciones, se obtiene una estimación de 0.14756
con error estándar 0.169 (divido por 1000). Se puede probar que la varianza de <span class="math inline">\(p_3\)</span> es del orden <span class="math inline">\(0.0285/R\)</span>.</p>
<p>Finalmente, también se puede considerar algún cambio de variable en la integral</p>
<p><span class="math display">\[
\int_2^\infty \frac{dx}{\pi(1+x^2)}=\int_0^{1/2}\frac{y^{-2}dy}{\pi(1-y^{-2})} .
\]</span>
De esta expresión, una aproximación natural sería</p>
<p><span class="math display">\[
p_4 = \frac{1}{R}\sum_{i=1}^R h_4(U_i/2),~~~~~\text{where}~h_4(x)=\frac{1}{2\pi(1+x^2)} .
\]</span>
La expresión parece bastante similar a la anterior,</p>
<p>Con un millón de simulaciones, se obtiene una estimación de 0.14759 con error estándar 0.01 (dividido por 1000). Se puede probar que la varianza de <span class="math inline">\(p_4\)</span> es de orden <span class="math inline">\(0.00009/R\)</span>, que es mucho menor que los valores obtenidos hasta ahora!</p>
<p><a href="#tab:61">Tabla 6.1</a> resume las cuatro elecciones de <span class="math inline">\(h(\cdot)\)</span> y <span class="math inline">\(F(\cdot)\)</span> para aproximar <span class="math inline">\(\Pr[X&gt;2] =\)</span> 0.14758. El error estándar varía notablemente. Por tanto, si se desea un determinado grado de precisión, entonces el <em>número de simulaciones</em> depende mucho de cómo se escriban las integrales que se desean aproximar.</p>
<a id=tab:61></a>
<div align="center">
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="5" style="text-align: left;">
Tabla 6.1. Resumen de las cuatro elecciones para aproximar <span class="math inline">\(\Pr[X&gt;2]\)</span>.
</td>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Estimador
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Definición
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Función de soporte
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Estimación
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Error estándar
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">
<span class="math inline">\(p_1\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(\frac{1}{R}\sum_{i=1}^R \mathrm{I}(F^{-1}(U_i)&gt;2)\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(~~~~~~F^{-1}(u)=\tan \left( \pi(u-0.5) \right)~~~~~~~\)</span>
</td>
<td style="text-align: right;">
0.147439
</td>
<td style="text-align: right;">
0.000355
</td>
</tr>
<tr>
<td style="text-align: center;">
<span class="math inline">\(p_2\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(\frac{1}{2R}\sum_{i=1}^R \mathrm{I}(|F^{-1}(U_i)|&gt;2)\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(F^{-1}(u)=\tan \left( \pi(u-0.5) \right)\)</span>
</td>
<td style="text-align: right;">
0.147477
</td>
<td style="text-align: right;">
0.000228
</td>
</tr>
<tr>
<td style="text-align: center;">
<span class="math inline">\(p_3\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(\frac{1}{2}-\frac{1}{R}\sum_{i=1}^R h_3(2U_i)\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(h_3(x)=\frac{2}{\pi(1+x^2)}\)</span>
</td>
<td style="text-align: right;">
0.147558
</td>
<td style="text-align: right;">
0.000169
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: center;">
<span class="math inline">\(p_4\)</span>
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
<span class="math inline">\(\frac{1}{R}\sum_{i=1}^R h_4(U_i/2)\)</span>
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
<span class="math inline">\(h_4(x)=\frac{1}{2\pi(1+x^2)}\)</span>
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0.147587
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0.000010
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="S:SimulationStatInference" class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Simulación e inferencia estadística</h3>
<p>Las simulaciones no solo ayudan a aproximar valores esperados, sino que también son útiles para calcular otros aspectos de las funciones de distribución. En particular, son muy útiles cuando las distribuciones de los estadísticos de prueba son muy complicadas de derivar; en este caso, se pueden usar simulaciones para aproximar la distribución de referencia. Se ilustra esto con el test de Kolmogorov-Smirnov que se presenta en la Sección 4.1.2.2.</p>
<p><strong>Ejemplo. 6.1.10. Distribución del test de Kolmogorov-Smirnov.</strong>
Se tiene disponible <span class="math inline">\(n=100\)</span> observaciones <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span> que, sin que lo sepa el analista, han sido generadas por una distribución gamma de parámetros <span class="math inline">\(\alpha = 6\)</span> y <span class="math inline">\(\theta=2\)</span>. El analista cree que los datos provienen de una distribución lognormal con parámetros 1 y 0.4 y desearía comprobar esta hipótesis.</p>
<p>El primer paso es visualizar los datos.</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.1" href="javascript:togglecode('toggleCode.KSTest.1.10.1','displayCode.KSTest.1.10.1');"><i><strong>Se muestra el código R para establecer la visualización</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.1" style="display: none">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="C-Simulation.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-2"><a href="C-Simulation.html#cb44-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb44-3"><a href="C-Simulation.html#cb44-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb44-4"><a href="C-Simulation.html#cb44-4" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb44-5"><a href="C-Simulation.html#cb44-5" aria-hidden="true" tabindex="-1"></a>vx <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sort</span>(x))</span>
<span id="cb44-6"><a href="C-Simulation.html#cb44-6" aria-hidden="true" tabindex="-1"></a>vy <span class="ot">=</span> (<span class="dv">0</span><span class="sc">:</span>n)<span class="sc">/</span>n</span></code></pre></div>
</div>
<p>A partir de aquí, la Figura <a href="C-Simulation.html#fig:KSTestData">6.5</a> proporciona un gráfico del histograma y distribución empírica. A modo de referencia, se superpone con línea rojas discontinua la distribución lognormal.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="C-Simulation.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb45-2"><a href="C-Simulation.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main=</span><span class="st">&quot;Histogram&quot;</span>, <span class="at">col=</span><span class="st">&quot;light blue&quot;</span>,<span class="at">border=</span><span class="st">&quot;white&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">4</span>))</span>
<span id="cb45-3"><a href="C-Simulation.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(u,<span class="fu">dlnorm</span>(u,<span class="dv">1</span>,.<span class="dv">4</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb45-4"><a href="C-Simulation.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vx,vy,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Cumulative Distribution&quot;</span>,<span class="at">main=</span><span class="st">&quot;Empirical cdf&quot;</span>)</span>
<span id="cb45-5"><a href="C-Simulation.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(u,<span class="fu">plnorm</span>(u,<span class="dv">1</span>,.<span class="dv">4</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:KSTestData"></span>
<img src="LossDataAnalytics_files/figure-html/KSTestData-1.png" alt="Histograma y función de distribución empírica de los datos usados en el test de Kolmogorov-Smirnov. Las líneas rojas discontinuas son ajustadas en base a una (incorrecta) hipótesis de distribución lognormal." width="672" />
<p class="caption">
Figure 6.5: Histograma y función de distribución empírica de los datos usados en el test de Kolmogorov-Smirnov. Las líneas rojas discontinuas son ajustadas en base a una (incorrecta) hipótesis de distribución lognormal.
</p>
</div>
<p>Es necesario recordad qeu el estadístico de Kolmogorov-Smirnov es igual a la mayor discrepancia entre la distribución empírica y la correspondiente a la hipótesis. Esto es <span class="math inline">\(\max_x |F_n(x)-F_0(x)|\)</span>, donde <span class="math inline">\(F_0\)</span> es la distribución lognormal de la hipótesis. Se puede calcular esto de forma directa como:</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.2" href="javascript:togglecode('toggleCode.KSTest.1.10.2','displayCode.KSTest.1.10.2');"><i><strong>Se muestra el código R para el cálculo directo del estadístico KS</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.2" style="display: none">
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="C-Simulation.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test statistic</span></span>
<span id="cb46-2"><a href="C-Simulation.html#cb46-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="cf">function</span>(data, F0){</span>
<span id="cb46-3"><a href="C-Simulation.html#cb46-3" aria-hidden="true" tabindex="-1"></a>   F <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x) <span class="fu">mean</span>((data<span class="sc">&lt;=</span>x)))</span>
<span id="cb46-4"><a href="C-Simulation.html#cb46-4" aria-hidden="true" tabindex="-1"></a>   n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb46-5"><a href="C-Simulation.html#cb46-5" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">sort</span>(data)</span>
<span id="cb46-6"><a href="C-Simulation.html#cb46-6" aria-hidden="true" tabindex="-1"></a>   d1<span class="ot">=</span><span class="fu">abs</span>(<span class="fu">F</span>(x<span class="fl">+1e-6</span>)<span class="sc">-</span><span class="fu">F0</span>(x<span class="fl">+1e-6</span>))</span>
<span id="cb46-7"><a href="C-Simulation.html#cb46-7" aria-hidden="true" tabindex="-1"></a>   d2<span class="ot">=</span><span class="fu">abs</span>(<span class="fu">F</span>(x<span class="fl">-1e-6</span>)<span class="sc">-</span><span class="fu">F0</span>(x<span class="fl">-1e-6</span>))</span>
<span id="cb46-8"><a href="C-Simulation.html#cb46-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(d1,d2)))</span>
<span id="cb46-9"><a href="C-Simulation.html#cb46-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-10"><a href="C-Simulation.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">D</span>(x,<span class="cf">function</span>(x) <span class="fu">plnorm</span>(x,<span class="dv">1</span>,.<span class="dv">4</span>))</span></code></pre></div>
<pre><code>[1] 0.09703627</code></pre>
</div>
<p>Afortunadamente, para la distribución lognormal, <code>R</code> ha construido test que permiten determinar esto sin necesidad de realizar una programación complicada:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="C-Simulation.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x, plnorm, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="fl">0.4</span>)</span></code></pre></div>
<pre><code>
    One-sample Kolmogorov-Smirnov test

data:  x
D = 0.097037, p-value = 0.3031
alternative hypothesis: two-sided</code></pre>
<p>Sin embargo, para muchas distribuciones de interés actuarial, no se dispone de programas pre-construidos. Se puede usar la simulación para comprobar la relevancia de un estadístico de prueba. En concreto, para calcular el <span class="math inline">\(p\)</span>-valor, se generan miles de muestras aleatorias de una distribución <span class="math inline">\(LN(1,0.4)\)</span> (con el mismo tamaño), y se calcula empíricamente la distribución del estadístico,</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.3" href="javascript:togglecode('toggleCode.KSTest.1.10.3','displayCode.KSTest.1.10.3');"><i><strong>Se muestra el código R para la distribución simulada del estadístico KS</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.3" style="display: none">
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="C-Simulation.html#cb50-1" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb50-2"><a href="C-Simulation.html#cb50-2" aria-hidden="true" tabindex="-1"></a>d_KS <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,ns)</span>
<span id="cb50-3"><a href="C-Simulation.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cálculo de los estadísticos de prueba para un valor elevado de ns (número de muestras simuladas, según sus siglas en inglés) </span></span>
<span id="cb50-4"><a href="C-Simulation.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ns) d_KS[s] <span class="ot">&lt;-</span> <span class="fu">D</span>(<span class="fu">rlnorm</span>(n,<span class="dv">1</span>,.<span class="dv">4</span>),<span class="cf">function</span>(x) <span class="fu">plnorm</span>(x,<span class="dv">1</span>,.<span class="dv">4</span>))</span>
<span id="cb50-5"><a href="C-Simulation.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d_KS<span class="sc">&gt;</span><span class="fu">D</span>(x,<span class="cf">function</span>(x) <span class="fu">plnorm</span>(x,<span class="dv">1</span>,.<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>[1] 0.2843</code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="C-Simulation.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d_KS,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;light blue&quot;</span>,<span class="at">border=</span><span class="st">&quot;white&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Estadístico de prueba&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-2"><a href="C-Simulation.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(d_KS),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb52-3"><a href="C-Simulation.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">D</span>(x,<span class="cf">function</span>(x) <span class="fu">plnorm</span>(x,<span class="dv">1</span>,.<span class="dv">4</span>)),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:KSSimulatedDistribution"></span>
<img src="LossDataAnalytics_files/figure-html/KSSimulatedDistribution-1.png" alt="Distribución simulada del estadístico de prueba de Kolmogorov-Smirnov. La línea roja discontinua vertical marca el estadístico de prueba para una muestra de 100." width="672" />
<p class="caption">
Figure 6.6: Distribución simulada del estadístico de prueba de Kolmogorov-Smirnov. La línea roja discontinua vertical marca el estadístico de prueba para una muestra de 100.
</p>
</div>
<p>La distribución simulada basada en 10,000 muestras aleatorias se resume en la Figura <a href="C-Simulation.html#fig:KSSimulatedDistribution">6.6</a>. Aquí, el estadístico excede el valor empírico (0.09704) en 28.43% de los escenarios, mientras que el <span class="math inline">\(p\)</span>-valor <em>teórico</em> es 0.3031. Tanto para la simulación como para los <span class="math inline">\(p\)</span>-valores teóricos, las conclusiones son las mismas; los datos no proporcionan evidencia suficiente para rechazar la hipótesis de la distribución lognormal.</p>
<p>Aunque se trate solo de una aproximación, el enfoque basado en la simulación funciona en una gran variedad de distribuciones y estadísticos de prueba sin necesitar desarrollar los detalles de la teoría de base en cada situación. Se puede resumir el procedimiento para desarrollar distribuciones simuladas y <em>p</em>-valores como sigue:</p>
<ol style="list-style-type: decimal">
<li>Obtén una muestra de tamaño <em>n</em>, es decir, <span class="math inline">\(X_1, \ldots, X_n\)</span>, de una función de distribución conocida <span class="math inline">\(F\)</span>. Calcula el estadístico de interés, denotado por <span class="math inline">\(\hat{\theta}(X_1, \ldots, X_n)\)</span>. Se le llama <span class="math inline">\(\hat{\theta}^r\)</span> para la réplica <em>r</em>ésima.</li>
<li>Se repite <span class="math inline">\(r=1, \ldots, R\)</span> veces para obtener una muestra de estadísticos, <span class="math inline">\(\hat{\theta}^1, \ldots,\hat{\theta}^R\)</span>.</li>
<li>De la muestra de estadísticos en el paso 2, <span class="math inline">\(\{\hat{\theta}^1, \ldots,\hat{\theta}^R\}\)</span>, se calcula una medida de resumen de interés, como el <em>p</em>-valor.</li>
</ol>
</div>
</div>
<div id="S:Bootstrap" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Bootstrapping y Remuestreo</h2>
<hr />
<p>En esta sección, se muestra como:</p>
<ul>
<li>Generar una distribución no paramétrica bootstrap para un estadístico de interés</li>
<li>Usar la distribución bootstrap para generar estimaciones de la precisión del estadístico de interés, incluyendo sesgo, desviaciones estándar, e intervalos de confianza</li>
<li>Realizar análisis bootstrap para distribuciones paramétricas</li>
</ul>
<hr />
<!--  Bootstrap -->
<div id="fundamentos-del-bootstrap" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Fundamentos del Bootstrap</h3>
<p>La simulación presentada hasta ahora se basa en un muestreo a partir de una distribución <strong>conocida</strong>. La Sección <a href="C-Simulation.html#S:SimulationFundamentals">6.1</a> mostró como usar técnicas de simulación para obtener muestras y calcular cantidades de estas distribuciones conocidas. Sin embargo, la ciencia estadística se dedica a proporcionar inferencias sobre distribuciones que son <em>desconocidas</em>. Se recopilan estadísticos de resumen basados en esta distribución desconocida de una población. Pero, ¿cómo se puede realizar un muestreo de una distribución desconocida?</p>
<p>Naturalmente, no se pueden simular valores de una distribución desconocida pero sí que se pueden obtener valores de una muestra de observaciones. Si la muestra es una buena representación de una población, entonces nuestras extracciones simuladas de una muestra se aproximan bien a las extracciones simuladas de una población. El proceso de obtener una muestra de una muestra se llama <em>remuestreo</em> o <em>bootstrapping</em>.</p>
<p>El término bootstrap proviene de la frase (en inglés) “pulling oneself up by one’s bootstraps” (Efron, 1979). En el remuestreo, la muestra original juega el papel de la población y las estimaciones obtenidas a partir de la muestra juegan el papel de los verdaderos parámetros de la población.</p>
<p>El algoritmo de remuestreo es el mismo que el introducido en la Sección <a href="C-Simulation.html#S:SimulationStatInference">6.1.4</a> excepto que ahora usa extracciones simuladas de la muestra. Es común usar <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span> para denotar la muestra original y <span class="math inline">\(\{X_1^*, \ldots, X_n^*\}\)</span> para los valores simulados. Las extracciones se realizan con reemplazamiento para que los valores simulados sean independientes entre ellos, la misma suposición que para la muestra original. Para cada muestra, también se realizan <em>n</em> extracciones simuladas, el mismo valor que el tamaño muestral. Para distinguir este proceso de la simulación, es común usar <em>B</em> (de bootstrap) para representar el número de muestras simuladas. También se puede escribir <span class="math inline">\(\{X_1^{(b)}, \ldots, X_n^{(b)}\}\)</span>, <span class="math inline">\(b=1,\ldots, B\)</span> lo cual resulta más claro.
Hay dos métodos básicos de remuestreo, <em>model-free</em> y <em>model-based</em> (tomando sus nombres en inglés), que son, respectivamente, <em>no paramétrico</em> y <em>paramétrico</em>. En el enfoque no paramétrico, no se hace ninguna suposición sobre la distribución de la población de origen. Las extracciones simuladas provienen de la función de distribución empírica <span class="math inline">\(F_n(\cdot)\)</span>, por lo que cada extracción proviene de <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span> con probabilidad 1/<em>n</em>.</p>
<p>Por contra, para el enfoque paramétrico, se asume que se tiene conocimiento de la familia de la distribución <em>F</em>. La muestra original <span class="math inline">\(X_1, \ldots, X_n\)</span> se usa para estimar los parámetros de esa familia, es decir, <span class="math inline">\(\hat{\theta}\)</span>. Entonces, las extracciones simuladas se toman de <span class="math inline">\(F(\hat{\theta})\)</span>. En la Sección <a href="C-Simulation.html#S:ParametricBootStrap">6.2.4</a> se comenta este enfoque con más detalle.</p>
<div id="bootstrap-no-paramétrico" class="section level4 unnumbered">
<h4>Bootstrap no paramétrico</h4>
<p>La idea del bootstrap no paramétrico es usar el método inverso en <span class="math inline">\(F_n\)</span>, la función de distribución empírica acumulada, representada en la Figura <a href="C-Simulation.html#fig:InverseDFboot">6.7</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:InverseDFboot"></span>
<img src="LossDataAnalytics_files/figure-html/InverseDFboot-1.png" alt="Inversa de la función de distribución empírica" width="60%" />
<p class="caption">
Figure 6.7: Inversa de la función de distribución empírica
</p>
</div>
<p>Debido a que <span class="math inline">\(F_n\)</span> es una función escalonada, <span class="math inline">\(F_n^{-1}\)</span> toma valores en <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>. Más concretamente, puede verse la ilustración de la Figura <a href="C-Simulation.html#fig:InverseDFboot2">6.8</a>.
- si <span class="math inline">\(y\in(0,1/n)\)</span> (con probabilidad <span class="math inline">\(1/n\)</span>) se extrae el valor más pequeño (<span class="math inline">\(\min\{x_i\}\)</span>)
- si <span class="math inline">\(y\in(1/n,2/n)\)</span> (con probabilidad <span class="math inline">\(1/n\)</span>) se extrae el segundo valor más pequeño,
- …
- si <span class="math inline">\(y\in((n-1)/n,1)\)</span> (con probabilidad <span class="math inline">\(1/n\)</span>) se extrae el mayor valor (<span class="math inline">\(\max\{x_i\}\)</span>).</p>
<div class="figure" style="text-align: center"><span id="fig:InverseDFboot2"></span>
<img src="LossDataAnalytics_files/figure-html/InverseDFboot2-1.png" alt="Inversa de la función de distribución empírica" width="60%" />
<p class="caption">
Figure 6.8: Inversa de la función de distribución empírica
</p>
</div>
<p>Usar el método inverso con <span class="math inline">\(F_n\)</span> significa muestrear a partir de <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>, con probabilidad <span class="math inline">\(1/n\)</span>. Generar una muestra bootstrap de tamaño <span class="math inline">\(B\)</span> significa muestrear a partir de <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>, con probabilidad <span class="math inline">\(1/n\)</span>, con reemplazamiento. A continuación, se puede consultar el siguiente código de <code>R</code> ilustrativo.</p>
<h5 style="text-align: center;">
<a id="displayCode.BootStrap.A" href="javascript:togglecode('toggleCode.BootStrap.A','displayCode.BootStrap.A');"><i><strong>Muestra el código R para crear una muestra con Bootstrap</strong></i></a>
</h5>
<div id="toggleCode.BootStrap.A" style="display: none">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="C-Simulation.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb53-2"><a href="C-Simulation.html#cb53-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb53-3"><a href="C-Simulation.html#cb53-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb53-4"><a href="C-Simulation.html#cb53-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb53-5"><a href="C-Simulation.html#cb53-5" aria-hidden="true" tabindex="-1"></a>bootvalues <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size=</span>m, <span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<pre><code>[1] 2.6164 5.7394 5.7394 2.6164 2.6164 7.0899 0.8823 5.7394</code></pre>
<p>Se observa que el valor 0.8388 se ha obtenido tres veces.</p>
</div>
</div>
<div id="precisión-del-bootstrap-sesgo-desviación-estándar-y-mse-error-cuadrático-medio-en-sus-siglas-en-inglés" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Precisión del bootstrap: Sesgo, desviación estándar, y MSE (error cuadrático medio, en sus siglas en inglés)</h3>
<p>Se resume el procedimiento para el bootstrap no paramétrico como sigue:</p>
<ol style="list-style-type: decimal">
<li>Para la muestra <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span>, se extrae una muestra de tamaño <em>n</em> (con reemplazamiento), es decir, <span class="math inline">\(X_1^*, \ldots, X_n^*\)</span>. De las extracciones simuladas se calcula el estadístico de interés, denotado como <span class="math inline">\(\hat{\theta}(X_1^*, \ldots, X_n^*)\)</span>. Se denomina <span class="math inline">\(\hat{\theta}_b^*\)</span> para la réplica <em>b</em>ésima.</li>
<li>Se repite esto <span class="math inline">\(b=1, \ldots, B\)</span> veces para obtener una muestra de estadísticos, <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>.</li>
<li>Para la muestra de estadísticos en el paso 2, <span class="math inline">\(\{\hat{\theta}_1^*, \ldots, \hat{\theta}_B^*\}\)</span>, se calcula una medida de resumen de interés.</li>
</ol>
<p>En esta sección, se centra el interés en tres medidas de resumen, el sesgo, la desviación estándar, y el error cuadrático medio (<em>MSE</em>). <a href="#tab:62">Tabla 6.2</a> resume estas tres medidas. Aquí, <span class="math inline">\(\overline{\hat{\theta^*}}\)</span> es el promedio de <span class="math inline">\(\{\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\}\)</span>.</p>
<p><a id=tab:62></a></p>
<p><span class="math display">\[
{\small
\begin{matrix}
\text{Tabla 6.2. Medidas de resumen bootstrap}\\
\begin{array}{l|c|c|c}
\hline
\text{Medida de la población}&amp; \text{Definición de la población}&amp;\text{Aproximación bootstrap }&amp;\text{Símbolo bootstrap}\\
\hline
\text{Sesgo} &amp; \mathrm{E}(\hat{\theta})-\theta&amp;\overline{\hat{\theta^*}}-\hat{\theta}&amp; Bias_{boot}(\hat{\theta})  \\\hline
\text{Desviación estándar} &amp;   \sqrt{\mathrm{Var}(\hat{\theta})}
&amp; \sqrt{\frac{1}{B-1} \sum_{b=1}^{B}\left(\hat{\theta}_b^* -\overline{\hat{\theta^*}} \right) ^2}&amp;s_{boot}(\hat{\theta})  \\\hline
\text{Error cuadrático medio} &amp;\mathrm{E}(\hat{\theta}-\theta)^2 &amp; \frac{1}{B} \sum_{b=1}^{B}\left(\hat{\theta}_b^* -\hat{\theta}
\right)^2&amp;MSE_{boot}(\hat{\theta})\\
\hline
\end{array}\end{matrix}
}
\]</span></p>
<hr />
<p><strong>Ejemplo 6.2.1. Siniestros con daños corporales y ratio de eliminación de pérdida.</strong> Para mostrar cómo el bootstrap puede usarse para cuantificar la precisión de los estimadores, se retoma el Ejemplo 4.1.11 sobre los datos de siniestros con daños corporales donde se introdujo el estimador no paramétrico de la ratio de eliminación de pérdidas.</p>
<p><a href="#tab:63">Tabla 6.3</a> resume los resultados de la estimación bootstrap. Por ejemplo, para <span class="math inline">\(d=14000\)</span>, se vió en el Ejemplo 4.1.11 que la estimación no paramétrica de <em>LER</em> es 0.97678. Este valor tiene un sesgo estimado de 0.00018 con una desviación estándar de 0.00701. Para algunas aplicaciones, se puede desear aplicar el sesgo estimado a la estimación original para obtener un estimador corregido por el sesgo. En ello se centra el próximo ejemplo. Para esta ilustración, el sesgo es pequeño por lo que dicha corrección no es relevante.</p>
<h5 style="text-align: center;">
<a id="displayCode.LER6.2.1" href="javascript:togglecode('toggleCode.LER6.2.1','displayCode.LER6.2.1');"><i><strong>Muestra el código R para la estimaciones bootstrap de LER</strong></i></a>
</h5>
<div id="toggleCode.LER6.2.1" style="display: none">
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="C-Simulation.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo de Derrig et al</span></span>
<span id="cb55-2"><a href="C-Simulation.html#cb55-2" aria-hidden="true" tabindex="-1"></a>BIData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../../Data/DerrigResampling.csv&quot;</span>, <span class="at">header =</span>T)</span>
<span id="cb55-3"><a href="C-Simulation.html#cb55-3" aria-hidden="true" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb55-4"><a href="C-Simulation.html#cb55-4" aria-hidden="true" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb55-5"><a href="C-Simulation.html#cb55-5" aria-hidden="true" tabindex="-1"></a>LER.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(ded, data, indices){</span>
<span id="cb55-6"><a href="C-Simulation.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  resample.data <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb55-7"><a href="C-Simulation.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  sumClaims <span class="ot">&lt;-</span> <span class="fu">sum</span>(resample.data<span class="sc">$</span>AmountPaid)</span>
<span id="cb55-8"><a href="C-Simulation.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  sumClaims_d <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">pmin</span>(resample.data<span class="sc">$</span>AmountPaid,ded))</span>
<span id="cb55-9"><a href="C-Simulation.html#cb55-9" aria-hidden="true" tabindex="-1"></a>  LER <span class="ot">&lt;-</span>   sumClaims_d<span class="sc">/</span>sumClaims</span>
<span id="cb55-10"><a href="C-Simulation.html#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LER)  </span>
<span id="cb55-11"><a href="C-Simulation.html#cb55-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-12"><a href="C-Simulation.html#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="do">##Derrig et al</span></span>
<span id="cb55-13"><a href="C-Simulation.html#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb55-14"><a href="C-Simulation.html#cb55-14" aria-hidden="true" tabindex="-1"></a>dVec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>, <span class="dv">10500</span>, <span class="dv">11500</span>, <span class="dv">14000</span>, <span class="dv">18500</span>)</span>
<span id="cb55-15"><a href="C-Simulation.html#cb55-15" aria-hidden="true" tabindex="-1"></a>OutBoot <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">length</span>(dVec2),<span class="dv">6</span>)</span>
<span id="cb55-16"><a href="C-Simulation.html#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(OutBoot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>,<span class="st">&quot;Estimación NP &quot;</span>,<span class="st">&quot;Sesgo bootstrap&quot;</span>, <span class="st">&quot;Bootstrap SD&quot;</span>, </span>
<span id="cb55-17"><a href="C-Simulation.html#cb55-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Límite inferior del CI (intervalo de confianza, en sus siglas en inglés) Normal al 95%&quot;</span>, <span class="st">&quot;Límite superior del CI Normal al 95%&quot;</span>)</span>
<span id="cb55-18"><a href="C-Simulation.html#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dVec2)) {</span>
<span id="cb55-19"><a href="C-Simulation.html#cb55-19" aria-hidden="true" tabindex="-1"></a>OutBoot[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> dVec2[i]</span>
<span id="cb55-20"><a href="C-Simulation.html#cb55-20" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>BIDataUncensored, <span class="at">statistic=</span>LER.boot, <span class="at">R=</span><span class="dv">1000</span>, <span class="at">ded=</span>dVec2[i])</span>
<span id="cb55-21"><a href="C-Simulation.html#cb55-21" aria-hidden="true" tabindex="-1"></a>OutBoot[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb55-22"><a href="C-Simulation.html#cb55-22" aria-hidden="true" tabindex="-1"></a>biasboot <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)<span class="sc">-</span>results<span class="sc">$</span>t0 <span class="ot">-&gt;</span> OutBoot[i,<span class="dv">3</span>]</span>
<span id="cb55-23"><a href="C-Simulation.html#cb55-23" aria-hidden="true" tabindex="-1"></a>sdboot <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) <span class="ot">-&gt;</span> OutBoot[i,<span class="dv">4</span>]</span>
<span id="cb55-24"><a href="C-Simulation.html#cb55-24" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results)</span>
<span id="cb55-25"><a href="C-Simulation.html#cb55-25" aria-hidden="true" tabindex="-1"></a>OutBoot[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb55-26"><a href="C-Simulation.html#cb55-26" aria-hidden="true" tabindex="-1"></a>OutBoot[i,<span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb55-27"><a href="C-Simulation.html#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:63></a></p>
<div id="tabla-6.3.-estimaciones-bootstrap-para-el-ler-en-franquicias-seleccionadas" class="section level5 unnumbered">
<h5>Tabla 6.3. Estimaciones bootstrap para el LER en franquicias seleccionadas</h5>
<table>
<colgroup>
<col width="3%" />
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="50%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">d</th>
<th align="right">Estimación NP</th>
<th align="right">Sesgo bootstrap</th>
<th align="right">Bootstrap SD</th>
<th align="right">Límite inferior del CI (intervalo de confianza, en sus siglas en inglés) Normal al 95%</th>
<th align="right">Límite superior del CI Normal al 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4000</td>
<td align="right">0.54113</td>
<td align="right">0.00011</td>
<td align="right">0.01237</td>
<td align="right">0.51678</td>
<td align="right">0.56527</td>
</tr>
<tr class="even">
<td align="right">5000</td>
<td align="right">0.64960</td>
<td align="right">0.00027</td>
<td align="right">0.01412</td>
<td align="right">0.62166</td>
<td align="right">0.67700</td>
</tr>
<tr class="odd">
<td align="right">10500</td>
<td align="right">0.93563</td>
<td align="right">0.00004</td>
<td align="right">0.01017</td>
<td align="right">0.91567</td>
<td align="right">0.95553</td>
</tr>
<tr class="even">
<td align="right">11500</td>
<td align="right">0.95281</td>
<td align="right">-0.00003</td>
<td align="right">0.00941</td>
<td align="right">0.93439</td>
<td align="right">0.97128</td>
</tr>
<tr class="odd">
<td align="right">14000</td>
<td align="right">0.97678</td>
<td align="right">0.00016</td>
<td align="right">0.00687</td>
<td align="right">0.96316</td>
<td align="right">0.99008</td>
</tr>
<tr class="even">
<td align="right">18500</td>
<td align="right">0.99382</td>
<td align="right">0.00014</td>
<td align="right">0.00331</td>
<td align="right">0.98719</td>
<td align="right">1.00017</td>
</tr>
</tbody>
</table>
<p>La desviación estándar bootstrap proporciona una medida de precisión. Para una aplicación de las desviaciones estándar, se puede usar la aproximación normal para crear un intervalo de confianza. Por ejemplo, la función de <code>R</code> <code>boot.ci</code> produce intervalos de confianza normales al 95%. Se producen creando un intervalo de dos veces la amplitud de 1.95994 desviaciones estándar bootstrap, centrado en el estimador corregido por el sesgo (1.95994 es el cuantil 97.5 de la distribución normal estándar). Por ejemplo, el intervalo inferior del 95% CI normal en <span class="math inline">\(d=14000\)</span> es <span class="math inline">\((0.97678-0.00018)- 1.95994*0.00701\)</span> <span class="math inline">\(= 0.96286\)</span>. Más adelante se comentan los intervalos de confianza bootstrap en la siguiente sección.</p>
<hr />
<p><strong>Ejemplo 6.2.2. Estimar <span class="math inline">\(\exp(\mu)\)</span>.</strong></p>
<p>El bootstrap se puede usar para cuantificar el sesgo de un estimador, por ejemplo. Consideramos una muestra <span class="math inline">\(\mathbf{x}=\{x_1,\cdots,x_n\}\)</span> que es iid con media <span class="math inline">\(\mu\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="C-Simulation.html#cb56-1" aria-hidden="true" tabindex="-1"></a>sample_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.46</span>,<span class="fl">2.80</span>,<span class="fl">3.28</span>,<span class="fl">3.86</span>,<span class="fl">2.85</span>,<span class="fl">3.67</span>,<span class="fl">3.37</span>,<span class="fl">3.40</span>,<span class="fl">5.22</span>,<span class="fl">2.55</span>,</span>
<span id="cb56-2"><a href="C-Simulation.html#cb56-2" aria-hidden="true" tabindex="-1"></a>              <span class="fl">2.79</span>,<span class="fl">4.50</span>,<span class="fl">3.37</span>,<span class="fl">2.88</span>,<span class="fl">1.44</span>,<span class="fl">2.56</span>,<span class="fl">2.00</span>,<span class="fl">2.07</span>,<span class="fl">2.19</span>,<span class="fl">1.77</span>)</span></code></pre></div>
<p>Se supone que la cantidad de interés es <span class="math inline">\(\theta=\exp(\mu)\)</span>. Un estimador natural sería <span class="math inline">\(\widehat{\theta}_1=\exp(\overline{x})\)</span>. Este estimador tiene sesgo (debido a la desigualdad Jensen) pero es asintóticamente insesgado. Para nuestra muestra, la estimación es como se muestra a continuación.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="C-Simulation.html#cb57-1" aria-hidden="true" tabindex="-1"></a>(theta_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(sample_x)))</span></code></pre></div>
<pre><code>[1] 19.13463</code></pre>
<p>Se puede usar el teorema central del límite para obtener una corrección usando</p>
<p><span class="math display">\[
\overline{X}\approx\mathcal{N}\left(\mu,\frac{\sigma^2}{n}\right)\text{ where }\sigma^2=\text{Var}[X_i] ,
\]</span>
De modo que, con la función generatriz de momentos normal, se tiene</p>
<p><span class="math display">\[
\mathrm{E}~\exp[\overline{X}] \approx \exp\left(\mu+\frac{\sigma^2}{2n}\right) .
\]</span>
Por tanto, se puede considerar</p>
<p><span class="math display">\[
\widehat{\theta}_2=\exp\left(\overline{x}-\frac{\widehat{\sigma}^2}{2n}\right) .
\]</span>
Para nuestros datos, resulta lo siguiente.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="C-Simulation.html#cb59-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_x)</span>
<span id="cb59-2"><a href="C-Simulation.html#cb59-2" aria-hidden="true" tabindex="-1"></a>(theta_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(sample_x)<span class="sc">-</span><span class="fu">var</span>(sample_x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n)))</span></code></pre></div>
<pre><code>[1] 18.73334</code></pre>
<p>Otra estrategia (que no vamos a desarrollar aquí) sería usar una aproximación de Taylor para obtener un estimador más preciso (como en el método delta),</p>
<p><span class="math display">\[
g(\overline{x})=g(\mu)+(\overline{x}-\mu)g&#39;(\mu)+(\overline{x}-\mu)^2\frac{g&#39;&#39;(\mu)}{2}+\cdots
\]</span>
La alternativa que se explora es usar una estrategia bootstrap: dada una muestra bootstrap, <span class="math inline">\(\mathbf{x}^{\ast}_{b}\)</span>, sea <span class="math inline">\(\overline{x}^{\ast}_{b}\)</span> dsu media, y se establece</p>
<p><span class="math display">\[
\widehat{\theta}_3=\frac{1}{B}\sum_{b=1}^B\exp(\overline{x}^{\ast}_{b}) .
\]</span>
Para implementarlo, se proporciona el siguiente código.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapdisn.1" href="javascript:togglecode('toggleCode.bootstrapdisn.1','displayCode.bootstrapdisn.1');"><i><strong>Se muestra el código R para crear muestras bootstrap</strong></i></a>
</h5>
<div id="toggleCode.bootstrapdisn.1" style="display: none">
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="C-Simulation.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-2"><a href="C-Simulation.html#cb61-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>sample_x, </span>
<span id="cb61-3"><a href="C-Simulation.html#cb61-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">statistic=</span><span class="cf">function</span>(y,indices) <span class="fu">exp</span>(<span class="fu">mean</span>(y[indices])), </span>
<span id="cb61-4"><a href="C-Simulation.html#cb61-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb61-5"><a href="C-Simulation.html#cb61-5" aria-hidden="true" tabindex="-1"></a>theta_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)</span></code></pre></div>
</div>
<p>Entonces, se puede <code>plot(results)</code> y <code>print(results)</code> para observar lo siguiente.</p>
<div class="figure" style="text-align: center"><span id="fig:BootstrapDistn"></span>
<img src="LossDataAnalytics_files/figure-html/BootstrapDistn-1.png" alt="Distribución de las réplicas bootstrap. El panel de la izquierda es un histograma de réplicas. El panel de la derecha es un gráfico cuantil-cuantil, que compara la distribución bootstrap con la distribución normal estándar." width="672" />
<p class="caption">
Figure 6.9: Distribución de las réplicas bootstrap. El panel de la izquierda es un histograma de réplicas. El panel de la derecha es un gráfico cuantil-cuantil, que compara la distribución bootstrap con la distribución normal estándar.
</p>
</div>
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = sample_x, statistic = function(y, indices) exp(mean(y[indices])), 
    R = 1000)


Bootstrap Statistics :
    original    bias    std. error
t1* 19.13463 0.2536551    3.909725</code></pre>
<p>Esto resulta en tres estimadores, el estimador bruto <span class="math inline">\(\widehat{\theta}_1=\)</span> 19.135, la corrección de segundo orden <span class="math inline">\(\widehat{\theta}_2=\)</span> 18.733, y el estimador bootstrap <span class="math inline">\(\widehat{\theta}_3=\)</span> 19.388.
¿Como funciona esto con diferentes tamaños de muestra? Ahora se supone que <span class="math inline">\(x_i\)</span>’s son generadas a partir de una distribución lognormal <span class="math inline">\(LN(0,1)\)</span>, de modo que <span class="math inline">\(\mu = \exp(0 + 1/2) = 1.648721\)</span> y <span class="math inline">\(\theta = \exp(1.648721)\)</span> <span class="math inline">\(= 5.200326\)</span>. Se usa la simulación para extraer los tamaños muestrales pero luego se actúa como si fueran un conjunto de observaciones realizadas. Véase el siguiente código ilustrativo.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapdisn.2" href="javascript:togglecode('toggleCode.bootstrapdisn.2','displayCode.bootstrapdisn.2');"><i><strong>Se muestral el código R para crear muestras bootstrap</strong></i></a>
</h5>
<div id="toggleCode.bootstrapdisn.2" style="display: none">
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="C-Simulation.html#cb63-1" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb63-2"><a href="C-Simulation.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb63-3"><a href="C-Simulation.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  theta_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(x))</span>
<span id="cb63-4"><a href="C-Simulation.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  theta_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">var</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb63-5"><a href="C-Simulation.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x, </span>
<span id="cb63-6"><a href="C-Simulation.html#cb63-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">statistic=</span><span class="cf">function</span>(y,indices) <span class="fu">exp</span>(<span class="fu">mean</span>(y[indices])), </span>
<span id="cb63-7"><a href="C-Simulation.html#cb63-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb63-8"><a href="C-Simulation.html#cb63-8" aria-hidden="true" tabindex="-1"></a>  theta_3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)</span>
<span id="cb63-9"><a href="C-Simulation.html#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(theta_1,theta_2,theta_3))</span>
<span id="cb63-10"><a href="C-Simulation.html#cb63-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-11"><a href="C-Simulation.html#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2074</span>)</span>
<span id="cb63-12"><a href="C-Simulation.html#cb63-12" aria-hidden="true" tabindex="-1"></a>ns<span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb63-13"><a href="C-Simulation.html#cb63-13" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb63-14"><a href="C-Simulation.html#cb63-14" aria-hidden="true" tabindex="-1"></a>call_param <span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">param</span>(<span class="fu">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb63-15"><a href="C-Simulation.html#cb63-15" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(call_param)(<span class="dv">1</span><span class="sc">:</span>ns)</span>
<span id="cb63-16"><a href="C-Simulation.html#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(V,<span class="dv">1</span>,median)</span>
<span id="cb63-17"><a href="C-Simulation.html#cb63-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-18"><a href="C-Simulation.html#cb63-18" aria-hidden="true" tabindex="-1"></a>VN<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">5</span>)</span>
<span id="cb63-19"><a href="C-Simulation.html#cb63-19" aria-hidden="true" tabindex="-1"></a>Est <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(est)(VN)</span></code></pre></div>
</div>
<p>Los resultados de la comparación se resumen en la Figura <a href="C-Simulation.html#fig:BootstrapCompare">6.10</a>. Esta figura muestra que el estimador bootstrap está más cerca del verdadero valor del parámetro para casi todos los tamaños muestrales. El sesgo de los tres estimadores decrece al aumentar el tamaño muestral.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="C-Simulation.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(VN,<span class="fu">t</span>(Est),<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">ylim=</span><span class="fu">exp</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb64-2"><a href="C-Simulation.html#cb64-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;sample size (n)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;estimator&quot;</span>)</span>
<span id="cb64-3"><a href="C-Simulation.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">exp</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)),<span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb64-4"><a href="C-Simulation.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;estimador bruto&quot;</span>, <span class="st">&quot;corrección de segundo orden&quot;</span>, <span class="st">&quot;bootstrap&quot;</span>),</span>
<span id="cb64-5"><a href="C-Simulation.html#cb64-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:BootstrapCompare"></span>
<img src="LossDataAnalytics_files/figure-html/BootstrapCompare-1.png" alt="Comparación de estimaciones. El verdadero valor del parámetro viene dado por la línea continua horizontal en 5.20." width="672" />
<p class="caption">
Figure 6.10: Comparación de estimaciones. El verdadero valor del parámetro viene dado por la línea continua horizontal en 5.20.
</p>
</div>
</div>
</div>
<div id="intervalos-de-confianza" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Intervalos de confianza</h3>
<p>El procedimiento bootstrap genera <em>B</em> réplicas <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span> del estimador <span class="math inline">\(\hat{\theta}\)</span>. En el <em>Ejemplo 6.2.1,</em> se mostró cómo usar las aproximaciones a la normal estándar para crear intervalos de confianza de los parámetros de interés. Sin embargo, dado que el interés se centra en usar el bootstrap para evitar confiar en supuestos de aproximación a la normal, no sorprende que haya disponibilidad de intervalos de confianza alternativos.</p>
<p>Para un estimador <span class="math inline">\(\hat{\theta}\)</span>, el intervalo de confianza <em>básico</em> bootstrap es</p>
<p><span class="math display" id="eq:basicBootCI">\[\begin{equation} 
  \left(2 \hat{\theta} - q_U, 2 \hat{\theta} - q_L \right) ,
  \tag{6.2}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(q_L\)</span> y <span class="math inline">\(q_U\)</span> son los cuantiles al 2.5% inferior y superior de la muestra bootstrap <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>.
Para ver de dónde viene esto, se toma como punto de partida la idea de que <span class="math inline">\((q_L, q_U)\)</span> proporciona un intervalo al 95% para <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>. Por tanto, para un <span class="math inline">\(\hat{\theta}_b^*\)</span> aleatorio, hay un 95% de probabilidades de que <span class="math inline">\(q_L \le \hat{\theta}_b^* \le q_U\)</span>. Revirtiendo las desigualdades y añadiendo <span class="math inline">\(\hat{\theta}\)</span> a cada lado se obtiene un intervalo al 95%</p>
<p><span class="math display">\[
\hat{\theta} -q_U \le \hat{\theta} - \hat{\theta}_b^* \le  \hat{\theta} -q_L .
\]</span>
Por tanto, <span class="math inline">\(\left( \hat{\theta}-q_U, \hat{\theta} -q_L\right)\)</span> es un intervalo al 95% para <span class="math inline">\(\hat{\theta} - \hat{\theta}_b^*\)</span>. La idea de la aproximación bootstrap indica que ello es también un intervalo al 95% para <span class="math inline">\(\theta - \hat{\theta}\)</span>. Añadiendo <span class="math inline">\(\hat{\theta}\)</span> a cada lado da un intervalo al 95% en la ecuación <a href="C-Simulation.html#eq:basicBootCI">(6.2)</a>.</p>
<p>Hay muchos intervalos bootstrap alternativos. El más sencillo de explicar es el intervalo basado en los percentiles bootstrap que se define como <span class="math inline">\(\left(q_L, q_U\right)\)</span>. No obstante, presenta la desventaja de tener un comportamiento potencialmente pobre en las colas, lo cual puede ser un inconveniente en algunos problemas actuariales de interés.</p>
<p><strong>Ejemplo 6.2.3. Siniestros con daños corporales y medidas de riesgo.</strong> Para ver cómo funcionan los intervalos de confianza bootstrap, se retoma los datos sobre siniestros del automóvil con daños corporales considerados en el Ejemplo 6.2.1. En lugar de la ratio de eliminación de pérdida, se desea estimar el percentil al 95% <span class="math inline">\(F^{-1}(0.95)\)</span> y una medida definida como
<span class="math display">\[
TVaR_{0.95)}[X] = \mathrm{E}[X | X &gt; F^{-1}(0.95)] .
\]</span>
Esta medida se llama tail value-at-risk; es el valor esperado de <span class="math inline">\(X\)</span> condicionado a que <span class="math inline">\(X\)</span> exceda el percentil al 95%. En la Sección 10.2 se explica como los cuantiles y el tail value-at-risk son los dos ejemplos más importantes de las llamadas <em>medidas de riesgo</em>. Por el momento, se considerarán simplemente como medidas que se quieren estimar. Para el percentil, se usa el estimador no paramétrico <span class="math inline">\(F^{-1}_n(0.95)\)</span> definido en la Sección 4.1.1.3. Para el tail value-at-risk, se usa el principio plug-in para definir el estimador no paramétrico</p>
<p><span class="math display">\[
TVaR_{n,0.95}[X] = \frac{\sum_{i=1}^n X_i I(X_i &gt; F^{-1}_n(0.95))}{\sum_{i=1}^n I(X_i &gt; F^{-1}_n(0.95))} ~.
\]</span>
En esta expresión, el denominador cuenta el número de observaciones que exceden el percentil al 95% <span class="math inline">\(F^{-1}_n(0.95)\)</span>. El numerador suma las pérdidas para aquellas observaciones que exceden <span class="math inline">\(F^{-1}_n(0.95)\)</span>. <a href="#tab:64">Tabla 6.4</a> resume el estimador para para fracciones seleccionadas.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapquantiles.1" href="javascript:togglecode('toggleCode.bootstrapquantiles.1','displayCode.bootstrapquantiles.1');"><i><strong>Se muestra el código R para crear muestras basadas en el cuantil Bootstrap</strong></i></a>
</h5>
<div id="toggleCode.bootstrapquantiles.1" style="display: none">
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="C-Simulation.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb65-2"><a href="C-Simulation.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#BIData &lt;- read.csv(&quot;./Data/DerrigResampling.csv&quot;, header =T)</span></span>
<span id="cb65-3"><a href="C-Simulation.html#cb65-3" aria-hidden="true" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb65-4"><a href="C-Simulation.html#cb65-4" aria-hidden="true" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb65-5"><a href="C-Simulation.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb65-6"><a href="C-Simulation.html#cb65-6" aria-hidden="true" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb65-7"><a href="C-Simulation.html#cb65-7" aria-hidden="true" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb65-8"><a href="C-Simulation.html#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(OutBoot1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fracción&quot;</span>,<span class="st">&quot;Estimación NP &quot;</span>, <span class="st">&quot;Sesgo bootstrap&quot;</span>, <span class="st">&quot;Bootstrap SD&quot;</span>, </span>
<span id="cb65-9"><a href="C-Simulation.html#cb65-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Límite inferior del CI Normal al 95%&quot;</span>, <span class="st">&quot;Límite superior del CI Normal al 95%&quot;</span>,</span>
<span id="cb65-10"><a href="C-Simulation.html#cb65-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Límite inferior del CI básico al 95% &quot;</span>, <span class="st">&quot;Límite superior del CI básico al 95%&quot;</span>,</span>
<span id="cb65-11"><a href="C-Simulation.html#cb65-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Límite inferior del CI percentil al 95%&quot;</span>, <span class="st">&quot;Límite superior del CI percentil al 95% &quot;</span>)</span>
<span id="cb65-12"><a href="C-Simulation.html#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb65-13"><a href="C-Simulation.html#cb65-13" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb65-14"><a href="C-Simulation.html#cb65-14" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>BIDataUncensored<span class="sc">$</span>AmountPaid,</span>
<span id="cb65-15"><a href="C-Simulation.html#cb65-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">statistic=</span><span class="cf">function</span>(X,indices)</span>
<span id="cb65-16"><a href="C-Simulation.html#cb65-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">quantile</span>(X[indices],PercentVec[i]),</span>
<span id="cb65-17"><a href="C-Simulation.html#cb65-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb65-18"><a href="C-Simulation.html#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){bootreal <span class="ot">&lt;-</span> results<span class="sc">$</span>t}</span>
<span id="cb65-19"><a href="C-Simulation.html#cb65-19" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb65-20"><a href="C-Simulation.html#cb65-20" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)<span class="sc">-</span>results<span class="sc">$</span>t0 </span>
<span id="cb65-21"><a href="C-Simulation.html#cb65-21" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) </span>
<span id="cb65-22"><a href="C-Simulation.html#cb65-22" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb65-23"><a href="C-Simulation.html#cb65-23" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb65-24"><a href="C-Simulation.html#cb65-24" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb65-25"><a href="C-Simulation.html#cb65-25" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">7</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb65-26"><a href="C-Simulation.html#cb65-26" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">8</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb65-27"><a href="C-Simulation.html#cb65-27" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">9</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb65-28"><a href="C-Simulation.html#cb65-28" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">10</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb65-29"><a href="C-Simulation.html#cb65-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:64></a></p>
<div id="tabla-6.4.-estimaciones-bootstrap-de-cuantiles-en-fracciones-seleccionadas" class="section level5 unnumbered">
<h5>Tabla 6.4. Estimaciones bootstrap de cuantiles en fracciones seleccionadas</h5>
<table>
<colgroup>
<col width="3%" />
<col width="5%" />
<col width="5%" />
<col width="4%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Fracción</th>
<th align="right">Estimación NP</th>
<th align="right">Sesgo bootstrap</th>
<th align="right">Bootstrap SD</th>
<th align="right">Límite inferior del CI Normal al 95%</th>
<th align="right">Límite superior del CI Normal al 95%</th>
<th align="right">Límite inferior del CI básico al 95%</th>
<th align="right">Límite superior del CI básico al 95%</th>
<th align="right">Límite inferior del CI percentil al 95%</th>
<th align="right">Límite superior del CI percentil al 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">6500.00</td>
<td align="right">-128.02</td>
<td align="right">200.36</td>
<td align="right">6235.32</td>
<td align="right">7020.72</td>
<td align="right">6300.00</td>
<td align="right">7000.00</td>
<td align="right">6000.00</td>
<td align="right">6700.00</td>
</tr>
<tr class="even">
<td align="right">0.80</td>
<td align="right">9078.40</td>
<td align="right">89.51</td>
<td align="right">200.27</td>
<td align="right">8596.38</td>
<td align="right">9381.41</td>
<td align="right">8533.20</td>
<td align="right">9230.40</td>
<td align="right">8926.40</td>
<td align="right">9623.60</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">11454.00</td>
<td align="right">55.95</td>
<td align="right">480.66</td>
<td align="right">10455.96</td>
<td align="right">12340.13</td>
<td align="right">10530.49</td>
<td align="right">12415.00</td>
<td align="right">10493.00</td>
<td align="right">12377.51</td>
</tr>
<tr class="even">
<td align="right">0.95</td>
<td align="right">13313.40</td>
<td align="right">13.59</td>
<td align="right">667.74</td>
<td align="right">11991.07</td>
<td align="right">14608.55</td>
<td align="right">11509.70</td>
<td align="right">14321.00</td>
<td align="right">12305.80</td>
<td align="right">15117.10</td>
</tr>
<tr class="odd">
<td align="right">0.98</td>
<td align="right">16758.72</td>
<td align="right">101.46</td>
<td align="right">1273.45</td>
<td align="right">14161.34</td>
<td align="right">19153.19</td>
<td align="right">14517.44</td>
<td align="right">19326.95</td>
<td align="right">14190.49</td>
<td align="right">19000.00</td>
</tr>
</tbody>
</table>
<p>Por ejemplo, cuando la fracción es 0.50, se observa que los cuantiles al 2.5th por abajo y por arriba de las simulaciones bootstrap son <span class="math inline">\(q_L=\)</span> 6000 y <span class="math inline">\(q_u=\)</span> 6700, respectivamente. Ello forma el intervalo de confianza percentil bootstrap. Con el estimador no paramétrico 6500, se obtienen los límites inferiores y superiores de los intervalos de confianza básicos 6300
y 7000, respectivamente. La <a href="#tab:64">Tabla 6.4</a> también muestra las estimaciones bootstrap del sesgo, desviación estándar, y el intervalo de confianza normal, conceptos introducidos en la sección anterior.</p>
<p>La <a href="#tab:65">Tabla 6.5</a> muestra cálculos similares para el tail value-at-risk. En cada caso, se observa que la desviación estándar bootstrap aumenta a medida que la fracción aumenta. Ello es un reflejo de que cada vez hay menos observaciones disponibles para estimar los cuantiles a medida que la fracción aumenta, y por lo tanto hay una mayor imprecisión. La amplitud de los intervalos de confianza también aumenta. Resulta interesante ver que no parece haber el mismo patrón en las estimaciones del sesgo.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapquantiles.2" href="javascript:togglecode('toggleCode.bootstrapquantiles.2','displayCode.bootstrapquantiles.2');"><i><strong>Se muestra el código R para crear muestras basadas en el TVar Bootstrap</strong></i></a>
</h5>
<div id="toggleCode.bootstrapquantiles.2" style="display: none">
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="C-Simulation.html#cb66-1" aria-hidden="true" tabindex="-1"></a>CTE.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices, RiskLevel){</span>
<span id="cb66-2"><a href="C-Simulation.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  resample.data <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb66-3"><a href="C-Simulation.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> resample.data<span class="sc">$</span>AmountPaid</span>
<span id="cb66-4"><a href="C-Simulation.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  cutoff <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X, RiskLevel)</span>
<span id="cb66-5"><a href="C-Simulation.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  CTE <span class="ot">&lt;-</span> <span class="fu">sum</span>(X<span class="sc">*</span>(X <span class="sc">&gt;</span> cutoff))<span class="sc">/</span><span class="fu">sum</span>(X <span class="sc">&gt;</span> cutoff)</span>
<span id="cb66-6"><a href="C-Simulation.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(CTE) </span>
<span id="cb66-7"><a href="C-Simulation.html#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="C-Simulation.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)  </span>
<span id="cb66-9"><a href="C-Simulation.html#cb66-9" aria-hidden="true" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb66-10"><a href="C-Simulation.html#cb66-10" aria-hidden="true" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb66-11"><a href="C-Simulation.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(OutBoot1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fracción&quot;</span>,<span class="st">&quot;Estimación NP&quot;</span>, <span class="st">&quot;Sesgo bootstrap&quot;</span>, </span>
<span id="cb66-12"><a href="C-Simulation.html#cb66-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;Bootstrap SD&quot;</span>, <span class="st">&quot;Límite inferior del CI normal al 95% &quot;</span>, <span class="st">&quot;Límite superior del CI normal al 95% &quot;</span>,</span>
<span id="cb66-13"><a href="C-Simulation.html#cb66-13" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;Límite inferior del CI básico al 95%&quot;</span>, <span class="st">&quot;Límite superior del CI básico al 95%&quot;</span>,</span>
<span id="cb66-14"><a href="C-Simulation.html#cb66-14" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;Límite inferior del CI percentil al 95%&quot;</span>, <span class="st">&quot;Límite superior del CI Percentil al 95% &quot;</span>)</span>
<span id="cb66-15"><a href="C-Simulation.html#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb66-16"><a href="C-Simulation.html#cb66-16" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb66-17"><a href="C-Simulation.html#cb66-17" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>BIDataUncensored, <span class="at">statistic=</span>CTE.boot, <span class="at">R=</span><span class="dv">1000</span>, <span class="at">RiskLevel=</span>PercentVec[i])</span>
<span id="cb66-18"><a href="C-Simulation.html#cb66-18" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb66-19"><a href="C-Simulation.html#cb66-19" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)<span class="sc">-</span>results<span class="sc">$</span>t0 </span>
<span id="cb66-20"><a href="C-Simulation.html#cb66-20" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) </span>
<span id="cb66-21"><a href="C-Simulation.html#cb66-21" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb66-22"><a href="C-Simulation.html#cb66-22" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb66-23"><a href="C-Simulation.html#cb66-23" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb66-24"><a href="C-Simulation.html#cb66-24" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">7</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb66-25"><a href="C-Simulation.html#cb66-25" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">8</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb66-26"><a href="C-Simulation.html#cb66-26" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">9</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb66-27"><a href="C-Simulation.html#cb66-27" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">10</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb66-28"><a href="C-Simulation.html#cb66-28" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<p><a id=tab:65></a></p>
</div>
<div id="tabla-6.5.-estimación-bootstrap-del-tvar-en-niveles-de-riesgo-seleccionados" class="section level5 unnumbered">
<h5>Tabla 6.5. Estimación bootstrap del TVaR en niveles de riesgo seleccionados</h5>
<table>
<colgroup>
<col width="3%" />
<col width="4%" />
<col width="5%" />
<col width="4%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Fracción</th>
<th align="right">Estimación NP</th>
<th align="right">Sesgo bootstrap</th>
<th align="right">Bootstrap SD</th>
<th align="right">Límite inferior del CI normal al 95%</th>
<th align="right">Límite superior del CI normal al 95%</th>
<th align="right">Límite inferior del CI básico al 95%</th>
<th align="right">Límite superior del CI básico al 95%</th>
<th align="right">Límite inferior del CI percentil al 95%</th>
<th align="right">Límite superior del CI Percentil al 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">9794.69</td>
<td align="right">-120.82</td>
<td align="right">273.35</td>
<td align="right">9379.74</td>
<td align="right">10451.27</td>
<td align="right">9355.14</td>
<td align="right">10448.87</td>
<td align="right">9140.51</td>
<td align="right">10234.24</td>
</tr>
<tr class="even">
<td align="right">0.80</td>
<td align="right">12454.18</td>
<td align="right">30.68</td>
<td align="right">481.88</td>
<td align="right">11479.03</td>
<td align="right">13367.96</td>
<td align="right">11490.62</td>
<td align="right">13378.52</td>
<td align="right">11529.84</td>
<td align="right">13417.74</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">14720.05</td>
<td align="right">17.51</td>
<td align="right">718.23</td>
<td align="right">13294.82</td>
<td align="right">16110.25</td>
<td align="right">13255.45</td>
<td align="right">16040.72</td>
<td align="right">13399.38</td>
<td align="right">16184.65</td>
</tr>
<tr class="even">
<td align="right">0.95</td>
<td align="right">17072.43</td>
<td align="right">5.99</td>
<td align="right">1103.14</td>
<td align="right">14904.31</td>
<td align="right">19228.56</td>
<td align="right">14924.50</td>
<td align="right">19100.88</td>
<td align="right">15043.97</td>
<td align="right">19220.36</td>
</tr>
<tr class="odd">
<td align="right">0.98</td>
<td align="right">20140.56</td>
<td align="right">73.43</td>
<td align="right">1587.64</td>
<td align="right">16955.40</td>
<td align="right">23178.85</td>
<td align="right">16942.36</td>
<td align="right">22984.40</td>
<td align="right">17296.71</td>
<td align="right">23338.75</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="S:ParametricBootStrap" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Bootstrap paramétrico</h3>
<p>La idea del bootstrap no paramétrico es remuestrear extrayendo variables independientes a partir de la función de distribución acumulada empirica <span class="math inline">\(F_n\)</span>. Por otra parte, en el bootstrap paramétrico, se extraen variables independientes de <span class="math inline">\(F_{\widehat{\theta}}\)</span> donde la distribución subyacente se asume que pertenece a una familia paramétrica <span class="math inline">\(\mathcal{F}=\{F_{\theta},\theta\in\Theta\}\)</span>. Normalmente, los parámetros de la distribución se estiman en base a una muestra y se denotan como <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Ejemplo 6.2.4. Distribución Lognormal.</strong> Se considera nuevamente la base de datos</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="C-Simulation.html#cb67-1" aria-hidden="true" tabindex="-1"></a>sample_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.46</span>,<span class="fl">2.80</span>,<span class="fl">3.28</span>,<span class="fl">3.86</span>,<span class="fl">2.85</span>,<span class="fl">3.67</span>,<span class="fl">3.37</span>,<span class="fl">3.40</span>,</span>
<span id="cb67-2"><a href="C-Simulation.html#cb67-2" aria-hidden="true" tabindex="-1"></a>              <span class="fl">5.22</span>,<span class="fl">2.55</span>,<span class="fl">2.79</span>,<span class="fl">4.50</span>,<span class="fl">3.37</span>,<span class="fl">2.88</span>,<span class="fl">1.44</span>,<span class="fl">2.56</span>,<span class="fl">2.00</span>,<span class="fl">2.07</span>,<span class="fl">2.19</span>,<span class="fl">1.77</span>)</span></code></pre></div>
<p>El bootstrap clásico (no paramétrico) se basaba en muestras</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="C-Simulation.html#cb68-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Mientras que para el bootstrap paramétrico, se asume que la distribución de <span class="math inline">\(x_i\)</span>’s es de una familia específica, por ejemplo la distribución lognormal.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="C-Simulation.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb69-2"><a href="C-Simulation.html#cb69-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(sample_x, dlnorm, <span class="fu">list</span>(<span class="at">meanlog =</span> <span class="dv">1</span>, <span class="at">sdlog =</span> <span class="dv">1</span>))</span>
<span id="cb69-3"><a href="C-Simulation.html#cb69-3" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>    meanlog       sdlog   
  1.03630697   0.30593440 
 (0.06840901) (0.04837027)</code></pre>
<p>Entonces se realiza la extracción partiendo de esta distribución.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="C-Simulation.html#cb71-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fu">length</span>(sample_x), <span class="at">meanlog=</span>fit<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">sdlog=</span>fit<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<h5 style="text-align: center;">
<a id="displayCode.BootTVar.1" href="javascript:togglecode('toggleCode.BootTVar.1','displayCode.BootTVar.1');"><i><strong>Se muestra el código R para muestras con bootstrap paramétrico</strong></i></a>
</h5>
<div id="toggleCode.BootTVar.1" style="display: none">
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="C-Simulation.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2074</span>)</span>
<span id="cb72-2"><a href="C-Simulation.html#cb72-2" aria-hidden="true" tabindex="-1"></a>CV <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fl">1e5</span>,<span class="dv">2</span>)</span>
<span id="cb72-3"><a href="C-Simulation.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CV)){</span>
<span id="cb72-4"><a href="C-Simulation.html#cb72-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-5"><a href="C-Simulation.html#cb72-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fu">length</span>(sample_x), <span class="at">meanlog=</span>fit<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">sdlog=</span>fit<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb72-6"><a href="C-Simulation.html#cb72-6" aria-hidden="true" tabindex="-1"></a>CV[s,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sd</span>(x1)<span class="sc">/</span><span class="fu">mean</span>(x1),<span class="fu">sd</span>(x2)<span class="sc">/</span><span class="fu">mean</span>(x2))</span>
<span id="cb72-7"><a href="C-Simulation.html#cb72-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>La Figura <a href="C-Simulation.html#fig:CoefVarCompare">6.11</a> compara las distribuciones bootstrap para el coeficiente de variación, una de ellas basada en el enfoque no paramétrico y la otra basada en el enfoque paramétrico, asumiendo una distribución lognormal.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="C-Simulation.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(CV[,<span class="dv">1</span>]),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Coeficiente de variación&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb73-2"><a href="C-Simulation.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(CV[,<span class="dv">2</span>]),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb73-3"><a href="C-Simulation.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">sd</span>(sample_x)<span class="sc">/</span><span class="fu">mean</span>(sample_x),<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb73-4"><a href="C-Simulation.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;nonparametric&quot;</span>,<span class="st">&quot;parametric(LN)&quot;</span>),</span>
<span id="cb73-5"><a href="C-Simulation.html#cb73-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:CoefVarCompare"></span>
<img src="LossDataAnalytics_files/figure-html/CoefVarCompare-1.png" alt="Comparación de las distribuciones Bootstrap no paramétrico y paramétrico para el coeficiente de variación" width="672" />
<p class="caption">
Figure 6.11: Comparación de las distribuciones Bootstrap no paramétrico y paramétrico para el coeficiente de variación
</p>
</div>
<hr />
<p><strong>Ejemplo 6.2.5. Bootstrap de observaciones censuradas.</strong> El bootstrap paramétrico extrae realizaciones simuladas de una estimación paramétrica de una función de distribución. Del mismo modo, se pueden extraer realizaciones simuladas de la estimación de una función de distribución. A modo de ejemplo, se pueden realizar extracciones de estimaciones suavizadas de una función de distribución según lo introducido en la Sección 4.1.1.4. Otro caso especial, considerado aquí, es extraer una estimación del estimador de Kaplan-Meier introducido en la Sección 4.3.2.2. De esta forma, se pueden manejar observaciones que están censuradas.</p>
<p>Concretamente, se consideran nuevamente los datos sobre daños corporales de los Ejemplos 6.2.1 y 6.2.3 pero ahora se incluyen 17 siniestros que están censurados por límites en la póliza. En el Ejemplo 4.3.6, se usó esta base de datos completa para estimar el estimador de Kaplan-Meier de la función de supervivencia introducida en la Sección 4.3.2.2. La <a href="#tab:66">Tabla 6.6</a> presenta las estimaciones bootstrap de los cuantiles obtenidos de la estimación de la función de supervivencia Kaplan-Meier. Incluye las estimaciones de la precisión bootstrap, sesgo y desviación estándar, así como el intervalo de confianza básico al 95%.</p>
<h5 style="text-align: center;">
<a id="displayCode.KMCode.1" href="javascript:togglecode('toggleCode.KMCode.1','displayCode.KMCode.1');"><i><strong>Muestra el código R para las estimaciones Bootstrap Kaplan-Meier</strong></i></a>
</h5>
<div id="toggleCode.KMCode.1" style="display: none">
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="C-Simulation.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb74-2"><a href="C-Simulation.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)                <span class="co"># for Surv(), survfit()</span></span>
<span id="cb74-3"><a href="C-Simulation.html#cb74-3" aria-hidden="true" tabindex="-1"></a>BIData<span class="sc">$</span>UnCensored <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(BIData<span class="sc">$</span>AmountPaid <span class="sc">&lt;</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb74-4"><a href="C-Simulation.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="do">## KM estimate</span></span>
<span id="cb74-5"><a href="C-Simulation.html#cb74-5" aria-hidden="true" tabindex="-1"></a>KM0 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(AmountPaid, UnCensored) <span class="sc">~</span> <span class="dv">1</span>,  </span>
<span id="cb74-6"><a href="C-Simulation.html#cb74-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">type=</span><span class="st">&quot;kaplan-meier&quot;</span>, <span class="at">data=</span>BIData)</span>
<span id="cb74-7"><a href="C-Simulation.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb74-8"><a href="C-Simulation.html#cb74-8" aria-hidden="true" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb74-9"><a href="C-Simulation.html#cb74-9" aria-hidden="true" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb74-10"><a href="C-Simulation.html#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(OutBoot1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fracción&quot;</span>,<span class="st">&quot;Estimación KM NP&quot;</span>, <span class="st">&quot;Sesgo bootstrap&quot;</span>,</span>
<span id="cb74-11"><a href="C-Simulation.html#cb74-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Bootstrap SD&quot;</span>,  <span class="st">&quot;Intervalo inferior del CI básico al 95% &quot;</span>, <span class="st">&quot;Intervalo superior del CI básico al 95% &quot;</span>)</span>
<span id="cb74-12"><a href="C-Simulation.html#cb74-12" aria-hidden="true" tabindex="-1"></a>KM.survobj <span class="ot">&lt;-</span> <span class="fu">Surv</span>(BIData<span class="sc">$</span>AmountPaid, BIData<span class="sc">$</span>UnCensored) </span>
<span id="cb74-13"><a href="C-Simulation.html#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb74-14"><a href="C-Simulation.html#cb74-14" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb74-15"><a href="C-Simulation.html#cb74-15" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bootkm</span>(KM.survobj, <span class="at">q=</span><span class="dv">1</span><span class="sc">-</span>PercentVec[i], <span class="at">B=</span><span class="dv">1000</span>, <span class="at">pr =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-16"><a href="C-Simulation.html#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){bootreal <span class="ot">&lt;-</span> results}</span>
<span id="cb74-17"><a href="C-Simulation.html#cb74-17" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(KM0, PercentVec[i])<span class="sc">$</span>quantile</span>
<span id="cb74-18"><a href="C-Simulation.html#cb74-18" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)<span class="sc">-</span>OutBoot1[i,<span class="dv">2</span>]</span>
<span id="cb74-19"><a href="C-Simulation.html#cb74-19" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results) </span>
<span id="cb74-20"><a href="C-Simulation.html#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co"># temp &lt;- boot.ci(results, type = c(&quot;norm&quot;,  &quot;basic&quot;,&quot;perc&quot;))</span></span>
<span id="cb74-21"><a href="C-Simulation.html#cb74-21" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>OutBoot1[i,<span class="dv">2</span>]<span class="sc">-</span><span class="fu">quantile</span>(results,.<span class="dv">975</span>, <span class="at">type=</span><span class="dv">6</span>)</span>
<span id="cb74-22"><a href="C-Simulation.html#cb74-22" aria-hidden="true" tabindex="-1"></a>OutBoot1[i,<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>OutBoot1[i,<span class="dv">2</span>]<span class="sc">-</span><span class="fu">quantile</span>(results,.<span class="dv">025</span>, <span class="at">type=</span><span class="dv">6</span>)</span>
<span id="cb74-23"><a href="C-Simulation.html#cb74-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:66></a></p>
<div id="tabla-6.6.-estimaciones-bootstrap-kaplan-meier-de-cuantiles-en-fracciones-seleccionadas" class="section level5 unnumbered">
<h5>Tabla 6.6. Estimaciones Bootstrap Kaplan-Meier de cuantiles en fracciones seleccionadas</h5>
<table>
<colgroup>
<col width="6%" />
<col width="12%" />
<col width="11%" />
<col width="9%" />
<col width="29%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Fracción</th>
<th align="right">Estimación KM NP</th>
<th align="right">Sesgo bootstrap</th>
<th align="right">Bootstrap SD</th>
<th align="right">Intervalo inferior del CI básico al 95%</th>
<th align="right">Intervalo superior del CI básico al 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">6500</td>
<td align="right">18.77</td>
<td align="right">177.38</td>
<td align="right">6067</td>
<td align="right">6869</td>
</tr>
<tr class="even">
<td align="right">0.80</td>
<td align="right">9500</td>
<td align="right">167.08</td>
<td align="right">429.59</td>
<td align="right">8355</td>
<td align="right">9949</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">12756</td>
<td align="right">37.73</td>
<td align="right">675.21</td>
<td align="right">10812</td>
<td align="right">13677</td>
</tr>
<tr class="even">
<td align="right">0.95</td>
<td align="right">18500</td>
<td align="right">Inf</td>
<td align="right">NaN</td>
<td align="right">12500</td>
<td align="right">22300</td>
</tr>
<tr class="odd">
<td align="right">0.98</td>
<td align="right">25000</td>
<td align="right">Inf</td>
<td align="right">NaN</td>
<td align="right">-Inf</td>
<td align="right">27308</td>
</tr>
</tbody>
</table>
<p>Los resultados de la <a href="#tab:66">Tabla 6.6</a> son consistentes con los resultados de la submuestra no censurada de la <a href="#tab:64">Tabla 6.4</a>. En la <a href="#tab:66">Tabla 6.6</a>, se observa la dificultad de estimar cuantiles de fracciones grandes debido a la censura. No obstante, para fracciones de tamaños moderados (0.50, 0.80, y 0.90), las estimaciones del Kaplan-Meier no paramétrico (KM NP) del cuantil son consistentes con los resultados de la <a href="#tab:64">Tabla 6.4</a>. La desviación estándar bootstrap es más pequeña al nivel de 0.50 (correspondiente a la mediana) pero mayor para los niveles 0.80 y 0.90. El análisis de los datos censurados resumido en <a href="#tab:66">Tabla 6.6</a> usa más datos que el análisis de la submuestra no censurada que aparece en la <a href="#tab:64">Tabla 6.4</a> pero también presenta dificultades para extraer información para cuantiles elevados.</p>
</div>
</div>
</div>
<div id="S:CrossValidation" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Validación Cruzada</h2>
<p>En esta sección, se muestra como:</p>
<ul>
<li>Comparar y contrastar la validación cruzada a las técnicas de simulación y los métodos bootstrap.</li>
<li>Usar técnicas de validación cruzada para la selección de modelos</li>
<li>Explicar el método jackknife como caso especial de validación cruzada y calcular las estimaciones jackknife del sesgo y de los errores estándar</li>
</ul>
<hr />
<!-- ## Validación cruzada -->
<p>La validación cruzada, brevemente introducida en la Sección 4.2.4, es una técnica basada en simular resultados y por ello es conveniente pensar en su propósito en comparación con otras técnicas de simulación ya introducidas en este capítulo.</p>
<ul>
<li>La simulación, o Monte-Carlo, introducida en la Sección <a href="C-Simulation.html#S:SimulationFundamentals">6.1</a>, permite calcular valores esperados o otras medidas de resumen de distribuciones estadísticas, como <span class="math inline">\(p\)</span>-valores, fácilmente.</li>
<li>El bootstrap, y otros métodos de remuestreo introducidos en la Sección <a href="C-Simulation.html#S:Bootstrap">6.2</a>, proporciona estimadores de la precisión, o variabilidad, de los estadísticos.</li>
<li>La validación cruzada es importante para valorar con qué precisión un modelo predictivo funcionará en la práctica.</li>
</ul>
<p>Existe superposición, pero sin embargo es útil pensar acerca del objetivo general asociado con cada uno de los métodos.</p>
<p>Para presentar la validación cruzada, es conveniente recordar de la Sección 4.2 algunas de las ideas clave de la validación de modelos. Cuando se valora, o valida, un modelo, se mide el funcionamiento o desempeño del modelo en datos <em>nuevos</em>, o al menos no aquéllos que hayan sido usados para ajustar el modelo. Un enfoque clásico, descrito en la Sección 4.2.3, es dividir la muestra en dos partes: una parte (la base de datos de <em>entrenamiento</em>) se usa para ajustar el modelo y la otra (la base de datos de <em>prueba</em>) se usa para validar. Sin embargo, una limitación de este enfoque es que los resultados dependen de la partición; aunque la muestra general sea fija, la partición entre submuestras de entrenamiento y prueba varía aleatoriamente. Una muestra de entrenamiento diferente implica una estimación para los parámetros diferente. Unos parámetros diferentes para el modelo y una muestra de prueba diferente implican unos estadísticos de validación diferentes. Dos analistas pueden usar los mismos datos y los mismos modelos y pueden llegar a conclusiones diferentes sobre la viabilidad de un modelo (basado en diferentes particiones aleatorias), una situación frustrante.</p>
<!-- 
Las técnicas de validación cruzada se usan para evitar la partición básica entre dos partes. Hay que tener en cuenta que aquí se mencionarán dos técnicas: un enfoque exhaustivo, en el que todas las observaciones serán usadas (una vez, y solo una) como una observación de prueba y uno no exhaustivo, basado en técnicas de bootstrap. Ver [Arlot & Celisse (2010)](https://projecteuclid.org/euclid.ssu/1268143839) a modo de resumen.
 -->
<div id="validación-cruzada-k-fold" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Validación cruzada k-fold</h3>
<p>Para mitigar esta dificultad, es común usar un enfoque de validación cruzada como el introducido en la Sección 4.2.4. La idea clave es emular el enfoque básico de entrenamiento/validación para la validación del modelo repitiéndolo muchas veces y tomando medias a partir de las diferentes particiones de los datos. Una ventaja clave es que el estadístico de validación no está ligado a un modelo paramétrico (o no paramétrico) específico – se puede usar un estadístico no paramétrico o un estadístico que tiene una interpretación económica – y puede ser usado para comparar modelos que no están anidados (diferente a como ocurre con los procedimientos de la ratio de verosimilitud).</p>
<p><strong>Ejemplo 6.3.1. Fondo de propiedad de Wisconsin.</strong> Para los datos del fondo de propiedad de 2010 introducido en la Sección 1.3, se ajustan una gamma y una Pareto a los 1,377 datos de siniestros. Para ver en detalle la bondad de ajuste asociada se puede consultar el Apéndice Sección 15.4.4. Ahora se considera el estadístico de Kolmogorov-Smirnov introducido en la Sección 4.1.2.2. Cuando se realiza el ajuste sobre la totalidad de los datos, el estadístico de bondad del ajuste de Kolmogorov-Smirnov para la distribución gamma resulta ser
0.0478 y para la distribución de Pareto es 0.2639. El valor más bajo para la distribución de Pareto indica que esta distribución tiene mejor ajuste que la gamma.</p>
<p>Para ver cómo funciona la validación cruzada k-fold, se divide aleatoriamente los datos en <span class="math inline">\(k=8\)</span> grupos, o folds (en inglés), cada uno con <span class="math inline">\(1377/8 \approx 172\)</span> observaciones. Entonces, se ajustan una gamma y un modelo de Pareto a la base de datos con los primeros siete folds (sobre <span class="math inline">\(172*7 = 1204\)</span> observaciones), se determinan los parámetros estimados, y entonces se usan estos modelos ajustados con los datos restantes para determinar el estadístico de Kolmogorov-Smirnov.</p>
<h5 style="text-align: center;">
<a id="displayCode.KFoldCV.1" href="javascript:togglecode('toggleCode.KFoldCV.1','displayCode.KFoldCV.1');"><i><strong>Muestra el código R para la validación cruzada Kolmogorov-Smirnov</strong></i></a>
</h5>
<div id="toggleCode.KFoldCV.1" style="display: none">
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="C-Simulation.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenación aleatoria de los datos - &quot;shuffle it&quot; en inglés</span></span>
<span id="cb75-2"><a href="C-Simulation.html#cb75-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(claim_data)</span>
<span id="cb75-3"><a href="C-Simulation.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12347</span>)</span>
<span id="cb75-4"><a href="C-Simulation.html#cb75-4" aria-hidden="true" tabindex="-1"></a>cvdata <span class="ot">&lt;-</span> claim_data[<span class="fu">sample</span>(n), ]</span>
<span id="cb75-5"><a href="C-Simulation.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of folds</span></span>
<span id="cb75-6"><a href="C-Simulation.html#cb75-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb75-7"><a href="C-Simulation.html#cb75-7" aria-hidden="true" tabindex="-1"></a>cvalvec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,k)</span>
<span id="cb75-8"><a href="C-Simulation.html#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb75-9"><a href="C-Simulation.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  indices <span class="ot">&lt;-</span> (((i<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">round</span>((<span class="dv">1</span><span class="sc">/</span>k)<span class="sc">*</span><span class="fu">nrow</span>(cvdata))) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>((i<span class="sc">*</span><span class="fu">round</span>((<span class="dv">1</span><span class="sc">/</span>k) <span class="sc">*</span> <span class="fu">nrow</span>(cvdata))))</span>
<span id="cb75-10"><a href="C-Simulation.html#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pareto</span></span>
<span id="cb75-11"><a href="C-Simulation.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  fit.pareto <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">data =</span> cvdata[<span class="sc">-</span>indices,])</span>
<span id="cb75-12"><a href="C-Simulation.html#cb75-12" aria-hidden="true" tabindex="-1"></a>  ksResultPareto <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(cvdata[indices,]<span class="sc">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">2</span>]), </span>
<span id="cb75-13"><a href="C-Simulation.html#cb75-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">1</span>]))</span>
<span id="cb75-14"><a href="C-Simulation.html#cb75-14" aria-hidden="true" tabindex="-1"></a>  cvalvec[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> ksResultPareto<span class="sc">$</span>statistic</span>
<span id="cb75-15"><a href="C-Simulation.html#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma</span></span>
<span id="cb75-16"><a href="C-Simulation.html#cb75-16" aria-hidden="true" tabindex="-1"></a>  fit.gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cvdata[<span class="sc">-</span>indices,], <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> log)) </span>
<span id="cb75-17"><a href="C-Simulation.html#cb75-17" aria-hidden="true" tabindex="-1"></a>  gamma_theta <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.gamma)) <span class="sc">*</span> <span class="fu">gamma.dispersion</span>(fit.gamma)  </span>
<span id="cb75-18"><a href="C-Simulation.html#cb75-18" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb75-19"><a href="C-Simulation.html#cb75-19" aria-hidden="true" tabindex="-1"></a>  ksResultGamma <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(cvdata[indices,]<span class="sc">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape =</span> alpha, <span class="at">scale =</span> gamma_theta)</span>
<span id="cb75-20"><a href="C-Simulation.html#cb75-20" aria-hidden="true" tabindex="-1"></a>  cvalvec[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> ksResultGamma<span class="sc">$</span>statistic</span>
<span id="cb75-21"><a href="C-Simulation.html#cb75-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-22"><a href="C-Simulation.html#cb75-22" aria-hidden="true" tabindex="-1"></a>KScv <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(cvalvec)<span class="sc">/</span>k</span></code></pre></div>
</div>
<p>Los resultados aparecen en la Figura <a href="C-Simulation.html#fig:KScvFig">6.12</a> donde el eje horizontal es Fold=1. Este proceso se repite para los otros siete folds. Los resultados se resumen en la Figura <a href="C-Simulation.html#fig:KScvFig">6.12</a> y se aprecia que la Pareto es una distribución más confiable que la gamma.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="C-Simulation.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Representación de los estadísticos</span></span>
<span id="cb76-2"><a href="C-Simulation.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="dv">1</span><span class="sc">:</span>k,<span class="fu">t</span>(cvalvec),<span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb76-3"><a href="C-Simulation.html#cb76-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">pch =</span> <span class="dv">0</span>, <span class="at">xlab=</span><span class="st">&quot;Fold&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;KS Statistic&quot;</span>)</span>
<span id="cb76-4"><a href="C-Simulation.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;left&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Pareto&quot;</span>, <span class="st">&quot;Gamma&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:KScvFig"></span>
<img src="LossDataAnalytics_files/figure-html/KScvFig-1.png" alt="Estadísticos de Kolmogorov-Smirnov (KS) con validación cruzada para los datos de siniestros del fondo de propiedad. La línea continua negra corresponde a la distribución de Pareto, la línea verde discontinua corresponde a la gamma. El estadístico KS mide la mayor desviación entre la distribución ajustada y la empírica para cada uno de los 8 grupos, o folds, de los datos seleccionados aleatoriamente." width="672" />
<p class="caption">
Figure 6.12: Estadísticos de Kolmogorov-Smirnov (KS) con validación cruzada para los datos de siniestros del fondo de propiedad. La línea continua negra corresponde a la distribución de Pareto, la línea verde discontinua corresponde a la gamma. El estadístico KS mide la mayor desviación entre la distribución ajustada y la empírica para cada uno de los 8 grupos, o folds, de los datos seleccionados aleatoriamente.
</p>
</div>
</div>
<div id="validación-cruzada-dejando-uno-fuera" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Validación cruzada dejando uno fuera</h3>
<p>El caso especial donde <span class="math inline">\(k=n\)</span> es conocido como validación cruzada dejando uno fuera. Este caso tiene importancia históricamente y está muy relacionado con los estadísticos jackknife, un precursor de la técnica bootstrap.</p>
<p>A pesar de que se presenta como un caso especial de validación cruzada, es conveniente dar una definición explícita. Se considera un estadístico genérico <span class="math inline">\(\widehat{\theta}=t(\boldsymbol{x})\)</span> que es un estimador del parámetro de interés <span class="math inline">\(\theta\)</span>. La idea de jackknife es calcular <span class="math inline">\(n\)</span> valores <span class="math inline">\(\widehat{\theta}_{-i}=t(\boldsymbol{x}_{-i})\)</span>, donde <span class="math inline">\(\boldsymbol{x}_{-i}\)</span> es una submuestra de <span class="math inline">\(\boldsymbol{x}\)</span> con el <span class="math inline">\(i\)</span>-ésimo valor eliminado. La media de esos valores se denota como</p>
<p><span class="math display">\[
\overline{\widehat{\theta}}_{(\cdot)}=\frac{1}{n}\sum_{i=1}^n \widehat{\theta}_{-i} .
\]</span>
Esos valores pueden usarse para crear estimaciones del sesgo del estadístico <span class="math inline">\(\widehat{\theta}\)</span></p>
<p><span class="math display" id="eq:Biasjack">\[\begin{equation}
Bias_{jack} = (n-1) \left(\overline{\widehat{\theta}}_{(\cdot)} - \widehat{\theta}\right)
\tag{6.3}
\end{equation}\]</span></p>
<p>así como de una estimación de la desviación estándar</p>
<p><span class="math display" id="eq:sdjack">\[\begin{equation}
s_{jack} =\sqrt{\frac{n-1}{n}\sum_{i=1}^n \left(\widehat{\theta}_{-i} -\overline{\widehat{\theta}}_{(\cdot)}\right)^2} ~.
\tag{6.4}
\end{equation}\]</span></p>
<p><strong>Ejemplo 6.3.2. Coeficiente de variación.</strong> A modo de ilustración, se considera una muestra pequeña ficticia <span class="math inline">\(\boldsymbol{x}=\{x_1,\ldots,x_n\}\)</span> con realizaciones</p>
<pre><code>sample_x &lt;- c(2.46,2.80,3.28,3.86,2.85,3.67,3.37,3.40,
              5.22,2.55,2.79,4.50,3.37,2.88,1.44,2.56,2.00,2.07,2.19,1.77)</code></pre>
<p>Se desea determinar el coeficiente de variación
<span class="math inline">\(\theta = CV = \sqrt{\mathrm{Var~}X}/\mathrm{E~}X\)</span>.</p>
<p>Con esta base de datos, el estimador del coeficiente de variación resulta ser 0.31196. Pero, ¿cómo de fiable es este resultado? Para contestar a esta pregunta, se pueden calcular las estimaciones de jackknife del sesgo y su desviación estándar. El siguiente código muestra el estimador jackknife del sesgo es <span class="math inline">\(Bias_{jack} =\)</span> -0.00627 y la desviación típica jackknife es <span class="math inline">\(s_{jack} =\)</span> 0.01293.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="C-Simulation.html#cb78-1" aria-hidden="true" tabindex="-1"></a>CVar <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb78-2"><a href="C-Simulation.html#cb78-2" aria-hidden="true" tabindex="-1"></a>JackCVar <span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">sqrt</span>(<span class="fu">var</span>(sample_x[<span class="sc">-</span>i]))<span class="sc">/</span><span class="fu">mean</span>(sample_x[<span class="sc">-</span>i])</span>
<span id="cb78-3"><a href="C-Simulation.html#cb78-3" aria-hidden="true" tabindex="-1"></a>JackTheta <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(JackCVar)(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_x))</span>
<span id="cb78-4"><a href="C-Simulation.html#cb78-4" aria-hidden="true" tabindex="-1"></a>BiasJack <span class="ot">&lt;-</span> (<span class="fu">length</span>(sample_x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(JackTheta) <span class="sc">-</span> <span class="fu">CVar</span>(sample_x))</span>
<span id="cb78-5"><a href="C-Simulation.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(JackTheta)</span></code></pre></div>
<hr />
<p><strong>Ejemplo 6.3.3. Siniestros con daños corporales y ratios de eliminación de pérdida.</strong> En el Ejemplo 6.2.1, se mostró como calcular estimaciones bootstrap del sesgo y desviación estándar para la ratio de eliminación de pérdidas usando los datos de siniestros con daños corporales del Ejemplo 4.1.11. Se continúa ahora proporcionando cuantías comparables usando los estadísticos jackknife.</p>
<p><a href="#tab:67">Tabla 6.7</a> resume los resultados de la estimación jackknife. Muestra como la estimación jackknife del sesgo y la desviación estándar de la ratio de eliminación <span class="math inline">\(\mathrm{E}~\min(X,d)/\mathrm{E}~X\)</span> son ampliamente consistentes con la metodología bootstrap. Es más, se pueden usar las desviaciones estándar para construir intervalos de confianza basados en la normal, centrados alrededor del estimador corregido por el sesgo. Por ejemplo, para <span class="math inline">\(d=14000\)</span>, se vio en el Ejemplo 4.1.11 que el estimador no paramétrico de <em>LER</em> es 0.97678. Tiene un sesgo estimado de 0.00010, y resulta un estimador (jackknife) <em>corregido por el sesgo</em> igual a 0.97688. Los intervalos de confianza al 95% se obtienen creando un intervalo de dos veces la longitud de 1.96 desviaciones estándar jackknife, centrado sobre el estimador corregido por el sesgo (1.96 es aproximadamente el cuantil 97.5 de la distribución normal estándar).</p>
<h5 style="text-align: center;">
<a id="displayCode.Jackknife.1" href="javascript:togglecode('toggleCode.Jackknife.1','displayCode.Jackknife.1');"><i><strong>Se muestra el código R</strong></i></a>
</h5>
<div id="toggleCode.Jackknife.1" style="display: none">
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="C-Simulation.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb79-2"><a href="C-Simulation.html#cb79-2" aria-hidden="true" tabindex="-1"></a>BIData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../../Data/DerrigResampling.csv&quot;</span>, <span class="at">header =</span>T)</span>
<span id="cb79-3"><a href="C-Simulation.html#cb79-3" aria-hidden="true" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb79-4"><a href="C-Simulation.html#cb79-4" aria-hidden="true" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb79-5"><a href="C-Simulation.html#cb79-5" aria-hidden="true" tabindex="-1"></a>LER.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(ded, data, indices){</span>
<span id="cb79-6"><a href="C-Simulation.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  resample.data <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb79-7"><a href="C-Simulation.html#cb79-7" aria-hidden="true" tabindex="-1"></a>  sumClaims <span class="ot">&lt;-</span> <span class="fu">sum</span>(resample.data<span class="sc">$</span>AmountPaid)</span>
<span id="cb79-8"><a href="C-Simulation.html#cb79-8" aria-hidden="true" tabindex="-1"></a>  sumClaims_d <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">pmin</span>(resample.data<span class="sc">$</span>AmountPaid,ded))</span>
<span id="cb79-9"><a href="C-Simulation.html#cb79-9" aria-hidden="true" tabindex="-1"></a>  LER <span class="ot">&lt;-</span>   sumClaims_d<span class="sc">/</span>sumClaims</span>
<span id="cb79-10"><a href="C-Simulation.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LER)  </span>
<span id="cb79-11"><a href="C-Simulation.html#cb79-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-12"><a href="C-Simulation.html#cb79-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> BIDataUncensored<span class="sc">$</span>AmountPaid</span>
<span id="cb79-13"><a href="C-Simulation.html#cb79-13" aria-hidden="true" tabindex="-1"></a>LER.jack<span class="ot">&lt;-</span> <span class="cf">function</span>(ded,i){</span>
<span id="cb79-14"><a href="C-Simulation.html#cb79-14" aria-hidden="true" tabindex="-1"></a>  LER <span class="ot">&lt;-</span>   <span class="fu">sum</span>(<span class="fu">pmin</span>(x[<span class="sc">-</span>i],ded))<span class="sc">/</span><span class="fu">sum</span>(x[<span class="sc">-</span>i])</span>
<span id="cb79-15"><a href="C-Simulation.html#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LER)  </span>
<span id="cb79-16"><a href="C-Simulation.html#cb79-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-17"><a href="C-Simulation.html#cb79-17" aria-hidden="true" tabindex="-1"></a>LER <span class="ot">&lt;-</span> <span class="cf">function</span>(ded) <span class="fu">sum</span>(<span class="fu">pmin</span>(x,ded))<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb79-18"><a href="C-Simulation.html#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="do">##Derrig et al</span></span>
<span id="cb79-19"><a href="C-Simulation.html#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb79-20"><a href="C-Simulation.html#cb79-20" aria-hidden="true" tabindex="-1"></a>dVec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>, <span class="dv">10500</span>, <span class="dv">11500</span>, <span class="dv">14000</span>, <span class="dv">18500</span>)</span>
<span id="cb79-21"><a href="C-Simulation.html#cb79-21" aria-hidden="true" tabindex="-1"></a>OutJack <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">length</span>(dVec2),<span class="dv">8</span>)</span>
<span id="cb79-22"><a href="C-Simulation.html#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(OutJack) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>,<span class="st">&quot;Estimación NP&quot;</span>,<span class="st">&quot;Sesgo Bootstrap &quot;</span>, <span class="st">&quot;Bootstrap SD&quot;</span>, <span class="st">&quot;Sesgo Jackknife &quot;</span>, <span class="st">&quot;Jackknife SD&quot;</span>,<span class="st">&quot;Límite inferior del 95% Jackknife CI&quot;</span>, <span class="st">&quot;Límite superior del 95% Jackknife CI&quot;</span>)</span>
<span id="cb79-23"><a href="C-Simulation.html#cb79-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dVec2)) {</span>
<span id="cb79-24"><a href="C-Simulation.html#cb79-24" aria-hidden="true" tabindex="-1"></a>OutJack[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> dVec2[j]</span>
<span id="cb79-25"><a href="C-Simulation.html#cb79-25" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>BIDataUncensored, <span class="at">statistic=</span>LER.boot, <span class="at">R=</span><span class="dv">1000</span>, <span class="at">ded=</span>dVec2[j])</span>
<span id="cb79-26"><a href="C-Simulation.html#cb79-26" aria-hidden="true" tabindex="-1"></a>OutJack[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb79-27"><a href="C-Simulation.html#cb79-27" aria-hidden="true" tabindex="-1"></a>biasboot <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)<span class="sc">-</span>results<span class="sc">$</span>t0 <span class="ot">-&gt;</span> OutJack[j,<span class="dv">3</span>]</span>
<span id="cb79-28"><a href="C-Simulation.html#cb79-28" aria-hidden="true" tabindex="-1"></a>sdboot <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) <span class="ot">-&gt;</span> OutJack[j,<span class="dv">4</span>]</span>
<span id="cb79-29"><a href="C-Simulation.html#cb79-29" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results)</span>
<span id="cb79-30"><a href="C-Simulation.html#cb79-30" aria-hidden="true" tabindex="-1"></a>LER.jack.ded<span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">LER.jack</span>(<span class="at">ded=</span>dVec2[j],i)</span>
<span id="cb79-31"><a href="C-Simulation.html#cb79-31" aria-hidden="true" tabindex="-1"></a>JackTheta.ded <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(LER.jack.ded)(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb79-32"><a href="C-Simulation.html#cb79-32" aria-hidden="true" tabindex="-1"></a>OutJack[j,<span class="dv">5</span>] <span class="ot">&lt;-</span> BiasJack.ded <span class="ot">&lt;-</span> (<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(JackTheta.ded) <span class="sc">-</span> <span class="fu">LER</span>(<span class="at">ded=</span>dVec2[j]))</span>
<span id="cb79-33"><a href="C-Simulation.html#cb79-33" aria-hidden="true" tabindex="-1"></a>OutJack[j,<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(JackTheta.ded)</span>
<span id="cb79-34"><a href="C-Simulation.html#cb79-34" aria-hidden="true" tabindex="-1"></a>OutJack[j,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(JackTheta.ded)<span class="sc">+</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>OutJack[j,<span class="dv">6</span>]</span>
<span id="cb79-35"><a href="C-Simulation.html#cb79-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:67></a></p>
<div id="table-6.7.-estimaciones-jackknife-del-ler-en-las-franquicias-seleccionadas" class="section level5 unnumbered">
<h5>Table 6.7. Estimaciones Jackknife del LER en las franquicias seleccionadas</h5>
<table>
<colgroup>
<col width="3%" />
<col width="9%" />
<col width="11%" />
<col width="8%" />
<col width="11%" />
<col width="8%" />
<col width="24%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">d</th>
<th align="right">Estimación NP</th>
<th align="right">Sesgo Bootstrap</th>
<th align="right">Bootstrap SD</th>
<th align="right">Sesgo Jackknife</th>
<th align="right">Jackknife SD</th>
<th align="right">Límite inferior del 95% Jackknife CI</th>
<th align="right">Límite superior del 95% Jackknife CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4000</td>
<td align="right">0.54113</td>
<td align="right">0.00011</td>
<td align="right">0.01237</td>
<td align="right">0.00031</td>
<td align="right">0.00061</td>
<td align="right">0.53993</td>
<td align="right">0.54233</td>
</tr>
<tr class="even">
<td align="right">5000</td>
<td align="right">0.64960</td>
<td align="right">0.00027</td>
<td align="right">0.01412</td>
<td align="right">0.00033</td>
<td align="right">0.00068</td>
<td align="right">0.64825</td>
<td align="right">0.65094</td>
</tr>
<tr class="odd">
<td align="right">10500</td>
<td align="right">0.93563</td>
<td align="right">0.00004</td>
<td align="right">0.01017</td>
<td align="right">0.00019</td>
<td align="right">0.00053</td>
<td align="right">0.93460</td>
<td align="right">0.93667</td>
</tr>
<tr class="even">
<td align="right">11500</td>
<td align="right">0.95281</td>
<td align="right">-0.00003</td>
<td align="right">0.00941</td>
<td align="right">0.00016</td>
<td align="right">0.00047</td>
<td align="right">0.95189</td>
<td align="right">0.95373</td>
</tr>
<tr class="odd">
<td align="right">14000</td>
<td align="right">0.97678</td>
<td align="right">0.00016</td>
<td align="right">0.00687</td>
<td align="right">0.00010</td>
<td align="right">0.00034</td>
<td align="right">0.97612</td>
<td align="right">0.97745</td>
</tr>
<tr class="even">
<td align="right">18500</td>
<td align="right">0.99382</td>
<td align="right">0.00014</td>
<td align="right">0.00331</td>
<td align="right">0.00003</td>
<td align="right">0.00017</td>
<td align="right">0.99350</td>
<td align="right">0.99415</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Discusión.</strong> Una de las cosas más interesantes sobre el caso especial de validación cruzada dejando uno fuera es la habilidad de replicar estimaciones de manera exacta. Es decir, cuando el tamaño del grupo o fold es solo uno, entonces no hay incertidumbre adicional inducida por la validación cruzada. Esto significa que los analistas pueden replicar de manera exacta el trabajo de otro, lo cual es una importante consideración.</p>
<p>Los estadísticos Jackknife fueron desarrollados para entender la precisión de estimadores, produciendo estimadores de sesgo y desviación estándar en las ecuaciones <a href="C-Simulation.html#eq:Biasjack">(6.3)</a> y <a href="C-Simulation.html#eq:sdjack">(6.4)</a>. Esto tiene que ver con algunas metas que se han asociado con las técnicas de bootstrap, no con métodos de validación cruzada. Esto demuestra como las técnicas estadísticas pueden usarse para alcanzar diferentes metas.</p>
</div>
</div>
<div id="validación-cruzada-y-bootstrap" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Validación cruzada y Bootstrap</h3>
<p>El bootstrap es útil para proporcionar estimadores de la precisión, o variabilidad, de los estadísticos. También puede ser útil para la validación de modelos. El enfoque bootstrap para la validación de modelos es similar al enfoque dejando uno fuera y los procedimientos de validación <em>k</em> fold:</p>
<ul>
<li>Se crea una muestra de bootstrap a través del remuestreo (con reemplazamiento) <span class="math inline">\(n\)</span> índices en <span class="math inline">\(\{1,\cdots,n\}\)</span>. Esta será la <em>muestra de entrenamiento</em>. Se estima el modelo considerado en base a esta muestra.</li>
<li>La muestra de <em>prueba</em>, o <em>muestra de validación</em>, consiste en esas observaciones no seleccionadas para en entrenamiento. Se evalúa el modelo ajustado (basado en los datos de entrenamiento) usando los datos de prueba.</li>
</ul>
<p>Este proceso se repite muchas (digamos <span class="math inline">\(B\)</span>) veces. Se toma la media de los resultados y se selecciona al modelo basado en el estadístico de evaluación promedio.</p>
<p><strong>Ejemplo 6.3.4. Fondo de propiedad de Wisconsin.</strong> Se vuelve a considerar el ejemplo 6.3.1 donde se investiga el ajuste de unas distribuciones gamma y Pareto a los datos del fondo de propiedad. Nuevamente se compara el desempeño predictivo usando el estadístico de Kolmogorov-Smirnov pero esta vez usando el procedimiento bootstrap para partir los datos entre muestra de entrenamiento y prueba. A continuación, se muestra el código ilustrativo.</p>
<h5 style="text-align: center;">
<a id="displayCode.BootstrapValidation.1" href="javascript:togglecode('toggleCode.BootstrapValidation.1','displayCode.BootstrapValidation.1');"><i><strong>Muestra el código R para procedimientos de validación Bootstrap</strong></i></a>
</h5>
<div id="toggleCode.BootstrapValidation.1" style="display: none">
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="C-Simulation.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(MASS)</span></span>
<span id="cb80-2"><a href="C-Simulation.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(VGAM)</span></span>
<span id="cb80-3"><a href="C-Simulation.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(goftest)</span></span>
<span id="cb80-4"><a href="C-Simulation.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># claim_lev &lt;- read.csv(&quot;../../Data/CLAIMLEVEL.csv&quot;, header = TRUE) </span></span>
<span id="cb80-5"><a href="C-Simulation.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # 2010 subset </span></span>
<span id="cb80-6"><a href="C-Simulation.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># claim_data &lt;- subset(claim_lev, Year == 2010); </span></span>
<span id="cb80-7"><a href="C-Simulation.html#cb80-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(claim_data)</span>
<span id="cb80-8"><a href="C-Simulation.html#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12347</span>)</span>
<span id="cb80-9"><a href="C-Simulation.html#cb80-9" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb80-10"><a href="C-Simulation.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Número de muestras Bootstrap </span></span>
<span id="cb80-11"><a href="C-Simulation.html#cb80-11" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb80-12"><a href="C-Simulation.html#cb80-12" aria-hidden="true" tabindex="-1"></a>cvalvec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,B)</span>
<span id="cb80-13"><a href="C-Simulation.html#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb80-14"><a href="C-Simulation.html#cb80-14" aria-hidden="true" tabindex="-1"></a>  bootindex <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(indices, <span class="at">size=</span>n, <span class="at">replace=</span> <span class="cn">TRUE</span>))</span>
<span id="cb80-15"><a href="C-Simulation.html#cb80-15" aria-hidden="true" tabindex="-1"></a>  traindata <span class="ot">&lt;-</span> claim_data[bootindex,]</span>
<span id="cb80-16"><a href="C-Simulation.html#cb80-16" aria-hidden="true" tabindex="-1"></a>  testdata  <span class="ot">&lt;-</span> claim_data[<span class="sc">-</span>bootindex,]</span>
<span id="cb80-17"><a href="C-Simulation.html#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Pareto</span></span>
<span id="cb80-18"><a href="C-Simulation.html#cb80-18" aria-hidden="true" tabindex="-1"></a>  fit.pareto <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">data =</span> traindata)</span>
<span id="cb80-19"><a href="C-Simulation.html#cb80-19" aria-hidden="true" tabindex="-1"></a>  ksResultPareto <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(testdata<span class="sc">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">2</span>]), </span>
<span id="cb80-20"><a href="C-Simulation.html#cb80-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">1</span>]))</span>
<span id="cb80-21"><a href="C-Simulation.html#cb80-21" aria-hidden="true" tabindex="-1"></a>  cvalvec[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> ksResultPareto<span class="sc">$</span>statistic</span>
<span id="cb80-22"><a href="C-Simulation.html#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma</span></span>
<span id="cb80-23"><a href="C-Simulation.html#cb80-23" aria-hidden="true" tabindex="-1"></a>  fit.gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> traindata, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> log)) </span>
<span id="cb80-24"><a href="C-Simulation.html#cb80-24" aria-hidden="true" tabindex="-1"></a>  gamma_theta <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.gamma)) <span class="sc">*</span> <span class="fu">gamma.dispersion</span>(fit.gamma)  </span>
<span id="cb80-25"><a href="C-Simulation.html#cb80-25" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb80-26"><a href="C-Simulation.html#cb80-26" aria-hidden="true" tabindex="-1"></a>  ksResultGamma <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(testdata<span class="sc">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape =</span> alpha, <span class="at">scale =</span> gamma_theta)</span>
<span id="cb80-27"><a href="C-Simulation.html#cb80-27" aria-hidden="true" tabindex="-1"></a>  cvalvec[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> ksResultGamma<span class="sc">$</span>statistic</span>
<span id="cb80-28"><a href="C-Simulation.html#cb80-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-29"><a href="C-Simulation.html#cb80-29" aria-hidden="true" tabindex="-1"></a>KSBoot <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(cvalvec)<span class="sc">/</span>B</span></code></pre></div>
</div>
<p>Se ha realizado el muestreo usando <span class="math inline">\(B=\)</span> 100 réplicas. El estadístico <em>KS</em> promedio de la distribución Pareto era 0.058, que puede compararse con el promedio para la distribución gamma, 0.262. Esto es consistente con los resultados anteriores y proporciona una evidencia más de que el modelo Pareto es mejor para estos datos que el gamma.</p>
</div>
</div>
<div id="S:ImportanceSampling" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Importance Sampling</h2>
<!-- ## Importancia del muestreo -->
<p>En la Sección <a href="C-Simulation.html#S:SimulationFundamentals">6.1</a> se introducen las técnicas de Monte Carlo usando la técnica de la inversa: generar una variable aleatoria <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(F\)</span>, aplicar <span class="math inline">\(F^{-1}\)</span> para llamar a un generador aleatorio (uniforme en el intervalo unitario). ¿Qué pasa si queremos realizar extracciones de acuerdo con <span class="math inline">\(X\)</span>, condicionado a <span class="math inline">\(X\in[a,b]\)</span> ?</p>
<p>Se puede usar un mecanismo de aceptación-rechazo : extraer <span class="math inline">\(x\)</span> de la distribución <span class="math inline">\(F\)</span></p>
<ul>
<li>si <span class="math inline">\(x\in[a,b]\)</span> : se mantiene (“<em>aceptación</em>”)</li>
<li>si <span class="math inline">\(x\notin[a,b]\)</span> : se extrae otro (“<em>rechazo</em>”)</li>
</ul>
<p>Se observa que de <span class="math inline">\(n\)</span> valores inicialmente generados, se mantienen sólo <span class="math inline">\([F(b)-F(a)]\cdot n\)</span> extracciones, en promedio.</p>
<p><strong>Ejemplo 6.4.1. Extracciones de una distribución Normal.</strong><br />
Supongamos que se realizan extracciones de una distribución normal con media 2.5 y varianza 1, <span class="math inline">\(N(2.5,1)\)</span>, pero sólo se tiene interés en extracciones en extracciones mayores que <span class="math inline">\(a \ge 2\)</span> y menores que <span class="math inline">\(b \le 4\)</span>. Es decir, se puede usar sólo una proporción de extracciones igual a <span class="math inline">\(F(4)-F(2) = \Phi(4-2.5)-\Phi(2-2.5)\)</span> = 0.9332 - 0.3085 = 0.6247. La Figura <a href="C-Simulation.html#fig:sampleani1">6.13</a> demuestra que algunas extracciones caen en el intervalo <span class="math inline">\((2,4)\)</span> y otras están fuera.</p>
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.1" href="javascript:togglecode('toggleCode.ImportanceSampling.1','displayCode.ImportanceSampling.1');"><i><strong>Muestra el código R para el mecanismo de aceptación-rechazo</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.1" style="display: none">
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="C-Simulation.html#cb81-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">2.5</span></span>
<span id="cb81-2"><a href="C-Simulation.html#cb81-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb81-3"><a href="C-Simulation.html#cb81-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb81-4"><a href="C-Simulation.html#cb81-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb81-5"><a href="C-Simulation.html#cb81-5" aria-hidden="true" tabindex="-1"></a>Fa <span class="ot">=</span> <span class="fu">pnorm</span>(a,mu,sigma)</span>
<span id="cb81-6"><a href="C-Simulation.html#cb81-6" aria-hidden="true" tabindex="-1"></a>Fb <span class="ot">=</span> <span class="fu">pnorm</span>(b,mu,sigma)</span>
<span id="cb81-7"><a href="C-Simulation.html#cb81-7" aria-hidden="true" tabindex="-1"></a>pic_ani <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb81-8"><a href="C-Simulation.html#cb81-8" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb81-9"><a href="C-Simulation.html#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb81-10"><a href="C-Simulation.html#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>),<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb81-11"><a href="C-Simulation.html#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(a,Fa,b,Fb,<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb81-12"><a href="C-Simulation.html#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb81-13"><a href="C-Simulation.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(a,b),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb81-14"><a href="C-Simulation.html#cb81-14" aria-hidden="true" tabindex="-1"></a>  ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb81-15"><a href="C-Simulation.html#cb81-15" aria-hidden="true" tabindex="-1"></a>  clr <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb81-16"><a href="C-Simulation.html#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((<span class="fu">qnorm</span>(ru,mu,sigma)<span class="sc">&gt;=</span>a)<span class="sc">&amp;</span>(<span class="fu">qnorm</span>(ru,mu,sigma)<span class="sc">&lt;=</span>b)) clr <span class="ot">&lt;-</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb81-17"><a href="C-Simulation.html#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>,ru,<span class="fu">qnorm</span>(ru,mu,sigma),ru,<span class="at">col=</span>clr,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb81-18"><a href="C-Simulation.html#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="fu">qnorm</span>(ru,mu,sigma),ru,<span class="fu">qnorm</span>(ru,mu,sigma),<span class="dv">0</span>,<span class="at">col=</span>clr,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">length =</span> .<span class="dv">1</span>)</span>
<span id="cb81-19"><a href="C-Simulation.html#cb81-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="C-Simulation.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numAnimation) {<span class="fu">pic_ani</span>()}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:sampleani1"></span>
<img src="LossDataAnalytics_files/figure-html/sampleani1-.gif" alt="Demostración animada de extracciones dentro y fuera de (2,4)" width="50%" />
<p class="caption">
Figure 6.13: Demostración animada de extracciones dentro y fuera de (2,4)
</p>
</div>
<hr />
<p>En su lugar, se pueden realizar extracciones de acuerdo con la distribución condicional <span class="math inline">\(F^{\star}\)</span> definida como</p>
<p><span class="math display">\[
F^{\star}(x) = \Pr(X \le x | a &lt; X \le b) =\frac{F(x)-F(a)}{F(b)-F(a)}, \ \  \ \text{for } a &lt; x \le b .
\]</span>
Usando el método de la transformada inversa de la Sección <a href="C-Simulation.html#S:InverseTransform">6.1.2</a>, se tiene que la extracción</p>
<p><span class="math display">\[
X^\star=F^{\star-1}\left( U \right) = F^{-1}\left(F(a)+U\cdot[F(b)-F(a)]\right)
\]</span>
tiene distribución <span class="math inline">\(F^{\star}\)</span>. Expresado de otra forma, se define</p>
<p><span class="math display">\[
\tilde{U} = (1-U)\cdot F(a)+U\cdot F(b)
\]</span>
y entonces se usa <span class="math inline">\(F^{-1}(\tilde{U})\)</span>. Con este enfoque, cada extracción cuenta.</p>
<p>Esto puede estar relacionado con la importancia del mecanismo de muestreo : se realizan extracciones más frecuentemente en regiones donde se espera tener cantidades que tienen algún interés. Esta transformación puede ser considerada como “un cambio de medida.”</p>
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.2" href="javascript:togglecode('toggleCode.ImportanceSampling.2','displayCode.ImportanceSampling.2');"><i><strong>Muestra el código R para la importancia del muestreo por el método de la transformada inversa</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.2" style="display: none">
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="C-Simulation.html#cb83-1" aria-hidden="true" tabindex="-1"></a>pic_ani <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb83-2"><a href="C-Simulation.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb83-3"><a href="C-Simulation.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb83-4"><a href="C-Simulation.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>),<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb83-5"><a href="C-Simulation.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(a,Fa,b,Fb,<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb83-6"><a href="C-Simulation.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb83-7"><a href="C-Simulation.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fu">pnorm</span>(<span class="fu">c</span>(a,b),mu,sigma),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb83-8"><a href="C-Simulation.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb83-9"><a href="C-Simulation.html#cb83-9" aria-hidden="true" tabindex="-1"></a>  rutilde <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>ru)<span class="sc">*</span>Fa<span class="sc">+</span>ru<span class="sc">*</span>Fb</span>
<span id="cb83-10"><a href="C-Simulation.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>,rutilde,<span class="fu">qnorm</span>(rutilde,mu,sigma),rutilde,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb83-11"><a href="C-Simulation.html#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="fu">qnorm</span>(rutilde,mu,sigma),rutilde,<span class="fu">qnorm</span>(rutilde,mu,sigma),<span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">length =</span> .<span class="dv">1</span>)</span>
<span id="cb83-12"><a href="C-Simulation.html#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="C-Simulation.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numAnimation) {<span class="fu">pic_ani</span>()}</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/sampleani_IS_2-.gif" width="50%" style="display: block; margin: auto;" /></p>
<p>En el Ejemplo 6.4.1., la inversa de la distribución normal está disponible fácilmente (en <code>R</code>, la función es <code>qnorm</code>). Sin embargo, para otras aplicaciones, este no es el caso. Entonces, simplemente se usan métodos numéricos para determinar <span class="math inline">\(X^\star\)</span> como la solución de la ecuación <span class="math inline">\(F(X^\star) =\tilde{U}\)</span> donde <span class="math inline">\(\tilde{U}=(1-U)\cdot F(a)+U\cdot F(b)\)</span>. Véase el siguiente código ilustrativo.</p>
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.3" href="javascript:togglecode('toggleCode.ImportanceSampling.3','displayCode.ImportanceSampling.3');"><i><strong>Muestra el código R para la importancia del muestreo via soluciones numéricas</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.3" style="display: none">
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="C-Simulation.html#cb85-1" aria-hidden="true" tabindex="-1"></a>pic_ani <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb85-2"><a href="C-Simulation.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb85-3"><a href="C-Simulation.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb85-4"><a href="C-Simulation.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>),<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb85-5"><a href="C-Simulation.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb85-6"><a href="C-Simulation.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(u,<span class="fu">pnorm</span>(u,mu,sigma),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb85-7"><a href="C-Simulation.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  pnormstar <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x){</span>
<span id="cb85-8"><a href="C-Simulation.html#cb85-8" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span>(<span class="fu">pnorm</span>(x,mu,sigma)<span class="sc">-</span>Fa)<span class="sc">/</span>(Fb<span class="sc">-</span>Fa)</span>
<span id="cb85-9"><a href="C-Simulation.html#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">&lt;=</span>a) y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-10"><a href="C-Simulation.html#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">&gt;=</span>b) y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-11"><a href="C-Simulation.html#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb85-12"><a href="C-Simulation.html#cb85-12" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb85-13"><a href="C-Simulation.html#cb85-13" aria-hidden="true" tabindex="-1"></a>  qnormstar <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">as.numeric</span>(<span class="fu">uniroot</span>((<span class="cf">function</span> (x) <span class="fu">pnormstar</span>(x) <span class="sc">-</span> u), <span class="at">lower =</span> <span class="dv">2</span>, <span class="at">upper =</span> <span class="dv">4</span>)[<span class="dv">1</span>])</span>
<span id="cb85-14"><a href="C-Simulation.html#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(u,<span class="fu">pnormstar</span>(u),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb85-15"><a href="C-Simulation.html#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb85-16"><a href="C-Simulation.html#cb85-16" aria-hidden="true" tabindex="-1"></a>  ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb85-17"><a href="C-Simulation.html#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>,ru,<span class="fu">qnormstar</span>(ru),ru,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb85-18"><a href="C-Simulation.html#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="fu">qnormstar</span>(ru),ru,<span class="fu">qnormstar</span>(ru),<span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">length =</span> .<span class="dv">1</span>)</span>
<span id="cb85-19"><a href="C-Simulation.html#cb85-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="C-Simulation.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numAnimation) {<span class="fu">pic_ani</span>()}</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/sampleani_IS_1-.gif" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="S:MCMC" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Monte Carlo Markov Chain (MCMC)</h2>
<hr />
<p><strong>Esta sección se está escribiendo y no está complete ni editada. El contenido que se muestra es para haceros una idea de lo que contendrá la versión final.</strong></p>
<hr />
<!-- ## MCMC -->
<p>La idea de las técnicas de Monte Carlo se basa en la ley de los grandes números (que asegura la convergencia de la media hacia la integral) y el teorema central del límite (que se usa para cuantificar la incertidumbre en los cálculos). Es necesario recordar que si <span class="math inline">\((X_i)\)</span> es una secuencia i.id. de variables aleatorias con distribución <span class="math inline">\(F\)</span>, entonces</p>
<p><span class="math display">\[
\frac{1}{\sqrt{n}}\left(\sum_{i=1}^n h(X_i)-\int h(x)dF(x)\right)\overset{\mathcal{L}}{\rightarrow }\mathcal{N}(0,\sigma^2),\text{ as }n\rightarrow\infty.
\]</span>
para alguna varianza <span class="math inline">\(\sigma^2&gt;0\)</span>. Pero de hecho, el teorema ergódico se puede usar para rebajar el resultado anterior, dado que no es neceario tener independencia de las variables. Más concretamente, si <span class="math inline">\((X_i)\)</span> es un proceso de Markov con medida invariante <span class="math inline">\(\mu\)</span>, bajo algunos supuestos técnicos adicionales, se puede obtener que</p>
<p><span class="math display">\[
\frac{1}{\sqrt{n}}\left(\sum_{i=1}^n h(X_i)-\int h(x)d\mu(x)\right)\overset{\mathcal{L}}{\rightarrow }\mathcal{N}(0,\sigma_\star^2),\text{ as }n\rightarrow\infty.
\]</span>
para alguna varianza <span class="math inline">\(\sigma_\star^2&gt;0\)</span>.</p>
<p>Por lo tanto, de esta propiedad, se puede ver que es posible no necesariamente generar valores independientes a partir de <span class="math inline">\(F\)</span>, sino también generar un proceso de markov con medida invariante <span class="math inline">\(F\)</span>, y considerar medias sobre el proceso (no necesariamente independiente).
Se considera el caso de un vector Gausiano restringido: se desean generar parejas aleatorias de un vector aleatorio <span class="math inline">\(\boldsymbol{X}\)</span>, pero sólo interesa el caso en que la suma de los (‘composants’)` es suficientemente grande, lo que puede expresarse como <span class="math inline">\(\boldsymbol{X}^T\boldsymbol{1}&gt; m\)</span> para algún valor real <span class="math inline">\(m\)</span>. Por supuesto, es posible usar el algoritmo <em>aceptación-rechazo</em>, pero se ha vito que puede ser bastante ineficiente. Se puede usar el Hastings Metropolis y el muestreo de Gibbs para generar un proceso de Markov con esta medida invariante.</p>
<div id="hastings-metropolis" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Hastings Metropolis</h3>
<p>El algoritmo es bastante simple de generar a partir de <span class="math inline">\(f\)</span>: se comienza con un valor factible <span class="math inline">\(x_1\)</span>. Entonces, en el paso <span class="math inline">\(t\)</span>, se necesita especificar una transición núcleo: dado <span class="math inline">\(x_t\)</span>, se necesita la distribución condicional de <span class="math inline">\(X_{t+1}\)</span> dado <span class="math inline">\(x_t\)</span>. El algoritmo funcionará bien si la distribución condicional se puede simular fácilmente. Sea <span class="math inline">\(\pi(\cdot|x_t)\)</span> esta probabilidad.
Se obtiene un valor potencial <span class="math inline">\(x_{t+1}^\star\)</span>, y <span class="math inline">\(u\)</span>, de una distribución uniforme. Se calcula</p>
<p><span class="math display">\[
R=  \frac{f(x_{t+1}^\star)}{f(x_t)}
\]</span>
y</p>
<ul>
<li>si <span class="math inline">\(u &lt; r\)</span>, entonces <span class="math inline">\(x_{t+1}=x_t^\star\)</span></li>
<li>si <span class="math inline">\(u\leq r\)</span>, entonces <span class="math inline">\(x_{t+1}=x_t\)</span></li>
</ul>
<p>Aquí <span class="math inline">\(r\)</span> se denomina ratio-<em>aceptación</em>: se acepta el nuevo valor con probabilidad <span class="math inline">\(r\)</span> (o en realidad el menor entre <span class="math inline">\(1\)</span> y <span class="math inline">\(r\)</span> dado que <span class="math inline">\(r\)</span> puede exceder <span class="math inline">\(1\)</span>).</p>
<p>Por ejemplo, se asume que <span class="math inline">\(f(\cdot|x_t)\)</span> es uniforme en <span class="math inline">\([x_t-\varepsilon,x_t+\varepsilon]\)</span> para algún <span class="math inline">\(\varepsilon&gt;0\)</span>, y donde <span class="math inline">\(f\)</span> (la distribución objetivo) es la <span class="math inline">\(\mathcal{N}(0,1)\)</span>. Nunca se realizarán <em>extracciones</em> de <span class="math inline">\(f\)</span>, pero se usará para calcular la ratio de aceptación en cada paso.</p>
<h5 style="text-align: center;">
<a id="displayCode.MCMC.1" href="javascript:togglecode('toggleCode.MCMC.1','displayCode.MCMC.1');"><i><strong>Se muestra el código R</strong></i></a>
</h5>
<div id="toggleCode.MCMC.1" style="display: none">
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="C-Simulation.html#cb87-1" aria-hidden="true" tabindex="-1"></a>metrop1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">eps=</span><span class="fl">0.5</span>){</span>
<span id="cb87-2"><a href="C-Simulation.html#cb87-2" aria-hidden="true" tabindex="-1"></a> vec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n, <span class="dv">3</span>)</span>
<span id="cb87-3"><a href="C-Simulation.html#cb87-3" aria-hidden="true" tabindex="-1"></a> x<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb87-4"><a href="C-Simulation.html#cb87-4" aria-hidden="true" tabindex="-1"></a> vec[<span class="dv">1</span>] <span class="ot">&lt;-</span> x</span>
<span id="cb87-5"><a href="C-Simulation.html#cb87-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb87-6"><a href="C-Simulation.html#cb87-6" aria-hidden="true" tabindex="-1"></a> innov <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span>eps,eps)</span>
<span id="cb87-7"><a href="C-Simulation.html#cb87-7" aria-hidden="true" tabindex="-1"></a> mov <span class="ot">&lt;-</span> x<span class="sc">+</span>innov</span>
<span id="cb87-8"><a href="C-Simulation.html#cb87-8" aria-hidden="true" tabindex="-1"></a> R <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>,<span class="fu">dnorm</span>(mov)<span class="sc">/</span><span class="fu">dnorm</span>(x))</span>
<span id="cb87-9"><a href="C-Simulation.html#cb87-9" aria-hidden="true" tabindex="-1"></a> u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb87-10"><a href="C-Simulation.html#cb87-10" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (u <span class="sc">&lt;</span> R) x <span class="ot">&lt;-</span> mov</span>
<span id="cb87-11"><a href="C-Simulation.html#cb87-11" aria-hidden="true" tabindex="-1"></a> vec[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(x,mov,R)</span>
<span id="cb87-12"><a href="C-Simulation.html#cb87-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb87-13"><a href="C-Simulation.html#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(vec)}</span></code></pre></div>
</div>
<p>En el código de arriba, <code>vec</code> contiene los valores de <span class="math inline">\(\boldsymbol{x}=(x_1,x_2,\cdots)\)</span>, <code>innov</code> es la innovación.</p>
<h5 style="text-align: center;">
<a id="displayCode.MCMC.2" href="javascript:togglecode('toggleCode.MCMC.2','displayCode.MCMC.2');"><i><strong>Se muestra el código R</strong></i></a>
</h5>
<div id="toggleCode.MCMC.2" style="display: none">
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="C-Simulation.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;gifski&#39;)</span></span>
<span id="cb88-2"><a href="C-Simulation.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if (packageVersion(&#39;knitr&#39;) &lt; &#39;1.20.14&#39;) {</span></span>
<span id="cb88-3"><a href="C-Simulation.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  remotes::install_github(&#39;yihui/knitr&#39;)</span></span>
<span id="cb88-4"><a href="C-Simulation.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb88-5"><a href="C-Simulation.html#cb88-5" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">metrop1</span>(<span class="dv">25</span>)</span>
<span id="cb88-6"><a href="C-Simulation.html#cb88-6" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb88-7"><a href="C-Simulation.html#cb88-7" aria-hidden="true" tabindex="-1"></a>pic_ani <span class="ot">=</span> <span class="cf">function</span>(k){</span>
<span id="cb88-8"><a href="C-Simulation.html#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>k,vec[<span class="dv">1</span><span class="sc">:</span>k,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">19</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb88-9"><a href="C-Simulation.html#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">==</span>vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>]) <span class="fu">points</span>(k<span class="sc">+</span><span class="dv">1</span>,vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>],<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb88-10"><a href="C-Simulation.html#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">!=</span>vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>]) <span class="fu">points</span>(k<span class="sc">+</span><span class="dv">1</span>,vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb88-11"><a href="C-Simulation.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(k<span class="sc">+</span><span class="dv">1</span>,vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>],<span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb88-12"><a href="C-Simulation.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrows</span>(k<span class="sc">+</span><span class="dv">1</span>,vec[k,<span class="dv">1</span>]<span class="sc">-</span>.<span class="dv">5</span>,k<span class="sc">+</span><span class="dv">1</span>,vec[k,<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">angle=</span><span class="dv">90</span>,<span class="at">code =</span> <span class="dv">3</span>,<span class="at">length=</span>.<span class="dv">1</span>)</span>
<span id="cb88-13"><a href="C-Simulation.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(k<span class="sc">+</span><span class="fu">dnorm</span>(u)<span class="sc">*</span><span class="dv">10</span>,<span class="fu">rep</span>(k,<span class="fu">length</span>(u))),<span class="fu">c</span>(u,<span class="fu">rev</span>(u)),<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">3</span>),</span>
<span id="cb88-14"><a href="C-Simulation.html#cb88-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">border=</span><span class="cn">NA</span>)  </span>
<span id="cb88-15"><a href="C-Simulation.html#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(k,vec[k,<span class="dv">1</span>],k<span class="sc">+</span><span class="fu">dnorm</span>(vec[k,<span class="dv">1</span>])<span class="sc">*</span><span class="dv">10</span>,vec[k,<span class="dv">1</span>])</span>
<span id="cb88-16"><a href="C-Simulation.html#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(k,vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>],k<span class="sc">+</span><span class="fu">dnorm</span>(vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">10</span>,vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb88-17"><a href="C-Simulation.html#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(k,<span class="dv">2</span>,<span class="fu">round</span>(vec[k<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span>],<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb88-18"><a href="C-Simulation.html#cb88-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="C-Simulation.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">23</span>) {<span class="fu">pic_ani</span>(k)}</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/sampleani_HM_1-.gif" width="672" /></p>
<p>Ahora, si se usan más simulaciones, se obtiene</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="C-Simulation.html#cb90-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">metrop1</span>(<span class="dv">10000</span>)</span>
<span id="cb90-2"><a href="C-Simulation.html#cb90-2" aria-hidden="true" tabindex="-1"></a>simx <span class="ot">&lt;-</span> vec[<span class="dv">1000</span><span class="sc">:</span><span class="dv">10000</span>,<span class="dv">1</span>]</span>
<span id="cb90-3"><a href="C-Simulation.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb90-4"><a href="C-Simulation.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simx,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb90-5"><a href="C-Simulation.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simx,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;light blue&quot;</span>,<span class="at">border=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb90-6"><a href="C-Simulation.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(u,<span class="fu">dnorm</span>(u),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb90-7"><a href="C-Simulation.html#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(simx)</span>
<span id="cb90-8"><a href="C-Simulation.html#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(simx,<span class="at">lag=</span><span class="dv">100</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;light blue&quot;</span>)</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
</div>
<div id="muestreo-de-gibbs" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Muestreo de Gibbs</h3>
<p>Se considera algún vector <span class="math inline">\(\boldsymbol{X}=(X_1,\cdots,X_d)\)</span> con components independientes, <span class="math inline">\(X_i\sim\mathcal{E}(\lambda_i)\)</span>. Se realiza un muestro para muestrear de <span class="math inline">\(\boldsymbol{X}\)</span> dado <span class="math inline">\(\boldsymbol{X}^T\boldsymbol{1}&gt;s\)</span> para algún umbral <span class="math inline">\(s&gt;0\)</span>.</p>
<ul>
<li>se comienza con algún valor inicial <span class="math inline">\(\boldsymbol{x}_0\)</span> tal que</li>
<li>se elige (aleatoriamente) <span class="math inline">\(i\in\{1,\cdots,d\}\)</span></li>
<li><span class="math inline">\(X_i\)</span> dado que <span class="math inline">\(X_i &gt; s-\boldsymbol{x}_{(-i)}^T\boldsymbol{1}\)</span> tiene una distribucion Exponencial <span class="math inline">\(\mathcal{E}(\lambda_i)\)</span></li>
<li>se extrae <span class="math inline">\(Y\sim \mathcal{E}(\lambda_i)\)</span> y se establece <span class="math inline">\(x_i=y +(s-\boldsymbol{x}_{(-i)}^T\boldsymbol{1})_+\)</span> hasta que
<span class="math inline">\(\boldsymbol{x}_{(-i)}^T\boldsymbol{1}+x_i&gt;s\)</span></li>
</ul>
<h5 style="text-align: center;">
<a id="displayCode.Gibbs.1" href="javascript:togglecode('toggleCode.Gibbs.1','displayCode.Gibbs.1');"><i><strong>Se muestra el Código R</strong></i></a>
</h5>
<div id="toggleCode.Gibbs.1" style="display: none">
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="C-Simulation.html#cb91-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb91-2"><a href="C-Simulation.html#cb91-2" aria-hidden="true" tabindex="-1"></a> lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb91-3"><a href="C-Simulation.html#cb91-3" aria-hidden="true" tabindex="-1"></a> X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb91-4"><a href="C-Simulation.html#cb91-4" aria-hidden="true" tabindex="-1"></a> s <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb91-5"><a href="C-Simulation.html#cb91-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb91-6"><a href="C-Simulation.html#cb91-6" aria-hidden="true" tabindex="-1"></a> i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb91-7"><a href="C-Simulation.html#cb91-7" aria-hidden="true" tabindex="-1"></a> X[i] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>,lambda[i])<span class="sc">+</span><span class="fu">max</span>(<span class="dv">0</span>,s<span class="sc">-</span><span class="fu">sum</span>(X[<span class="sc">-</span>i]))</span>
<span id="cb91-8"><a href="C-Simulation.html#cb91-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span>(<span class="fu">sum</span>(X)<span class="sc">&lt;</span>s){</span>
<span id="cb91-9"><a href="C-Simulation.html#cb91-9" aria-hidden="true" tabindex="-1"></a> X[i] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>,lambda[i])<span class="sc">+</span><span class="fu">max</span>(<span class="dv">0</span>,s<span class="sc">-</span><span class="fu">sum</span>(X[<span class="sc">-</span>i])) }</span>
<span id="cb91-10"><a href="C-Simulation.html#cb91-10" aria-hidden="true" tabindex="-1"></a> sim <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim,X) }</span></code></pre></div>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="C-Simulation.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">11</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.3</span>))</span>
<span id="cb92-2"><a href="C-Simulation.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">density=</span><span class="dv">15</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb92-3"><a href="C-Simulation.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<p>La construcción de la secuencia (los algoritmos MCMC son iterativos) puede visualizarse abajo</p>
<h5 style="text-align: center;">
<a id="displayCode.Gibbs.2" href="javascript:togglecode('toggleCode.Gibbs.2','displayCode.Gibbs.2');"><i><strong>Se muestra el código R</strong></i></a>
</h5>
<div id="toggleCode.Gibbs.2" style="display: none">
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="C-Simulation.html#cb93-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb93-2"><a href="C-Simulation.html#cb93-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb93-3"><a href="C-Simulation.html#cb93-3" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> X</span>
<span id="cb93-4"><a href="C-Simulation.html#cb93-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb93-5"><a href="C-Simulation.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb93-6"><a href="C-Simulation.html#cb93-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">set.seed</span>(k)</span>
<span id="cb93-7"><a href="C-Simulation.html#cb93-7" aria-hidden="true" tabindex="-1"></a> i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb93-8"><a href="C-Simulation.html#cb93-8" aria-hidden="true" tabindex="-1"></a> X[i] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>,lambda[i])<span class="sc">+</span><span class="fu">max</span>(<span class="dv">0</span>,s<span class="sc">-</span><span class="fu">sum</span>(X[<span class="sc">-</span>i]))</span>
<span id="cb93-9"><a href="C-Simulation.html#cb93-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span>(<span class="fu">sum</span>(X)<span class="sc">&lt;</span>s){</span>
<span id="cb93-10"><a href="C-Simulation.html#cb93-10" aria-hidden="true" tabindex="-1"></a> X[i] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>,lambda[i])<span class="sc">+</span><span class="fu">max</span>(<span class="dv">0</span>,s<span class="sc">-</span><span class="fu">sum</span>(X[<span class="sc">-</span>i])) }</span>
<span id="cb93-11"><a href="C-Simulation.html#cb93-11" aria-hidden="true" tabindex="-1"></a> sim <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim,X) }</span>
<span id="cb93-12"><a href="C-Simulation.html#cb93-12" aria-hidden="true" tabindex="-1"></a>pic_ani <span class="ot">=</span> <span class="cf">function</span>(n){</span>
<span id="cb93-13"><a href="C-Simulation.html#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim[<span class="dv">1</span><span class="sc">:</span>n,],<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">11</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb93-14"><a href="C-Simulation.html#cb93-14" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="fu">which</span>(<span class="fu">apply</span>(sim[(n<span class="dv">-1</span>)<span class="sc">:</span>n,],<span class="dv">2</span>,diff)<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb93-15"><a href="C-Simulation.html#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) <span class="fu">abline</span>(<span class="at">v=</span>sim[n,<span class="dv">1</span>],<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb93-16"><a href="C-Simulation.html#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(i<span class="sc">==</span><span class="dv">2</span>) <span class="fu">abline</span>(<span class="at">h=</span>sim[n,<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb93-17"><a href="C-Simulation.html#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(n<span class="sc">&gt;=</span><span class="dv">1</span>) <span class="fu">points</span>(sim[n,<span class="dv">1</span>],sim[n,<span class="dv">2</span>],<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="fl">1.4</span>)</span>
<span id="cb93-18"><a href="C-Simulation.html#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(n<span class="sc">&gt;=</span><span class="dv">2</span>) <span class="fu">points</span>(sim[n<span class="dv">-1</span>,<span class="dv">1</span>],sim[n<span class="dv">-1</span>,<span class="dv">2</span>],<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="fl">1.4</span>)</span>
<span id="cb93-19"><a href="C-Simulation.html#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">density=</span><span class="dv">15</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb93-20"><a href="C-Simulation.html#cb93-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb93-21"><a href="C-Simulation.html#cb93-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="C-Simulation.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>) {<span class="fu">pic_ani</span>(i)}</span></code></pre></div>
<p><img src="LossDataAnalytics_files/figure-html/sampleani_HM-.gif" width="672" /></p>
</div>
</div>
<div id="Simulation:further-reading-and-resources" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Recursos Adicionales y Colaboradores</h2>
<ul>
<li>Include historical references for jackknife (Quenouille, Tukey, Efron)</li>
<li>Aquí se muestran algunos links para aprender más sobre <a href="https://freakonometrics.hypotheses.org/6470">reproducibilidad y aleatoriedad</a> y cómo ir
<a href="https://freakonometrics.hypotheses.org/6638">de un generador aleatorio a una función muestra</a>.</li>
</ul>
<div id="colaboradores-3" class="section level4 unnumbered">
<h4>Colaboradores</h4>
<ul>
<li><strong>Arthur Charpentier</strong>, Université du Quebec á Montreal, y <strong>Edward W. (Jed) Frees</strong>, University of Wisconsin-Madison, son los principales autores de la versión inicial de este capítulo. Email: <a href="mailto:jfrees@bus.wisc.edu" class="email">jfrees@bus.wisc.edu</a> y/o <a href="mailto:arthur.charpentier@gmail.com" class="email">arthur.charpentier@gmail.com</a> para comentarios sobre este capítulo y sugerencias de mejora.</li>
<li>Revisores del capítulo: Escribir a Jed o Arthur; para añadir tu nombre aquí.</li>
<li>Traducción al español: Ana María Pérez-Marín (Universitat de Barcelona).</li>
</ul>
</div>
<div id="ts-6.a.-bootstrap-applications-in-predictive-modeling" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> TS 6.A. Bootstrap Applications in Predictive Modeling</h3>
<hr />
<p><strong>This section is being written.</strong></p>
<hr />

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="C-AggLossModels.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="C-PremiumFoundations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LossDataAnalytics.pdf", "LossDataAnalytics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
